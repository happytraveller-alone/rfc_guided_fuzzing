{
  "content": "struct {\n          select (Handshake.msg_type) {\n              case client_hello:\n                   ProtocolVersion versions<2..254>;\n\n              case server_hello: /* and HelloRetryRequest */\n                   ProtocolVersion selected_version;\n          };\n      } SupportedVersions;\n\n   The \"supported_versions\" extension is used by the client to indicate\n   which versions of TLS it supports and by the server to indicate which\n   version it is using.  The extension contains a list of supported\n   versions in preference order, with the most preferred version first.\n   Implementations of this specification MUST send this extension in the\n   ClientHello containing all versions of TLS which they are prepared to\n   negotiate (for this specification, that means minimally 0x0304, but\n   if previous versions of TLS are allowed to be negotiated, they MUST\n   be present as well).\n\n   If this extension is not present, servers which are compliant with\n   this specification and which also support TLS 1.2 MUST negotiate\n   TLS 1.2 or prior as specified in [RFC5246], even if\n   ClientHello.legacy_version is 0x0304 or later.  Servers MAY abort the\n   handshake upon receiving a ClientHello with legacy_version 0x0304 or\n   later.\n\n   If this extension is present in the ClientHello, servers MUST NOT use\n   the ClientHello.legacy_version value for version negotiation and MUST\n   use only the \"supported_versions\" extension to determine client\n   preferences.  Servers MUST only select a version of TLS present in\n   that extension and MUST ignore any unknown versions that are present\n   in that extension.  Note that this mechanism makes it possible to\n   negotiate a version prior to TLS 1.2 if one side supports a sparse\n   range.  Implementations of TLS 1.3 which choose to support prior\n   versions of TLS SHOULD support TLS 1.2.  Servers MUST be prepared to\n   receive ClientHellos that include this extension but do not include\n   0x0304 in the list of versions.\n\n   A server which negotiates a version of TLS prior to TLS 1.3 MUST set\n   ServerHello.version and MUST NOT send the \"supported_versions\"\n   extension.  A server which negotiates TLS 1.3 MUST respond by sending\n   a \"supported_versions\" extension containing the selected version\n   value (0x0304).  It MUST set the ServerHello.legacy_version field to\n   0x0303 (TLS 1.2).  Clients MUST check for this extension prior to\n   processing the rest of the ServerHello (although they will have to\n\n   parse the ServerHello in order to read the extension).  If this\n   extension is present, clients MUST ignore the\n   ServerHello.legacy_version value and MUST use only the\n   \"supported_versions\" extension to determine the selected version.  If\n   the \"supported_versions\" extension in the ServerHello contains a\n   version not offered by the client or contains a version prior to\n   TLS 1.3, the client MUST abort the handshake with an\n   \"illegal_parameter\" alert.",
  "section": "4.2.1.. Handshake Protocol_Extensions_Supported Versions"
}
