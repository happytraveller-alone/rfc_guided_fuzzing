{
  "content": "In order to use PSKs, clients MUST also send a\n   \"psk_key_exchange_modes\" extension.  The semantics of this extension\n   are that the client only supports the use of PSKs with these modes,\n   which restricts both the use of PSKs offered in this ClientHello and\n   those which the server might supply via NewSessionTicket.\n\n   A client MUST provide a \"psk_key_exchange_modes\" extension if it\n   offers a \"pre_shared_key\" extension.  If clients offer\n   \"pre_shared_key\" without a \"psk_key_exchange_modes\" extension,\n   servers MUST abort the handshake.  Servers MUST NOT select a key\n   exchange mode that is not listed by the client.  This extension also\n   restricts the modes for use with PSK resumption.  Servers SHOULD NOT\n   send NewSessionTicket with tickets that are not compatible with the\n   advertised modes; however, if a server does so, the impact will just\n   be that the client's attempts at resumption fail.\n\n   The server MUST NOT send a \"psk_key_exchange_modes\" extension.\n\n      enum { psk_ke(0), psk_dhe_ke(1), (255) } PskKeyExchangeMode;\n\n      struct {\n          PskKeyExchangeMode ke_modes<1..255>;\n      } PskKeyExchangeModes;\n\n   psk_ke:  PSK-only key establishment.  In this mode, the server\n      MUST NOT supply a \"key_share\" value.\n\n   psk_dhe_ke:  PSK with (EC)DHE key establishment.  In this mode, the\n      client and server MUST supply \"key_share\" values as described in\n      Section 4.2.8.\n\n   Any future values that are allocated must ensure that the transmitted\n   protocol messages unambiguously identify which mode was selected by\n   the server; at present, this is indicated by the presence of the\n   \"key_share\" in the ServerHello.",
  "section": "4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes"
}
