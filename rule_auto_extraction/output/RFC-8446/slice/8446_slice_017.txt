{
  "content": "In TLS, the cryptographic negotiation proceeds by the client offering\n   the following four sets of options in its ClientHello:\n\n   -  A list of cipher suites which indicates the AEAD algorithm/HKDF\n      hash pairs which the client supports.\n\n   -  A \"supported_groups\" (Section 4.2.7) extension which indicates the\n      (EC)DHE groups which the client supports and a \"key_share\"\n      (Section 4.2.8) extension which contains (EC)DHE shares for some\n      or all of these groups.\n\n   -  A \"signature_algorithms\" (Section 4.2.3) extension which indicates\n      the signature algorithms which the client can accept.  A\n      \"signature_algorithms_cert\" extension (Section 4.2.3) may also be\n      added to indicate certificate-specific signature algorithms.\n\n   -  A \"pre_shared_key\" (Section 4.2.11) extension which contains a\n      list of symmetric key identities known to the client and a\n      \"psk_key_exchange_modes\" (Section 4.2.9) extension which indicates\n      the key exchange modes that may be used with PSKs.\n\n   If the server does not select a PSK, then the first three of these\n   options are entirely orthogonal: the server independently selects a\n   cipher suite, an (EC)DHE group and key share for key establishment,\n   and a signature algorithm/certificate pair to authenticate itself to\n   the client.  If there is no overlap between the received\n   \"supported_groups\" and the groups supported by the server, then the\n   server MUST abort the handshake with a \"handshake_failure\" or an\n   \"insufficient_security\" alert.\n\n   If the server selects a PSK, then it MUST also select a key\n   establishment mode from the set indicated by the client's\n   \"psk_key_exchange_modes\" extension (at present, PSK alone or with\n   (EC)DHE).  Note that if the PSK can be used without (EC)DHE, then\n   non-overlap in the \"supported_groups\" parameters need not be fatal,\n   as it is in the non-PSK case discussed in the previous paragraph.\n\n   If the server selects an (EC)DHE group and the client did not offer a\n   compatible \"key_share\" extension in the initial ClientHello, the\n   server MUST respond with a HelloRetryRequest (Section 4.1.4) message.\n\n   If the server successfully selects parameters and does not require a\n   HelloRetryRequest, it indicates the selected parameters in the\n   ServerHello as follows:\n\n   -  If PSK is being used, then the server will send a \"pre_shared_key\"\n      extension indicating the selected key.\n\n   -  When (EC)DHE is in use, the server will also provide a \"key_share\"\n      extension.  If PSK is not being used, then (EC)DHE and\n      certificate-based authentication are always used.\n\n   -  When authenticating via a certificate, the server will send the\n      Certificate (Section 4.4.2) and CertificateVerify (Section 4.4.3)\n      messages.  In TLS 1.3 as defined by this document, either a PSK or\n      a certificate is always used, but not both.  Future documents may\n      define how to use them together.\n\n   If the server is unable to negotiate a supported set of parameters\n   (i.e., there is no overlap between the client and server parameters),\n   it MUST abort the handshake with either a \"handshake_failure\" or\n   \"insufficient_security\" fatal alert (see Section 6).",
  "section": "4.1.1.. Handshake Protocol_Key Exchange Messages_Cryptographic Negotiation"
}
