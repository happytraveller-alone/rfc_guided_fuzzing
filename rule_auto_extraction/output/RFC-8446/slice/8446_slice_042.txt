{
  "content": "Many of the cryptographic computations in TLS make use of a\n   transcript hash.  This value is computed by hashing the concatenation\n   of each included handshake message, including the handshake message\n   header carrying the handshake message type and length fields, but not\n   including record layer headers.  I.e.,\n\n    Transcript-Hash(M1, M2, ... Mn) = Hash(M1 || M2 || ... || Mn)\n\n   As an exception to this general rule, when the server responds to a\n   ClientHello with a HelloRetryRequest, the value of ClientHello1 is\n   replaced with a special synthetic handshake message of handshake type\n   \"message_hash\" containing Hash(ClientHello1).  I.e.,\n\n  Transcript-Hash(ClientHello1, HelloRetryRequest, ... Mn) =\n      Hash(message_hash ||        /* Handshake type */\n           00 00 Hash.length  ||  /* Handshake message length (bytes) */\n           Hash(ClientHello1) ||  /* Hash of ClientHello1 */\n           HelloRetryRequest  || ... || Mn)\n\n   The reason for this construction is to allow the server to do a\n   stateless HelloRetryRequest by storing just the hash of ClientHello1\n   in the cookie, rather than requiring it to export the entire\n   intermediate hash state (see Section 4.2.2).\n\n   For concreteness, the transcript hash is always taken from the\n   following sequence of handshake messages, starting at the first\n   ClientHello and including only those messages that were sent:\n   ClientHello, HelloRetryRequest, ClientHello, ServerHello,\n   EncryptedExtensions, server CertificateRequest, server Certificate,\n   server CertificateVerify, server Finished, EndOfEarlyData, client\n   Certificate, client CertificateVerify, client Finished.\n\n   In general, implementations can implement the transcript by keeping a\n   running transcript hash value based on the negotiated hash.  Note,\n   however, that subsequent post-handshake authentications do not\n   include each other, just the messages through the end of the main\n   handshake.",
  "section": "4.4.1.. Handshake Protocol_Authentication Messages_The Transcript Hash"
}
