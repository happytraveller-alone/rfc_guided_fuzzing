{
  "content": "As discussed in Section 2, TLS generally uses a common set of\n   messages for authentication, key confirmation, and handshake\n   integrity: Certificate, CertificateVerify, and Finished.  (The PSK\n   binders also perform key confirmation, in a similar fashion.)  These\n   three messages are always sent as the last messages in their\n   handshake flight.  The Certificate and CertificateVerify messages are\n   only sent under certain circumstances, as defined below.  The\n   Finished message is always sent as part of the Authentication Block.\n   These messages are encrypted under keys derived from the\n   [sender]_handshake_traffic_secret.\n\n   The computations for the Authentication messages all uniformly take\n   the following inputs:\n\n   -  The certificate and signing key to be used.\n\n   -  A Handshake Context consisting of the set of messages to be\n      included in the transcript hash.\n\n   -  A Base Key to be used to compute a MAC key.\n\n   Based on these inputs, the messages then contain:\n\n   Certificate:  The certificate to be used for authentication, and any\n      supporting certificates in the chain.  Note that certificate-based\n      client authentication is not available in PSK handshake flows\n      (including 0-RTT).\n\n   CertificateVerify:  A signature over the value\n      Transcript-Hash(Handshake Context, Certificate).\n\n   Finished:  A MAC over the value Transcript-Hash(Handshake Context,\n      Certificate, CertificateVerify) using a MAC key derived from the\n      Base Key.\n\n   The following table defines the Handshake Context and MAC Base Key\n   for each scenario:\n\n   +-----------+-------------------------+-----------------------------+\n   | Mode      | Handshake Context       | Base Key                    |\n   +-----------+-------------------------+-----------------------------+\n   | Server    | ClientHello ... later   | server_handshake_traffic_   |\n   |           | of EncryptedExtensions/ | secret                      |\n   |           | CertificateRequest      |                             |\n   |           |                         |                             |\n   | Client    | ClientHello ... later   | client_handshake_traffic_   |\n   |           | of server               | secret                      |\n   |           | Finished/EndOfEarlyData |                             |\n   |           |                         |                             |\n   | Post-     | ClientHello ... client  | client_application_traffic_ |\n   | Handshake | Finished +              | secret_N                    |\n   |           | CertificateRequest      |                             |\n   +-----------+-------------------------+-----------------------------+",
  "section": "4.4.. Handshake Protocol_Authentication Messages"
}
