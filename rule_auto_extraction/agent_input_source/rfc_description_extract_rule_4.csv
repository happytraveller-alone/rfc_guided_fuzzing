index,section,title,construction_rule_type,construction_explicitness,construction_base,processing_rule_type,processing_explicitness,processing_base
1,4.. Handshake Protocol,Message Order and Error Handling,CLI-MSG-CONST/SRV-MSG-CONST,1,"""Protocol messages MUST be sent in the order defined in Section 4.4.1 and illustrated in the diagrams in Section 2.""",SRV-MSG-PROC/CLI-MSG-PROC,1,"""A peer which receives a handshake message in an unexpected order MUST abort the handshake with an 'unexpected_message' alert."""
2,4.1.1.. Handshake Protocol_Key Exchange Messages_Cryptographic Negotiation,Server Parameter Selection,SRV-MSG-CONST,1,"""The server MUST independently select a cipher suite, an (EC)DHE group, a key share, and a signature algorithm/certificate pair if it does not select a PSK.""",SRV-MSG-PROC,1,"""The server MUST abort the handshake with a 'handshake_failure' or 'insufficient_security' alert if there is no overlap in 'supported_groups'."""
3,4.1.1.. Handshake Protocol_Key Exchange Messages_Cryptographic Negotiation,PSK Selection,SRV-MSG-CONST,1,"""When a server selects a PSK, it MUST also select a key establishment mode from the client's 'psk_key_exchange_modes' extension.""",CLI-MSG-PROC,1,"""Clients MUST ensure their 'psk_key_exchange_modes' extension is included to facilitate server's PSK selection."""
4,4.1.1.. Handshake Protocol_Key Exchange Messages_Cryptographic Negotiation,PSK Selection,SRV-MSG-CONST,0,"""If a PSK can be used without (EC)DHE, the non-overlap in 'supported_groups' is not fatal.""",CLI-MSG-PROC,0,"""Clients should not consider non-overlap in 'supported_groups' fatal if PSK is usable without (EC)DHE."""
5,4.1.1.. Handshake Protocol_Key Exchange Messages_Cryptographic Negotiation,HelloRetryRequest Requirement,SRV-MSG-CONST,1,"""If the server selects an (EC)DHE group and the client did not offer a compatible 'key_share', the server MUST send a HelloRetryRequest message.""",CLI-MSG-PROC,0,"""Clients should expect a HelloRetryRequest message if their 'key_share' is not compatible."""
6,4.1.1.. Handshake Protocol_Key Exchange Messages_Cryptographic Negotiation,Handshake Failure Conditions,SRV-MSG-CONST,1,"""The server MUST abort the handshake if it cannot negotiate a supported set of parameters.""",SRV-MSG-PROC,1,"""Upon failure to negotiate parameters, the server MUST send a 'handshake_failure' or 'insufficient_security' fatal alert."""
7,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,ClientHello Message Overview,CLI-MSG-CONST,1,"""Clients MUST send the ClientHello as the first TLS message when connecting to a server. If a HelloRetryRequest is received, the client MUST resend the same ClientHello, modifying only as specified.""",SRV-MSG-PROC,1,"""Servers MUST expect the ClientHello as the first message and MUST handle a HelloRetryRequest by validating the modifications made by the client."""
8,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,ClientHello Message Overview,CLI-MSG-CONST,1,"""Clients MUST replace the list of shares in the ""key_share"" extension with a single KeyShareEntry from the indicated group if specified in the HelloRetryRequest.""",SRV-MSG-PROC,1,"""Servers MUST validate that the ""key_share"" extension contains a single KeyShareEntry as indicated in the HelloRetryRequest."""
9,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,ClientHello Message Overview,CLI-MSG-CONST,1,"""Clients MUST remove the ""early_data"" extension if it was present when sending ClientHello after a HelloRetryRequest.""",SRV-MSG-PROC,1,"""Servers MUST reject any ClientHello that includes the ""early_data"" extension after a HelloRetryRequest."""
10,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,ClientHello Message Overview,CLI-MSG-CONST,1,"""Clients MUST include a ""cookie"" extension if provided in the HelloRetryRequest.""",SRV-MSG-PROC,1,"""Servers MUST process the ""cookie"" extension if present in the ClientHello after a HelloRetryRequest."""
11,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,ClientHello Message Overview,CLI-MSG-CONST,1,"""Clients MUST update the ""pre_shared_key"" extension by recomputing the ""obfuscated_ticket_age"" and binder values, and may remove incompatible PSKs as indicated by the server's cipher suite.""",SRV-MSG-PROC,1,"""Servers MUST validate the updated ""pre_shared_key"" extension for correctness according to the cipher suite."""
12,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,ClientHello Message Overview,CLI-MSG-CONST,0,"""Clients MAY optionally add, remove, or change the length of the ""padding"" extension.""",SRV-MSG-PROC,0,"""Servers MAY handle modifications to the ""padding"" extension as specified by the client."""
13,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Connection Termination Rules,SRV-MSG-CONST,1,"""Servers MUST terminate the connection with an 'unexpected_message' alert if they receive a ClientHello after negotiating TLS 1.3.""",SRV-MSG-PROC,1,"""Servers MUST retain the previous protocol version if a TLS 1.3 ClientHello is received during a renegotiation of a prior TLS version, and MUST NOT negotiate TLS 1.3."""
14,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Field Descriptions,CLI-MSG-CONST,1,"""The 'legacy_version' field MUST be set to 0x0303 for compatibility with middleboxes; the actual version is indicated using the 'supported_versions' extension.""",SRV-MSG-PROC,1,"""Servers MUST accept 'legacy_version' set to 0x0303 and refer to the 'supported_versions' extension for the actual version."""
15,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Field Descriptions,CLI-MSG-CONST,1,"""The 'random' field MUST contain 32 bytes generated by a secure random number generator.""",SRV-MSG-PROC,1,"""Servers MUST validate that the 'random' field contains 32 bytes."""
16,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Field Descriptions,CLI-MSG-CONST,1,"""The 'legacy_session_id' field MUST be either a cached session ID from a pre-TLS 1.3 server or a new unpredictable value if none exists.""",SRV-MSG-PROC,1,"""Servers MUST handle 'legacy_session_id' by accepting either a cached session ID or a new unpredictable value."""
17,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Field Descriptions,CLI-MSG-CONST,1,"""The 'cipher_suites' field MUST contain a list of symmetric cipher options supported by the client.""",SRV-MSG-PROC,1,"""Servers MUST validate the 'cipher_suites' field to ensure it contains supported symmetric cipher options."""
18,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Field Descriptions,CLI-MSG-CONST,1,"""The 'legacy_compression_methods' field MUST contain exactly one byte, set to zero.""",SRV-MSG-PROC,1,"""Servers MUST check that the 'legacy_compression_methods' field contains exactly one byte, set to zero."""
19,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Field Descriptions,CLI-MSG-CONST,1,"""The 'extensions' field is used by clients to request extended functionality from servers.""",SRV-MSG-PROC,1,"""Servers MUST process the 'extensions' field to fulfill the extended functionality requests from clients."""
20,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Extension Handling,CLI-MSG-CONST,1,"""Clients MUST include extensions in ClientHello messages, with at least the 'supported_versions' extension.""",SRV-MSG-PROC,1,"""Servers MUST ignore any unrecognized extensions in ClientHello messages."""
21,4.1.2.. Handshake Protocol_Key Exchange Messages_Client Hello,Extension Handling,CLI-MSG-CONST,1,"""Clients MUST include mandatory extensions as specified in the TLS 1.3 protocol.""",SRV-MSG-PROC,1,"""Servers MUST process ClientHello messages while adhering to the mandatory extension requirements."""
22,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Field Descriptions,SRV-MSG-CONST,1,"""The legacy_version field MUST be set to 0x0303 for compatibility with middleboxes.""",CLI-MSG-PROC,1,"""Clients MUST recognize that the actual version is indicated using the supported_versions extension."""
23,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Field Descriptions,SRV-MSG-CONST,1,"""The random field MUST consist of 32 bytes generated by a secure random number generator, with the last 8 bytes overwritten if negotiating TLS 1.2 or TLS 1.1.""",CLI-MSG-PROC,1,"""Clients MUST ensure random bytes are provided according to the specified rules."""
24,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Field Descriptions,SRV-MSG-CONST,1,"""The legacy_session_id_echo field MUST echo the client's legacy_session_id. If it does not match, the handshake MUST abort with an illegal_parameter alert.""",CLI-MSG-PROC,1,"""Clients MUST abort the handshake if the legacy_session_id_echo does not match the sent value."""
25,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Field Descriptions,SRV-MSG-CONST,1,"""The cipher_suite field MUST contain a selected cipher suite from the ClientHello. If not offered, the handshake MUST abort with an illegal_parameter alert.""",CLI-MSG-PROC,1,"""Clients MUST recognize and abort if the selected cipher suite is not offered."""
26,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Field Descriptions,SRV-MSG-CONST,1,"""The legacy_compression_method field MUST be set to 0.""",CLI-MSG-PROC,1,"""Clients MUST ensure the legacy_compression_method is set to 0."""
27,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Field Descriptions,SRV-MSG-CONST,1,"""The extensions field MUST include only those necessary for establishing the cryptographic context and MUST contain the supported_versions extension.""",CLI-MSG-PROC,1,"""Clients MUST ensure that only necessary extensions are included in the message."""
28,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Downgrade Protection Mechanism,CLI-MSG-CONST,1,"""Clients MUST check the last 8 bytes of the server's Random value during the handshake. If they are set to '44 4F 57 4E 47 52 44 01' (indicating a negotiation of TLS 1.2) or '44 4F 57 4E 47 52 44 00' (indicating TLS 1.1 or below), they MUST abort the handshake.""",SRV-MSG-PROC,1,"""Servers MUST set the last 8 bytes of the Random value to '44 4F 57 4E 47 52 44 01' when negotiating TLS 1.2 and to '44 4F 57 4E 47 52 44 00' when negotiating TLS 1.1 or below."""
29,4.1.3.. Handshake Protocol_Key Exchange Messages_Server Hello,Renegotiation Handling,CLI-MSG-CONST,1,"""A legacy TLS client performing renegotiation with TLS 1.2 or prior MUST abort the handshake upon receiving a TLS 1.3 ServerHello, issuing a 'protocol_version' alert.""",SRV-MSG-PROC,1,"""The server MUST not allow renegotiation when TLS 1.3 has been negotiated."""
30,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Extensions Requirements,SRV-MSG-CONST,1,"""The server's extensions MUST contain 'supported_versions' and SHOULD include the minimal set of extensions necessary for the client to generate a correct ClientHello.""",CLI-MSG-PROC,0,"""Clients should be prepared to handle a HelloRetryRequest without extensions not offered in the initial ClientHello, except for the optional 'cookie' extension."""
31,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Extensions Requirements,SRV-MSG-CONST,1,"""A HelloRetryRequest MUST NOT contain any extensions that were not first offered by the client in its ClientHello, except optionally the 'cookie' extension.""",CLI-MSG-PROC,1,"""Clients MUST reject any HelloRetryRequest that contains extensions not offered in its initial ClientHello, except for the 'cookie' extension."""
32,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Client Processing of HelloRetryRequest,CLI-MSG-CONST,1,"""Clients MUST check the legacy_version, legacy_session_id_echo, cipher_suite, and legacy_compression_method upon receipt of a HelloRetryRequest.""",CLI-MSG-PROC,1,"""Clients MUST process the extensions and determine the version using 'supported_versions'."""
33,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Client Processing of HelloRetryRequest,CLI-MSG-CONST,1,"""Clients MUST abort the handshake with an 'illegal_parameter' alert if the HelloRetryRequest would not result in any change in the ClientHello.""",CLI-MSG-PROC,1,"""Clients MUST abort the handshake with an 'unexpected_message' alert if a second HelloRetryRequest is received in the same connection."""
34,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Extension Processing and Updated ClientHello,CLI-MSG-CONST,1,"""Clients MUST process all extensions in the HelloRetryRequest and send a second updated ClientHello.""",SRV-MSG-PROC,1,"""Servers MUST ensure that the ClientHello includes only the extensions defined in the HelloRetryRequest."""
35,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Extension Processing and Updated ClientHello,CLI-MSG-CONST,1,"""Clients MUST include the supported_versions, cookie, and key_share extensions as defined in the HelloRetryRequest.""",SRV-MSG-PROC,1,"""Servers MUST abort the handshake if a cipher suite not offered is received."""
36,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Cipher Suite Negotiation,SRV-MSG-CONST,1,"""Servers MUST negotiate the same cipher suite when receiving a conformant updated ClientHello.""",CLI-MSG-PROC,1,"""Clients MUST check that the cipher suite in the ServerHello matches that in the HelloRetryRequest, and abort the handshake with an 'illegal_parameter' alert if they do not match."""
37,4.1.4.. Handshake Protocol_Key Exchange Messages_Hello Retry Request,Version Retention in ServerHello,CLI-MSG-CONST,1,"""Clients MUST retain the value of selected_version in the HelloRetryRequest 'supported_versions' extension.""",SRV-MSG-PROC,1,"""Servers MUST ensure the value of selected_version in the HelloRetryRequest is the same in the ServerHello; otherwise, clients MUST abort the handshake with an 'illegal_parameter' alert."""
38,4.2.. Handshake Protocol_Extensions,Extension Handling Rules,CLI-MSG-CONST/SRV-MSG-CONST,1,"""Implementations MUST NOT send extension responses if the remote endpoint did not send the corresponding extension requests, except for the 'cookie' extension in HelloRetryRequest.""",SRV-MSG-PROC/CLI-MSG-PROC,1,"""Upon receiving an unsupported extension, an endpoint MUST abort the handshake with an 'unsupported_extension' alert."""
39,4.2.. Handshake Protocol_Extensions,Extension Message Compatibility,CLI-MSG-CONST,1,"""Clients MUST ensure that extensions are only included in messages where they are specified to appear.""",SRV-MSG-PROC,1,"""Servers MUST abort the handshake with an 'illegal_parameter' alert if an extension is received in an unexpected message."""
40,4.2.. Handshake Protocol_Extensions,Extension Order and Uniqueness,CLI-MSG-CONST,1,"""Clients MAY place extensions in any order in the ClientHello, except the ""pre_shared_key"" extension which MUST be last.""",SRV-MSG-PROC,1,"""Servers MUST ensure the ""pre_shared_key"" extension is the last extension in ClientHello."""
41,4.2.. Handshake Protocol_Extensions,Extension Order and Uniqueness,CLI-MSG-CONST,1,"""Clients MUST NOT include more than one extension of the same type in any extension block.""",SRV-MSG-PROC,1,"""Servers MUST reject ClientHello messages with duplicate extension types."""
42,4.2.1.. Handshake Protocol_Extensions_Supported Versions,ClientHello Requirements,CLI-MSG-CONST,1,"""Clients MUST send the 'Supported Versions' extension in ClientHello, containing all TLS versions they are prepared to negotiate, including at least 0x0304.""",SRV-MSG-PROC,1,"""Servers MUST process the 'Supported Versions' extension and validate that it includes all versions of TLS that the client is prepared to negotiate."""
43,4.2.1.. Handshake Protocol_Extensions_Supported Versions,ClientHello Requirements,CLI-MSG-CONST,1,"""If previous versions of TLS are allowed for negotiation, they MUST also be included in the 'Supported Versions' extension.""",SRV-MSG-PROC,1,"""Servers MUST ensure that any previous TLS versions permitted for negotiation are present in the 'Supported Versions' extension."""
44,4.2.1.. Handshake Protocol_Extensions_Supported Versions,Server Behavior Without the Extension,SRV-MSG-CONST,1,"""Servers MUST negotiate TLS 1.2 or prior if the Supported Versions extension is not present, regardless of ClientHello.legacy_version being 0x0304 or later.""",SRV-MSG-PROC,1,"""Servers MAY abort the handshake upon receiving a ClientHello with legacy_version 0x0304 or later if the Supported Versions extension is absent."""
45,4.2.1.. Handshake Protocol_Extensions_Supported Versions,Server Behavior With the Extension,CLI-MSG-CONST,1,"""Clients MUST include the ""supported_versions"" extension in ClientHello for server version negotiation.""",SRV-MSG-PROC,1,"""Servers MUST NOT use ClientHello.legacy_version for version negotiation if the ""supported_versions"" extension is present; they MUST use the versions specified in that extension."""
46,4.2.1.. Handshake Protocol_Extensions_Supported Versions,Server Behavior With the Extension,CLI-MSG-CONST,1,"""Clients MUST ensure that the ""supported_versions"" extension lists all TLS versions they support.""",SRV-MSG-PROC,1,"""Servers MUST select a TLS version from the ""supported_versions"" extension and MUST ignore any unknown versions present."""
47,4.2.1.. Handshake Protocol_Extensions_Supported Versions,Negotiation of Versions Prior to TLS 1.2,CLI-MSG-CONST,1,"""Clients that support prior versions of TLS SHOULD include TLS 1.2 in their supported versions list.""",SRV-MSG-PROC,1,"""Servers MUST be prepared to receive ClientHellos with this extension, and handle cases where 0x0304 (TLS 1.3) is not included in the list of versions."""
48,4.2.1.. Handshake Protocol_Extensions_Supported Versions,ServerHello Version Negotiation,SRV-MSG-CONST,1,"""Servers negotiating a version prior to TLS 1.3 MUST set ServerHello.version and MUST NOT send the ""supported_versions"" extension.""",SRV-MSG-PROC,1,"""Servers negotiating TLS 1.3 MUST include a ""supported_versions"" extension with the selected version value (0x0304) and set ServerHello.legacy_version to 0x0303 (TLS 1.2)."""
49,4.2.1.. Handshake Protocol_Extensions_Supported Versions,Client Checks for the Supported Versions Extension,CLI-MSG-CONST,1,"""Clients MUST check for the 'supported_versions' extension prior to processing the rest of the ServerHello.""",SRV-MSG-PROC,1,"""If the 'supported_versions' extension is present, clients MUST ignore the ServerHello.legacy_version value."""
50,4.2.1.. Handshake Protocol_Extensions_Supported Versions,Client Checks for the Supported Versions Extension,CLI-MSG-CONST,1,"""Clients MUST use only the 'supported_versions' extension to determine the selected version.""",SRV-MSG-PROC,1,"""If the 'supported_versions' extension contains a version not offered by the client or a version prior to TLS 1.3, clients MUST abort the handshake with an 'illegal_parameter' alert."""
51,4.2.2.. Handshake Protocol_Extensions_Cookie,HelloRetryRequest Cookie Extension,CLI-MSG-CONST,1,"""Clients MUST copy the contents of the 'cookie' extension received in the HelloRetryRequest into a 'cookie' extension in the new ClientHello.""",SRV-MSG-PROC,1,"""Servers MAY include a 'cookie' extension in the HelloRetryRequest to the client."""
52,4.2.2.. Handshake Protocol_Extensions_Cookie,HelloRetryRequest Cookie Extension,CLI-MSG-CONST,1,"""Clients MUST NOT use cookies in their initial ClientHello in subsequent connections.""",SRV-MSG-PROC,0,"""No server-side processing rule regarding the prohibition of using cookies in initial ClientHello messages."""
53,4.2.2.. Handshake Protocol_Extensions_Cookie,Stateless Server Behavior,SRV-MSG-CONST,1,"""Servers operating statelessly MUST ignore unprotected records of type change_cipher_spec received between the first and second ClientHello.""",SRV-MSG-PROC,1,"""When a server receives an unprotected change_cipher_spec record while operating statelessly, it must treat it as if it were the first message received and ignore it."""
54,4.2.3.. Handshake Protocol_Extensions_Signature Algorithms,Client Requirements for Signature Algorithms,CLI-MSG-CONST,1,"""Clients MUST send the ""signature_algorithms"" extension if they desire server authentication via a certificate.""",SRV-MSG-PROC,1,"""Servers MUST abort the handshake with a ""missing_extension"" alert if the client has not sent the ""signature_algorithms"" extension while authenticating via a certificate."""
55,4.2.3.. Handshake Protocol_Extensions_Signature Algorithms,RSASSA-PSS Algorithms,CLI-MSG-CONST,1,"""Clients MUST specify a signature algorithm using RSASSA-PSS with mask generation function 1, ensuring that the Salt length equals the output length of the digest algorithm.""",SRV-MSG-PROC,1,"""Servers MUST validate that the Salt length matches the output length of the specified digest algorithm."""
56,4.2.3.. Handshake Protocol_Extensions_Signature Algorithms,Legacy Algorithms,SRV-MSG-CONST,1,"""TLS 1.3 servers MUST NOT offer a SHA-1 signed certificate unless no valid certificate chain can be produced without it.""",CLI-MSG-PROC,1,"""Clients should be aware that SHA-1 signed certificates are deprecated and should not be negotiated unless for backward compatibility."""
57,4.2.3.. Handshake Protocol_Extensions_Signature Algorithms,TLS 1.2 Compatibility,CLI-MSG-CONST,1,"""Clients negotiating TLS 1.2 MUST comply with the requirements of RFC5246. Clients MAY omit the signature algorithms extension in ClientHellos.""",SRV-MSG-PROC,1,"""Servers MUST ensure that legacy signature algorithm pairs, which are deprecated, MUST NOT be offered or negotiated."""
58,4.2.5.. Handshake Protocol_Extensions_OID Filters,OID Filters Extension Overview,SRV-MSG-CONST,1,"""Servers MUST include the ""oid_filters"" extension only in the CertificateRequest message.""",CLI-MSG-PROC,1,"""Clients MUST ensure that the ""oid_filters"" extension is processed only if it appears in the CertificateRequest message."""
59,4.2.5.. Handshake Protocol_Extensions_OID Filters,Filters List Description,CLI-MSG-CONST,1,"""Clients MUST include all specified certificate extension OIDs in the client certificate if the server provides a non-empty filters list.""",SRV-MSG-PROC,1,"""Servers MUST ensure that the client certificate contains all specified extension OIDs that the client recognizes from the filters list."""
60,4.2.5.. Handshake Protocol_Extensions_OID Filters,Client Certificate Requirements,CLI-MSG-CONST,1,"""Clients MUST ensure that all specified values for recognized extension OIDs are present in the client certificate, although the certificate MAY contain additional values.""",SRV-MSG-PROC,1,"""Servers MAY choose to continue the connection without client authentication or abort the handshake with an 'unsupported_certificate' alert if the client ignores required certificate extension OIDs."""
61,4.2.5.. Handshake Protocol_Extensions_OID Filters,Client Certificate Requirements,CLI-MSG-CONST,1,"""Clients MUST ignore and skip any unrecognized certificate extension OIDs.""",SRV-MSG-PROC,1,"""Servers MUST handle the absence of required certificate extension OIDs appropriately, based on the client's compliance."""
62,4.2.5.. Handshake Protocol_Extensions_OID Filters,OID Uniqueness and Matching Rules,CLI-MSG-CONST,1,"""Clients MUST NOT include the same OID more than once in the filters list.""",SRV-MSG-PROC,1,"""Servers MUST ensure that no OID appears more than once in the filters list."""
63,4.2.5.. Handshake Protocol_Extensions_OID Filters,OID Uniqueness and Matching Rules,CLI-MSG-CONST,1,"""Clients MUST assert all key usage bits in the request that are also in the Key Usage certificate extension.""",SRV-MSG-PROC,1,"""Servers MUST verify that all key usage bits asserted in the request are present in the Key Usage certificate extension."""
64,4.2.5.. Handshake Protocol_Extensions_OID Filters,OID Uniqueness and Matching Rules,CLI-MSG-CONST,1,"""Clients MUST assert all key purpose OIDs present in the request that are found in the Extended Key Usage certificate extension.""",SRV-MSG-PROC,1,"""Servers MUST check that all key purpose OIDs in the request are present in the Extended Key Usage certificate extension."""
65,4.2.5.. Handshake Protocol_Extensions_OID Filters,OID Uniqueness and Matching Rules,CLI-MSG-CONST,1,"""Clients MUST NOT use the anyExtendedKeyUsage OID in the request.""",SRV-MSG-PROC,1,"""Servers MUST reject requests using the anyExtendedKeyUsage OID."""
66,4.2.7.. Handshake Protocol_Extensions_Supported Groups,Server Behavior with Supported Groups,SRV-MSG-CONST,1,"""Servers MUST send the ""supported_groups"" extension to the client, containing all groups supported by the server.""",CLI-MSG-PROC,1,"""Clients MUST NOT act upon the information in ""supported_groups"" until the handshake is successfully completed."""
67,4.2.7.. Handshake Protocol_Extensions_Supported Groups,Server Behavior with Supported Groups,SRV-MSG-CONST,1,"""If the server prefers a group not present in the ""key_share"" extension but is willing to accept the ClientHello, it SHOULD send the ""supported_groups"" extension.""",CLI-MSG-PROC,1,"""Clients MAY use the information from a successfully completed handshake to adjust the groups used in the ""key_share"" extension for future connections."""
68,4.2.8.. Handshake Protocol_Extensions_Key Share,Client Shares Description,CLI-MSG-CONST,1,"""Clients MUST offer KeyShareEntry values corresponding to groups in the 'supported_groups' extension, listed in descending order of preference. The client_shares vector MAY be empty if requesting a HelloRetryRequest.""",SRV-MSG-PROC,1,"""Servers MUST validate that each KeyShareEntry corresponds to a group in the 'supported_groups' extension and appears in the correct order."""
69,4.2.8.. Handshake Protocol_Extensions_Key Share,KeyShare Entry Rules,CLI-MSG-CONST,1,"""Clients MUST offer KeyShareEntry values only for groups listed in the 'supported_groups' extension and MUST NOT offer multiple KeyShareEntry values for the same group.""",SRV-MSG-PROC,1,"""Servers MAY check for violations of KeyShareEntry rules and abort the handshake with an 'illegal_parameter' alert if any rule is violated."""
70,4.2.8.. Handshake Protocol_Extensions_Key Share,Selected Group Verification,CLI-MSG-CONST,1,"""Clients MUST verify that the selected_group field in HelloRetryRequest corresponds to a group in the 'supported_groups' extension of the original ClientHello and does not correspond to a group in the 'key_share' extension of the original ClientHello.""",SRV-MSG-PROC,1,"""Servers MUST ensure that clients abort the handshake with an 'illegal_parameter' alert if the selected_group verification fails."""
71,4.2.8.. Handshake Protocol_Extensions_Key Share,Server Share Requirements,SRV-MSG-CONST,1,"""Servers MUST offer exactly one KeyShareEntry in the ServerHello, which MUST be in the same group as the KeyShareEntry offered by the client.""",CLI-MSG-PROC,1,"""Clients MUST validate that the KeyShareEntry in ServerHello matches the group of their offered KeyShareEntry."""
72,4.2.8.. Handshake Protocol_Extensions_Key Share,Server Share Requirements,SRV-MSG-CONST,1,"""Servers MUST NOT send a KeyShareEntry for any group not indicated in the client's 'supported_groups' extension.""",CLI-MSG-PROC,1,"""Clients MUST reject ServerHello messages that include a KeyShareEntry for unsupported groups."""
73,4.2.8.. Handshake Protocol_Extensions_Key Share,Server Share Requirements,SRV-MSG-CONST,1,"""Servers MUST NOT send a KeyShareEntry when using the 'psk_ke' PskKeyExchangeMode.""",CLI-MSG-PROC,1,"""Clients MUST ensure that no KeyShareEntry is present when 'psk_ke' is used."""
74,4.2.8.. Handshake Protocol_Extensions_Key Share,Verification of Selected NamedGroup,CLI-MSG-CONST,1,"""Clients MUST verify that the selected NamedGroup in the ServerHello matches the NamedGroup in the HelloRetryRequest when using (EC)DHE key establishment.""",SRV-MSG-PROC,1,"""Servers MUST ensure that the NamedGroup selection is consistent between the HelloRetryRequest and ServerHello."""
75,4.2.8.. Handshake Protocol_Extensions_Key Share,Verification of Selected NamedGroup,CLI-MSG-CONST,1,"""If the NamedGroup verification fails, the client MUST abort the handshake and send an 'illegal_parameter' alert.""",SRV-MSG-PROC,0,"""Servers should be prepared to handle ClientHello messages that may lead to an 'illegal_parameter' alert due to NamedGroup mismatch."""
76,4.2.8.1.. Handshake Protocol_Extensions_Key Share_Diffie-Hellman Parameters,Public Key Validation,CLI-MSG-CONST,1,"""Clients MUST validate that their own public key Y satisfies the condition 1 < Y < p-1.""",SRV-MSG-PROC,1,"""Servers MUST also validate that the public key Y of the remote peer satisfies the condition 1 < Y < p-1."""
77,4.2.8.2.. Handshake Protocol_Extensions_Key Share_ECDHE Parameters,Public Value Validation,CLI-MSG-CONST,1,"""Peers MUST validate each other's public value Q by ensuring Q is a valid point on the elliptic curve, specifically checking that Q is not the point at infinity, that both integers x and y are within the correct interval, and that (x, y) satisfies the elliptic curve equation.""",SRV-MSG-PROC,1,"""Servers MUST verify the public value Q following the specified steps: ensuring Q is not the point at infinity, confirming x and y are in the correct interval, and checking that (x, y) satisfies the elliptic curve equation."""
78,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,PSK Key Exchange Modes Extension Overview,CLI-MSG-CONST,1,"""Clients MUST send a 'psk_key_exchange_modes' extension to indicate the supported modes for PSK usage.""",SRV-MSG-PROC,1,"""Servers MUST interpret the 'psk_key_exchange_modes' extension to restrict PSK options based on the client's capabilities."""
79,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,Client Requirements for PSK Extensions,CLI-MSG-CONST,1,"""Clients MUST provide a 'psk_key_exchange_modes' extension if they offer a 'pre_shared_key' extension.""",SRV-MSG-PROC,1,"""Servers MUST abort the handshake if clients offer 'pre_shared_key' without a 'psk_key_exchange_modes' extension."""
80,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,Client Requirements for PSK Extensions,CLI-MSG-CONST,1,"""Clients MUST ensure that the key exchange mode offered is compatible with the modes advertised.""",SRV-MSG-PROC,1,"""Servers MUST NOT select a key exchange mode that is not listed by the client."""
81,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,Client Requirements for PSK Extensions,CLI-MSG-CONST,0,"""Clients SHOULD be aware that if a server sends NewSessionTicket with incompatible tickets, the client's attempts at resumption may fail.""",SRV-MSG-PROC,0,"""Servers SHOULD NOT send NewSessionTicket with tickets that are not compatible with the advertised modes."""
82,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,Server Restrictions on PSK Extensions,SRV-MSG-CONST,1,"""Servers MUST NOT send a ""psk_key_exchange_modes"" extension.""",CLI-MSG-PROC,0,"""Clients should be aware that servers do not send a ""psk_key_exchange_modes"" extension."""
83,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,Key Exchange Mode Descriptions,SRV-MSG-CONST,1,"""In the psk_ke mode, the server MUST NOT supply a 'key_share' value.""",CLI-MSG-PROC,1,"""Clients MUST not expect a 'key_share' value from the server in psk_ke mode."""
84,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,Key Exchange Mode Descriptions,CLI-MSG-CONST,1,"""In the psk_dhe_ke mode, both the client and server MUST supply 'key_share' values.""",SRV-MSG-PROC,1,"""Servers MUST provide 'key_share' values in psk_dhe_ke mode as specified in Section 4.2.8."""
85,4.2.9.. Handshake Protocol_Extensions_Pre-Shared Key Exchange Modes,Future Key Exchange Modes,SRV-MSG-CONST,1,"""Servers MUST ensure that any future values allocated in protocol messages clearly indicate the selected mode.""",SRV-MSG-PROC,1,"""Servers MUST indicate the selected mode in ServerHello by including the ""key_share"" extension."""
86,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Early Data Indication Overview,CLI-MSG-CONST,1,"""Clients MUST supply both the ""pre_shared_key"" and ""early_data"" extensions when using PSK with early data.""",SRV-MSG-PROC,0,"""Servers must handle the early data if both extensions are provided, but no specific requirement is detailed."""
87,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Parameters for 0-RTT Data,CLI-MSG-CONST,1,"""Clients MUST use the first PSK listed in the 'pre_shared_key' extension to encrypt early data.""",SRV-MSG-PROC,1,"""Servers MUST validate that the PSK used to encrypt early data is the first PSK listed in the client's 'pre_shared_key' extension."""
88,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Server Validation of PSK Ticket Age,SRV-MSG-CONST,1,"""Servers MUST validate that the ticket age for the selected PSK identity is within a small tolerance of the time since the ticket was issued.""",SRV-MSG-PROC,1,"""If the ticket age is not valid, servers SHOULD proceed with the handshake but reject 0-RTT and SHOULD NOT assume the ClientHello is fresh."""
89,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Server Response to Early Data Extension,SRV-MSG-CONST,1,"""Servers MUST behave in one of three ways upon receiving an 'early_data' extension: ignore it and process as normal 1-RTT, request a new ClientHello, or return their own 'early_data' extension in EncryptedExtensions.""",SRV-MSG-PROC,1,"""Servers MUST skip early data records that fail deprotection using the handshake traffic key, up to max_early_data_size, and should handle responses based on the chosen behavior."""
90,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Server Response to Early Data Extension,SRV-MSG-CONST,1,"""If the server responds with a HelloRetryRequest, the client MUST NOT include the 'early_data' extension in the follow-up ClientHello.""",SRV-MSG-PROC,1,"""Servers MUST ignore all early data records with an external content type of 'application_data' during the HelloRetryRequest process."""
91,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Server Response to Early Data Extension,SRV-MSG-CONST,1,"""If the server intends to process early data, it MUST include its own 'early_data' extension in the EncryptedExtensions message.""",SRV-MSG-PROC,1,"""The server MUST NOT accept only a subset of the early data messages; all messages must be processed if the 'early_data' extension is acknowledged."""
92,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Requirements for Accepting Early Data,SRV-MSG-CONST,1,"""The server MUST accept a PSK cipher suite and select the first key offered in the client's 'pre_shared_key' extension to accept early data.""",SRV-MSG-PROC,1,"""The server MUST verify that the TLS version number, selected cipher suite, and selected ALPN protocol match those associated with the selected PSK."""
93,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Requirements for Accepting Early Data,SRV-MSG-CONST,1,"""These requirements are a superset of those needed to perform a 1-RTT handshake using the PSK.""",SRV-MSG-PROC,0,"""No specific processing rules defined for this superset requirement."""
94,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Error Handling for Early Data,CLI-MSG-CONST,1,"""Clients MUST handle the case where the server rejects a 0-RTT handshake by ensuring that no 0-RTT records are sent if the server does not support them.""",SRV-MSG-PROC,1,"""Servers MUST NOT respond with the extension if any checks fail and MUST discard all first-flight data, falling back to 1-RTT or 2-RTT."""
95,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Error Handling for Early Data,CLI-MSG-CONST,1,"""Clients MUST expect that if the server rejects the 0-RTT handshake, it will not have the 0-RTT record protection keys.""",SRV-MSG-PROC,1,"""Servers MUST use trial decryption to find the first non-0-RTT message when rejecting 0-RTT handshakes."""
96,4.2.10.. Handshake Protocol_Extensions_Early Data Indication,Error Handling Requirements,SRV-MSG-CONST,1,"""If the server accepts the 'early_data' extension, it MUST comply with error-handling requirements for processing early data records.""",SRV-MSG-PROC,1,"""If the server fails to decrypt a 0-RTT record, it MUST terminate the connection with a 'bad_record_mac' alert."""
97,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Field Descriptions,CLI-MSG-CONST,1,"""Clients MUST provide a label for a key, which can be a ticket or a pre-shared key label.""",SRV-MSG-PROC,1,"""Servers MUST recognize and utilize the identity label provided by the client."""
98,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Field Descriptions,CLI-MSG-CONST,1,"""Clients SHOULD use an obfuscated_ticket_age of 0 for externally established identities, which servers MUST ignore.""",SRV-MSG-PROC,1,"""Servers MUST ignore the obfuscated_ticket_age value when it is 0."""
99,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Field Descriptions,CLI-MSG-CONST,1,"""Clients MUST send a list of identities they are willing to negotiate, using the first identity for 0-RTT data if 'early_data' is also sent.""",SRV-MSG-PROC,1,"""Servers MUST select the first identity from the identities list for processing 0-RTT data if the 'early_data' extension is present."""
100,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Field Descriptions,CLI-MSG-CONST,1,"""Clients MUST provide binders as HMAC values for each identity in the identities list.""",SRV-MSG-PROC,1,"""Servers MUST validate the binders against the identities provided."""
101,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Field Descriptions,CLI-MSG-CONST,1,"""Clients MUST indicate the server's chosen identity as a (0-based) index into the identities list.""",SRV-MSG-PROC,1,"""Servers MUST confirm the selected_identity index corresponds to an identity in the client's list."""
102,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,PSK Hash Algorithm,CLI-MSG-CONST,1,"""Externally established PSKs MUST have the Hash algorithm set during establishment or default to SHA-256 if no algorithm is defined.""",SRV-MSG-PROC,1,"""The server MUST ensure that it selects a compatible PSK and cipher suite."""
103,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,PSK Hash Algorithm,CLI-MSG-CONST,1,"""For PSKs established via the ticket mechanism, the Hash algorithm is the KDF Hash algorithm from the connection where the ticket was established.""",SRV-MSG-PROC,0,"""Servers use the KDF Hash algorithm from the connection for PSKs established via the ticket mechanism."""
104,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Binder Validation,SRV-MSG-CONST,1,"""Servers MUST ensure the binder value is present and valid before accepting PSK key establishment.""",SRV-MSG-PROC,1,"""If the binder value is missing or invalid, the server MUST abort the handshake."""
105,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Binder Validation,SRV-MSG-CONST,1,"""Servers SHOULD select a single PSK and validate only the corresponding binder for that PSK.""",SRV-MSG-PROC,1,"""Servers MUST validate solely the binder associated with the selected PSK."""
106,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Client Verification,CLI-MSG-CONST,1,"""Clients MUST verify that the selected_identity is within the supplied range, that the selected cipher suite indicates a Hash associated with the PSK, and that a server 'key_share' extension is present if required by the 'psk_key_exchange_modes' extension.""",SRV-MSG-PROC,1,"""Servers MUST ensure the selected_identity, cipher suite, and 'key_share' extension are consistent with the ClientHello parameters."""
107,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Client Verification,CLI-MSG-CONST,1,"""Clients MUST abort the handshake with an 'illegal_parameter' alert if the verification of the selected_identity, cipher suite, or 'key_share' extension fails.""",SRV-MSG-PROC,1,"""Servers MUST handle the 'illegal_parameter' alert appropriately, ensuring the handshake is terminated correctly."""
108,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Early Data Handling,CLI-MSG-CONST,1,"""Clients MUST verify that the server's selected_identity is 0 if the server supplies an ""early_data"" extension.""",SRV-MSG-PROC,0,"""If the server supplies an ""early_data"" extension, it must ensure the selected_identity is set appropriately."""
109,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Early Data Handling,CLI-MSG-CONST,1,"""Clients MUST abort the handshake with an ""illegal_parameter"" alert if any value other than 0 is returned for selected_identity.""",SRV-MSG-PROC,0,"""Servers must ensure proper handling of selected_identity values to avoid handshake failures."""
110,4.2.11.. Handshake Protocol_Extensions_Pre-Shared Key Extension,Extension Positioning,CLI-MSG-CONST,1,"""Clients MUST place the ""pre_shared_key"" extension last in the ClientHello.""",SRV-MSG-PROC,1,"""Servers MUST check that the ""pre_shared_key"" extension is the last extension in ClientHello and fail the handshake with an ""illegal_parameter"" alert if it is not."""
111,4.2.11.1.. Handshake Protocol_Extensions_Pre-Shared Key Extension_Ticket Age,Client Ticket Age Handling,CLI-MSG-CONST,1,"""Clients MUST consider the ticket age as the time since receiving the NewSessionTicket message and MUST NOT use tickets with ages greater than the 'ticket_lifetime' value.""",SRV-MSG-PROC,1,"""Servers must ensure that clients do not use tickets exceeding the specified 'ticket_lifetime' during session resumption."""
112,4.2.11.3.. Handshake Protocol_Extensions_Pre-Shared Key Extension_Processing Order,0-RTT Data Streaming and Processing Order,CLI-MSG-CONST,1,"""Clients are permitted to stream 0-RTT data until they receive the server's Finished message. They must send the EndOfEarlyData message after receiving this.""",SRV-MSG-PROC,1,"""Servers MUST process the client's ClientHello and immediately send their flight of messages, rather than waiting for the client's EndOfEarlyData message before sending its ServerHello."""
113,4.3.1.. Handshake Protocol_Server Parameters_Encrypted Extensions,EncryptedExtensions Message Overview,SRV-MSG-CONST,1,"""Servers MUST send the EncryptedExtensions message immediately after the ServerHello message.""",CLI-MSG-PROC,1,"""Clients MUST expect to receive the EncryptedExtensions message immediately following the ServerHello."""
114,4.3.1.. Handshake Protocol_Server Parameters_Encrypted Extensions,Purpose of EncryptedExtensions,CLI-MSG-CONST,1,"""Clients MUST check the EncryptedExtensions message for forbidden extensions.""",SRV-MSG-PROC,1,"""If forbidden extensions are found in the EncryptedExtensions message, clients MUST abort the handshake with an 'illegal_parameter' alert."""
115,4.3.2.. Handshake Protocol_Server Parameters_Certificate Request,CertificateRequest Message Overview,SRV-MSG-CONST,1,"""Servers MAY optionally request a certificate from the client, and this request MUST follow the EncryptedExtensions message.""",CLI-MSG-PROC,0,"""Clients may respond to a certificate request if one is received after the EncryptedExtensions."""
116,4.3.2.. Handshake Protocol_Server Parameters_Certificate Request,Field Descriptions,SRV-MSG-CONST,1,"""The server MUST ensure that 'certificate_request_context' is unique within the connection scope to prevent replay of client CertificateVerify messages.""",CLI-MSG-PROC,1,"""Clients MUST verify that 'certificate_request_context' is unique and should respond accordingly to avoid replay attacks."""
117,4.3.2.. Handshake Protocol_Server Parameters_Certificate Request,Field Descriptions,SRV-MSG-CONST,1,"""The 'signature_algorithms' extension MUST be specified in the certificate request, and other extensions MAY be included if defined.""",CLI-MSG-PROC,1,"""Clients MUST ignore any unrecognized extensions in the certificate request."""
118,4.3.2.. Handshake Protocol_Server Parameters_Certificate Request,Field Descriptions,SRV-MSG-CONST,1,"""When requesting post-handshake authentication, the server SHOULD make 'certificate_request_context' unpredictable to prevent pre-computation of valid CertificateVerify messages.""",CLI-MSG-PROC,1,"""Clients SHOULD be prepared to handle unpredictable 'certificate_request_context' values when post-handshake authentication is requested."""
119,4.3.2.. Handshake Protocol_Server Parameters_Certificate Request,Restrictions for PSK Authentication,SRV-MSG-CONST,1,"""Servers MUST NOT send the CertificateRequest message in the main handshake when authenticating with a PSK.""",CLI-MSG-PROC,0,"""Clients do not expect a CertificateRequest during the main handshake when PSK is being used."""
120,4.3.2.. Handshake Protocol_Server Parameters_Certificate Request,Restrictions for PSK Authentication,SRV-MSG-CONST,0,"""Servers MAY send the CertificateRequest message in post-handshake authentication if the client has sent the 'post_handshake_auth' extension.""",CLI-MSG-PROC,0,"""Clients may receive a CertificateRequest in post-handshake authentication if they have sent the 'post_handshake_auth' extension."""
121,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Certificate Message Overview,SRV-MSG-CONST,1,"""The server MUST send a Certificate message when using a key exchange method that requires certificates for authentication, excluding PSK.""",CLI-MSG-PROC,1,"""The client MUST send a Certificate message only if the server has requested client authentication via a CertificateRequest message."""
122,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Certificate Message Overview,CLI-MSG-CONST,1,"""If the server requests client authentication but no suitable certificate is available, the client MUST send a Certificate message with an empty certificate_list.""",SRV-MSG-PROC,1,"""The server MUST accept a Certificate message with an empty certificate_list when the client has no certificates."""
123,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Certificate Message Overview,CLI-MSG-CONST,1,"""A Finished message MUST be sent by both parties regardless of whether the Certificate message is empty.""",SRV-MSG-PROC,1,"""The server MUST send a Finished message after processing the Certificate message."""
124,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Field Descriptions,SRV-MSG-CONST,1,"""The server's Certificate message MUST include the certificate_request_context if responding to a CertificateRequest; otherwise, it SHALL be of zero length.""",CLI-MSG-PROC,1,"""Clients MUST ensure that the certificate_request_context is correctly handled based on the type of response received."""
125,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Field Descriptions,SRV-MSG-CONST,1,"""The server's Certificate message MUST contain a sequence of CertificateEntry structures in the certificate_list.""",CLI-MSG-PROC,1,"""Clients MUST process the certificate_list, which contains the chain of certificates presented by the server."""
126,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Field Descriptions,SRV-MSG-CONST,1,"""The server's Certificate message MUST include valid extensions for each CertificateEntry, such as OCSP Status and SignedCertificateTimestamp.""",CLI-MSG-PROC,1,"""Clients MUST verify that the extensions in the server's Certificate message correspond to those in the ClientHello."""
127,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Certificate Chain Requirements,CLI-MSG-CONST/SRV-MSG-CONST,1,"""Each CertificateEntry MUST contain a DER-encoded X.509 certificate if negotiated. The sender's certificate MUST be the first CertificateEntry in the list.""",SRV-MSG-PROC,1,"""Servers MUST verify that the first CertificateEntry is the sender's certificate and each following certificate SHOULD directly certify the one immediately preceding it."""
128,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Certificate Chain Requirements,CLI-MSG-CONST/SRV-MSG-CONST,1,"""A certificate that specifies a trust anchor MAY be omitted from the chain if supported peers are known to possess any omitted certificates.""",SRV-MSG-PROC,1,"""Servers MUST account for potentially omitted trust anchor certificates when validating the certificate chain."""
129,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Handling Certificate List Ordering,CLI-MSG-CONST,1,"""Clients SHOULD be prepared to handle potentially extraneous certificates and arbitrary orderings from any TLS version, but the end-entity certificate MUST be first.""",SRV-MSG-PROC,1,"""Servers MUST ensure that the end-entity certificate is the first in the certificate_list."""
130,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,RawPublicKey Certificate Type,CLI-MSG-CONST,1,"""If the RawPublicKey certificate type is negotiated, the certificate_list MUST contain no more than one CertificateEntry.""",SRV-MSG-PROC,1,"""Servers MUST validate that the certificate_list contains at most one CertificateEntry with an ASN1_subjectPublicKeyInfo value."""
131,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,OpenPGP Certificate Type,CLI-MSG-CONST,1,"""Clients MUST NOT use the OpenPGP certificate type with TLS 1.3.""",SRV-MSG-PROC,1,"""Servers MUST reject any authentication message that includes the OpenPGP certificate type."""
132,4.4.2.. Handshake Protocol_Authentication Messages_Certificate,Server Certificate List Requirement,SRV-MSG-CONST,1,"""The server's certificate_list MUST always be non-empty.""",CLI-MSG-PROC,1,"""Clients will send an empty certificate_list if they do not have an appropriate certificate to respond to the server's authentication request."""
133,4.4.2.1.. Handshake Protocol_Authentication Messages_Certificate_OCSP Status and SCT Extensions,OCSP Status Extension in TLS 1.3,SRV-MSG-CONST,1,"""The server MUST include the OCSP information in a 'status_request' extension within the CertificateEntry associated with the certificate.""",SRV-MSG-PROC,1,"""The 'status_request' extension body MUST be a CertificateStatus structure defined in [RFC6066] and interpreted according to [RFC6960]."""
134,4.4.2.1.. Handshake Protocol_Authentication Messages_Certificate_OCSP Status and SCT Extensions,Deprecation of status_request_v2 Extension,CLI-MSG-CONST,1,"""Clients MAY include the status_request_v2 extension in ClientHello messages, but it is deprecated.""",SRV-MSG-PROC,1,"""Servers MUST NOT act upon the presence of the status_request_v2 extension in ClientHello messages and MUST NOT include it in EncryptedExtensions, CertificateRequest, or Certificate messages."""
135,4.4.2.1.. Handshake Protocol_Authentication Messages_Certificate_OCSP Status and SCT Extensions,Deprecation of status_request_v2 Extension,CLI-MSG-CONST,1,"""Clients MAY send the status_request_v2 extension in ClientHello, intending to use it with earlier TLS versions.""",SRV-MSG-PROC,1,"""Servers MUST be able to process ClientHello messages that include the deprecated status_request_v2 extension."""
136,4.4.2.1.. Handshake Protocol_Authentication Messages_Certificate_OCSP Status and SCT Extensions,Client OCSP Response Request,CLI-MSG-CONST,1,"""Clients MAY send an OCSP response if a server requests it via an empty 'status_request' extension in the CertificateRequest message. If sent, the body of the 'status_request' extension MUST be a CertificateStatus structure as defined in [RFC6066].""",SRV-MSG-PROC,1,"""Servers MUST process the 'status_request' extension and validate the CertificateStatus structure if the client opts to send an OCSP response."""
137,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Certificate Selection Rules,SRV-MSG-CONST,1,"""Servers MUST send certificates of type X.509v3 unless negotiated otherwise. The server's end-entity certificate's public key MUST be compatible with the selected authentication algorithm from the client's ""signature_algorithms"" extension.""",CLI-MSG-PROC,1,"""Clients SHOULD include the ""server_name"" extension to assist in certificate selection when applicable."""
138,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Certificate Selection Rules,SRV-MSG-CONST,1,"""The server's end-entity certificate MUST allow the key to be used for signing, with the digitalSignature bit set if the Key Usage extension is present and a signature scheme indicated in the client's ""signature_algorithms""/""signature_algorithms_cert"" extensions.""",CLI-MSG-PROC,0,"""Clients MUST ensure that the certificate received allows for the indicated signing capabilities."""
139,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Certificate Selection Rules,SRV-MSG-CONST,0,"""Servers MAY require the presence of the ""server_name"" extension for certificate selection.""",CLI-MSG-PROC,1,"""Clients SHOULD send the ""server_name"" extension when applicable to guide certificate selection."""
140,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Certificate Chain Signing Requirements,SRV-MSG-CONST,1,"""Servers MUST provide certificates signed by a signature algorithm that the client has advertised, if the client is able to provide such a chain.""",CLI-MSG-PROC,1,"""Clients MUST verify that the server's certificate chain is signed by an algorithm they support."""
141,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Certificate Chain Signing Requirements,SRV-MSG-CONST,1,"""Self-signed certificates or trust anchor certificates MAY be signed with any algorithm.""",CLI-MSG-PROC,0,"""Clients MAY accept self-signed or trust anchor certificates without validation against the advertised algorithms."""
142,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Fallback Certificate Chain Handling,SRV-MSG-CONST,1,"""Servers SHOULD send a certificate chain of their choice if they cannot produce a chain signed only via the indicated supported algorithms.""",CLI-MSG-PROC,1,"""Clients MUST check the received certificate chain for compatibility with the supported algorithms."""
143,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Fallback Certificate Chain Handling,SRV-MSG-CONST,1,"""Fallback chains SHOULD NOT use the deprecated SHA-1 hash algorithm in general, but MAY do so if permitted by the client's advertisement.""",CLI-MSG-PROC,1,"""Clients MUST reject fallback chains that use SHA-1 if their advertisement does not permit it."""
144,4.4.2.2.. Handshake Protocol_Authentication Messages_Certificate_Server Certificate Selection,Client Handling of Certificate Chains,CLI-MSG-CONST,1,"""Clients MUST construct an acceptable chain using provided certificates or decide to abort the handshake.""",SRV-MSG-PROC,1,"""If the client aborts the handshake, it MUST send an appropriate certificate-related alert, defaulting to 'unsupported_certificate'."""
145,4.4.2.3.. Handshake Protocol_Authentication Messages_Certificate_Client Certificate Selection,Client Certificate Selection Rules,CLI-MSG-CONST,1,"""Clients MUST send certificates of type X.509v3 unless explicitly negotiated otherwise.""",SRV-MSG-PROC,1,"""Servers MUST validate that the client certificate is of type X.509v3 unless a different type has been negotiated."""
146,4.4.2.3.. Handshake Protocol_Authentication Messages_Certificate_Client Certificate Selection,Client Certificate Selection Rules,CLI-MSG-CONST,1,"""If the ""certificate_authorities"" extension in the CertificateRequest message is present, at least one certificate in the chain SHOULD be issued by one of the listed CAs.""",SRV-MSG-PROC,1,"""Servers SHOULD check that at least one certificate in the chain is issued by one of the CAs listed in the ""certificate_authorities"" extension."""
147,4.4.2.3.. Handshake Protocol_Authentication Messages_Certificate_Client Certificate Selection,Client Certificate Selection Rules,CLI-MSG-CONST,1,"""Clients MUST ensure that certificates are signed using an acceptable signature algorithm as specified in Section 4.3.2.""",SRV-MSG-PROC,1,"""Servers MUST verify that the signature algorithm used to sign the certificates is acceptable as defined in Section 4.3.2."""
148,4.4.2.3.. Handshake Protocol_Authentication Messages_Certificate_Client Certificate Selection,Client Certificate Selection Rules,CLI-MSG-CONST,1,"""If the CertificateRequest message contains a non-empty ""oid_filters"" extension, the end-entity certificate MUST match the recognized OIDs.""",SRV-MSG-PROC,1,"""Servers MUST check that the end-entity certificate matches the OIDs specified in the ""oid_filters"" extension."""
149,4.4.2.4.. Handshake Protocol_Authentication Messages_Certificate_Receiving a Certificate Message,Server Certificate Handling,CLI-MSG-CONST,1,"""Clients MUST abort the handshake if the server supplies an empty Certificate message.""",SRV-MSG-PROC,1,"""Servers MUST ensure that they do not send an empty Certificate message to avoid client handshake abort."""
150,4.4.2.4.. Handshake Protocol_Authentication Messages_Certificate_Receiving a Certificate Message,Signature Algorithm Restrictions,CLI-MSG-CONST,1,"""Endpoints MUST abort the handshake with a ""bad_certificate"" alert if they receive a certificate requiring validation using an MD5 hash.""",SRV-MSG-PROC,1,"""Servers MUST reject any certificate using MD5 for validation with a ""bad_certificate"" alert."""
151,4.4.2.4.. Handshake Protocol_Authentication Messages_Certificate_Receiving a Certificate Message,Signature Algorithm Restrictions,CLI-MSG-CONST,1,"""It is RECOMMENDED that endpoints abort the handshake with a ""bad_certificate"" alert if they receive a certificate requiring validation using a SHA-1 hash.""",SRV-MSG-PROC,1,"""Servers are RECOMMENDED to reject certificates validated using SHA-1 with a ""bad_certificate"" alert."""
152,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,CertificateVerify Message Overview,CLI-MSG-CONST/SRV-MSG-CONST,1,"""Clients and servers MUST send a CertificateVerify message when authenticating via a certificate. This message MUST appear immediately after the Certificate message and immediately prior to the Finished message.""",SRV-MSG-PROC/CLI-MSG-PROC,1,"""Servers MUST send a CertificateVerify message when authenticating via a certificate, and clients MUST send this message when the Certificate message is non-empty."""
153,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,Signature Algorithm Requirements,SRV-MSG-CONST,1,"""If the CertificateVerify message is sent by a server, the signature algorithm MUST be one offered in the client's ""signature_algorithms"" extension unless no valid certificate chain can be produced without unsupported algorithms.""",CLI-MSG-PROC,1,"""Clients MUST validate that the signature algorithm used in the CertificateVerify message is one of those present in the supported_signature_algorithms field of the ""signature_algorithms"" extension in the CertificateRequest message."""
154,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,Signature Algorithm Requirements,CLI-MSG-CONST,1,"""If the CertificateVerify message is sent by a client, the signature algorithm used in the signature MUST be one of those present in the supported_signature_algorithms field of the ""signature_algorithms"" extension in the CertificateRequest message.""",SRV-MSG-PROC,1,"""Servers MUST validate that the signature algorithm used in the client's CertificateVerify message corresponds to the supported signature algorithms from the client's CertificateRequest."""
155,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,Signature Algorithm Compatibility,CLI-MSG-CONST,1,"""The signature algorithm MUST be compatible with the key in the sender's end-entity certificate.""",SRV-MSG-PROC,1,"""Servers MUST verify that the signature algorithm used is compatible with the key in the sender's end-entity certificate."""
156,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,Signature Algorithm Compatibility,CLI-MSG-CONST,1,"""RSA signatures MUST use an RSASSA-PSS algorithm, regardless of the presence of RSASSA-PKCS1-v1_5 algorithms in 'signature_algorithms'.""",SRV-MSG-PROC,1,"""Servers MUST ensure that RSA signatures use the RSASSA-PSS algorithm."""
157,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,Signature Algorithm Compatibility,CLI-MSG-CONST,1,"""The SHA-1 algorithm MUST NOT be used in any signatures of CertificateVerify messages.""",SRV-MSG-PROC,1,"""Servers MUST reject CertificateVerify messages that use the SHA-1 algorithm in signatures."""
158,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,Signature Verification Process,SRV-MSG-CONST,1,"""The server MUST verify the signature field in the CertificateVerify message using the specified components.""",SRV-MSG-PROC,1,"""The verification process must use the content covered by the digital signature, the public key from the end-entity certificate, and the digital signature from the CertificateVerify message."""
159,4.4.3.. Handshake Protocol_Authentication Messages_Certificate Verify,Error Handling,SRV-MSG-CONST,1,"""The receiver MUST terminate the handshake if verification fails.""",SRV-MSG-PROC,1,"""Servers MUST send a ""decrypt_error"" alert to terminate the handshake upon verification failure."""
160,4.4.4.. Handshake Protocol_Authentication Messages_Finished,Finished Message Overview,CLI-MSG-CONST,1,"""Clients MUST ensure the Finished message is correctly constructed to provide authentication of the handshake and computed keys.""",SRV-MSG-PROC,1,"""Servers MUST verify the correctness of the Finished message contents and terminate the connection with a ""decrypt_error"" alert if incorrect."""
161,4.4.4.. Handshake Protocol_Authentication Messages_Finished,Post-Finished Message Requirements,CLI-MSG-CONST/SRV-MSG-CONST,1,"""Any records following a Finished message MUST be encrypted under the appropriate application traffic key.""",SRV-MSG-PROC/CLI-MSG-PROC,1,"""Servers MUST ensure that any alerts sent in response to client Certificate and CertificateVerify messages are encrypted under the appropriate application traffic key."""
162,4.5.. Handshake Protocol_End of Early Data,EndOfEarlyData Message Overview,CLI-MSG-CONST,1,"""Clients MUST send an EndOfEarlyData message after receiving the server's Finished if the server sent an 'early_data' extension in EncryptedExtensions.""",SRV-MSG-PROC,1,"""Servers MUST ensure the EndOfEarlyData message is sent only if the 'early_data' extension was included in EncryptedExtensions."""
163,4.5.. Handshake Protocol_End of Early Data,EndOfEarlyData Message Overview,CLI-MSG-CONST,1,"""Clients MUST NOT send an EndOfEarlyData message if the server did not send an 'early_data' extension in EncryptedExtensions.""",SRV-MSG-PROC,1,"""Servers MUST reject any EndOfEarlyData messages received if the 'early_data' extension was not sent."""
164,4.5.. Handshake Protocol_End of Early Data,Message Handling Requirements,SRV-MSG-CONST,1,"""Servers MUST NOT send this message.""",CLI-MSG-PROC,1,"""Clients receiving this message MUST terminate the connection with an 'unexpected_message' alert."""
165,4.5.. Handshake Protocol_End of Early Data,Message Handling Requirements,SRV-MSG-CONST,1,"""This message is encrypted under keys derived from the client_early_traffic_secret.""",CLI-MSG-PROC,0,"""Clients process this message as part of handling early data."""
166,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Ticket Resumption Requirements,CLI-MSG-CONST,1,"""Clients MUST only attempt to resume a session with a cipher suite that uses the same KDF hash algorithm as the original connection.""",SRV-MSG-PROC,1,"""Servers MUST verify that the cipher suite used for resumption matches the KDF hash algorithm of the original session."""
167,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Ticket Resumption Requirements,CLI-MSG-CONST,1,"""Clients MUST only resume if the new SNI value is valid for the server certificate presented in the original session.""",SRV-MSG-PROC,1,"""Servers MUST ensure the new SNI value is valid for the certificate used in the original session."""
168,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Ticket Resumption Requirements,CLI-MSG-CONST,0,"""Clients SHOULD only resume if the SNI value matches the one used in the original session.""",SRV-MSG-PROC,0,"""Servers SHOULD prefer to validate that the SNI value matches the original session's SNI."""
169,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Ticket Resumption Requirements,CLI-MSG-CONST,0,"""Clients MAY resume with a different SNI value if indicated externally or by other means.""",SRV-MSG-PROC,0,"""Servers MAY accept a session resume with a different SNI value if appropriately indicated."""
170,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,SNI Value Reporting,CLI-MSG-CONST,1,"""Clients MUST use the SNI value sent in the resumption ClientHello when reporting to the calling application.""",SRV-MSG-PROC,1,"""Servers MUST ensure that the SNI value reported corresponds to the value sent in the resumption ClientHello."""
171,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,SNI Value Reporting,CLI-MSG-CONST,0,"""If all PSK identities with different SNI values are declined, both SNI values must be the same.""",SRV-MSG-PROC,0,"""Servers must ensure consistency between the SNI values when all PSK identities are declined."""
172,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Field Descriptions,SRV-MSG-CONST,1,"""Servers MUST specify a ticket_lifetime as a 32-bit unsigned integer, not exceeding 604800 seconds, with a value of zero indicating immediate ticket discard.""",CLI-MSG-PROC,1,"""Clients MUST discard tickets with a ticket_lifetime of zero."""
173,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Field Descriptions,SRV-MSG-CONST,1,"""Servers MUST generate a fresh ticket_age_add value for each ticket, which is a securely generated random 32-bit value.""",CLI-MSG-PROC,0,"""Clients process the ticket_age_add but do not validate its freshness."""
174,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Field Descriptions,SRV-MSG-CONST,1,"""Servers MUST assign a unique ticket_nonce for each ticket issued on the connection.""",CLI-MSG-PROC,0,"""Clients utilize the ticket_nonce but do not perform validation checks."""
175,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Field Descriptions,SRV-MSG-CONST,0,"""Servers MAY use the ticket value as either a database key or a self-encrypted and self-authenticated value.""",CLI-MSG-PROC,0,"""Clients MAY use the ticket value as a PSK identity but do not require specific validation."""
176,4.6.1.. Handshake Protocol_Post-Handshake Messages_New Session Ticket Message,Field Descriptions,SRV-MSG-CONST,1,"""Servers MUST include extension values for the ticket, and clients MUST ignore any unrecognized extensions.""",CLI-MSG-PROC,1,"""Clients MUST ignore any unrecognized extensions present in the New Session Ticket message."""
177,4.6.2.. Handshake Protocol_Post-Handshake Messages_Post-Handshake Authentication,Post-Handshake Authentication Overview,CLI-MSG-CONST,1,"""Clients MUST respond to a CertificateRequest with appropriate Authentication messages, including Certificate, CertificateVerify, and Finished if they choose to authenticate.""",SRV-MSG-PROC,1,"""Servers MAY request client authentication at any time after the handshake completion by sending a CertificateRequest message."""
178,4.6.2.. Handshake Protocol_Post-Handshake Messages_Post-Handshake Authentication,Post-Handshake Authentication Overview,CLI-MSG-CONST,1,"""If the client declines to authenticate, it MUST send a Certificate message containing no certificates followed by Finished.""",SRV-MSG-PROC,1,"""Servers MUST ensure that all of the client's messages for a given response appear consecutively on the wire with no intervening messages of other types."""
179,4.6.2.. Handshake Protocol_Post-Handshake Messages_Post-Handshake Authentication,CertificateRequest Handling,CLI-MSG-CONST,1,"""Clients MUST send an 'unexpected_message' fatal alert if they receive a CertificateRequest message without having sent the 'post_handshake_auth' extension.""",SRV-MSG-PROC,0,"""Servers sending a CertificateRequest must ensure that clients can handle the request appropriately based on the 'post_handshake_auth' extension."""
180,4.6.2.. Handshake Protocol_Post-Handshake Messages_Post-Handshake Authentication,Client Response Timing Considerations,CLI-MSG-CONST,1,"""Clients MAY respond to multiple CertificateRequests in a different order than they were received.""",SRV-MSG-PROC,1,"""Servers MUST be prepared for delays and the possibility of receiving other messages between sending the CertificateRequest and receiving a response."""
181,4.6.3.. Handshake Protocol_Post-Handshake Messages_Key and Initialization Vector Update,KeyUpdate Message Overview,CLI-MSG-CONST/SRV-MSG-CONST,1,"""The sender MUST indicate key updates using the KeyUpdate handshake message after sending a Finished message.""",CLI-MSG-PROC/SRV-MSG-PROC,1,"""Receivers MUST terminate the connection with an 'unexpected_message' alert if a KeyUpdate message is received before a Finished message."""
182,4.6.3.. Handshake Protocol_Post-Handshake Messages_Key and Initialization Vector Update,KeyUpdate Message Overview,CLI-MSG-CONST/SRV-MSG-CONST,1,"""After sending a KeyUpdate message, the sender SHALL use the newly computed keys for all subsequent traffic.""",CLI-MSG-PROC/SRV-MSG-PROC,1,"""Upon receiving a KeyUpdate message, the receiver MUST update its receiving keys."""
183,4.6.3.. Handshake Protocol_Post-Handshake Messages_Key and Initialization Vector Update,request_update Field Description,CLI-MSG-CONST,1,"""The request_update field indicates whether the recipient should respond with its own KeyUpdate.""",SRV-MSG-PROC,1,"""If an implementation receives any value other than the expected value, it MUST terminate the connection with an 'illegal_parameter' alert."""
184,4.6.3.. Handshake Protocol_Post-Handshake Messages_Key and Initialization Vector Update,KeyUpdate Response Mechanism,CLI-MSG-CONST/SRV-MSG-CONST,1,"""If the request_update field is set to 'update_requested', the sender MUST prepare to send a KeyUpdate with request_update set to 'update_not_requested' before sending the next Application Data record.""",SRV-MSG-PROC/CLI-MSG-PROC,1,"""The receiver MUST send a KeyUpdate in response to 'update_requested' prior to sending its next Application Data record."""
185,4.6.3.. Handshake Protocol_Post-Handshake Messages_Key and Initialization Vector Update,KeyUpdate Response Mechanism,CLI-MSG-CONST/SRV-MSG-CONST,1,"""The mechanism allows either side to force an update to the entire connection.""",SRV-MSG-PROC/CLI-MSG-PROC,1,"""If multiple KeyUpdates are received while silent, the implementation MUST respond with a single update."""
186,4.6.3.. Handshake Protocol_Post-Handshake Messages_Key and Initialization Vector Update,Encryption and KeyUpdate Order,CLI-MSG-CONST/SRV-MSG-CONST,1,"""Both sender and receiver MUST encrypt their KeyUpdate messages with the old keys.""",CLI-MSG-PROC/SRV-MSG-PROC,1,"""Both sides MUST enforce that a KeyUpdate with the old key is received before accepting any messages encrypted with the new key."""
187,4.6.3.. Handshake Protocol_Post-Handshake Messages_Key and Initialization Vector Update,Encryption and KeyUpdate Order,CLI-MSG-CONST/SRV-MSG-CONST,0,"""Failure to enforce the order of KeyUpdate messages may allow message truncation attacks.""",CLI-MSG-PROC/SRV-MSG-PROC,0,"""Systems should mitigate the risk of message truncation attacks by following the KeyUpdate order."""
