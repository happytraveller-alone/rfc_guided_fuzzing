//----- (00000001400C89D0) ----------------------------------------------------
__int64 __fastcall setZoneName(__int64 a1, CHAR *a2, unsigned int a3)
{
  unsigned __int8 *CountNameFromDottedName; // rax
  void *v7; // rax
  __int64 v8; // rcx
  __int64 v9; // rdx
  void *v10; // rax
  int v11; // eax
  unsigned int v13; // [rsp+28h] [rbp-10h]

  Mem_Free(*(_QWORD **)(a1 + 32), 0i64, 0i64, (__int64)"ds\\dns\\server\\server\\zone.c", 11332);
  CountNameFromDottedName = Name_CreateCountNameFromDottedName(a2, a3);
  *(_QWORD *)(a1 + 32) = CountNameFromDottedName;
  if ( !CountNameFromDottedName )
    goto LABEL_14;
  Mem_Free(*(_QWORD **)(a1 + 16), 0i64, 0i64, (__int64)"ds\\dns\\server\\server\\zone.c", 11343);
  v7 = Dns_StringCopyAllocate(a2, a3, 2i64, 2);
  *(_QWORD *)(a1 + 16) = v7;
  if ( !v7 )
    goto LABEL_14;
  LODWORD(v8) = a3;
  if ( a3 > 1 )
  {
    do
    {
      v9 = *(_QWORD *)(a1 + 16);
      v8 = (unsigned int)(v8 - 1);
      if ( *(_BYTE *)(v8 + v9) != 46 )
        break;
      *(_BYTE *)(v8 + v9) = 0;
    }
    while ( (unsigned int)v8 > 1 );
  }
  Mem_Free(*(_QWORD **)(a1 + 24), 0i64, 0i64, (__int64)"ds\\dns\\server\\server\\zone.c", 11366);
  v10 = Dns_StringCopyAllocate(*(char **)(a1 + 16), a3, 2i64, 1);
  *(_QWORD *)(a1 + 24) = v10;
  if ( v10 )
  {
    v11 = _strnicmp(*(const char **)(a1 + 16), "_msdcs.", 7ui64);
    *(_DWORD *)(a1 + 396) &= ~0x80u;
    *(_DWORD *)(a1 + 396) |= (v11 == 0) << 7;
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      WPP_SF_sSD(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0xC8u,
        (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids,
        *(const char **)(a1 + 16),
        *(_QWORD *)(a1 + 24));
    }
    return 0i64;
  }
  else
  {
LABEL_14:
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      v13 = a3;
      WPP_SF_qsD(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0xC9u,
        (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids,
        a1,
        a2,
        v13);
    }
    return 123i64;
  }
}
