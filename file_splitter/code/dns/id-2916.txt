//----- (0000000140152F30) ----------------------------------------------------
__int64 __fastcall DnsVal_GENERIC_HashRoutine(
        BCRYPT_ALG_HANDLE hAlgorithm,
        unsigned __int16 *a2,
        UCHAR *a3,
        ULONG a4,
        ULONG cbHashObject)
{
  UCHAR *v9; // rax
  UCHAR *v10; // rbp
  int v11; // ebx
  CDnsClientSubnetRecordsTrie *v12; // rax
  unsigned __int16 v13; // dx
  UCHAR *v14; // rdx
  bool v15; // cf
  unsigned __int16 v16; // si
  UCHAR *v17; // rdx
  UCHAR *v18; // rdx
  BCRYPT_HASH_HANDLE phHash; // [rsp+40h] [rbp-28h] BYREF

  phHash = 0i64;
  v9 = (UCHAR *)Mem_Alloc(cbHashObject, 0i64, "ds\\dns\\server\\validator\\validator.c", 2029);
  v10 = v9;
  if ( !v9 )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 25) >= 4u )
    {
      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 2), 0x42u, (__int64)&WPP_c53e2308f6cf3329db3757b8a77c9921_Traceguids);
    }
    v11 = -1073741801;
    goto LABEL_44;
  }
  v11 = BCryptCreateHash(hAlgorithm, &phHash, v9, cbHashObject, 0i64, 0, 0);
  if ( v11 < 0 )
  {
    v12 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      || (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) == 0
      || *((_BYTE *)WPP_GLOBAL_Control + 25) < 4u )
    {
      goto LABEL_44;
    }
    v13 = 67;
    goto LABEL_43;
  }
  v14 = (UCHAR *)*((_QWORD *)a2 + 1);
  if ( v14 )
  {
    v11 = BCryptHashData(phHash, v14, *a2, 0);
    if ( v11 < 0 )
    {
      v12 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        || (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) == 0
        || *((_BYTE *)WPP_GLOBAL_Control + 25) < 4u )
      {
        goto LABEL_44;
      }
      v13 = 68;
LABEL_43:
      WPP_SF_D(*((_QWORD *)v12 + 2), v13, (__int64)&WPP_c53e2308f6cf3329db3757b8a77c9921_Traceguids, v11);
      goto LABEL_44;
    }
  }
  v15 = a2[16] != 0;
  v16 = 0;
  while ( v15 )
  {
    v17 = (UCHAR *)*((_QWORD *)a2 + 3);
    if ( v17 )
    {
      v11 = BCryptHashData(phHash, v17, a2[8], 0);
      if ( v11 < 0 )
      {
        v12 = WPP_GLOBAL_Control;
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 25) >= 4u )
        {
          v13 = 69;
          goto LABEL_43;
        }
        goto LABEL_44;
      }
    }
    v11 = BCryptHashData(
            phHash,
            *(PUCHAR *)(*((_QWORD *)a2 + 5) + 16i64 * v16 + 8),
            *(unsigned __int16 *)(*((_QWORD *)a2 + 5) + 16i64 * v16),
            0);
    if ( v11 < 0 )
    {
      v12 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 25) >= 4u )
      {
        v13 = 70;
        goto LABEL_43;
      }
      goto LABEL_44;
    }
    v15 = ++v16 < a2[16];
  }
  v18 = (UCHAR *)*((_QWORD *)a2 + 7);
  if ( v18 && (v11 = BCryptHashData(phHash, v18, a2[24], 0), v11 < 0) )
  {
    v12 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 25) >= 4u )
    {
      v13 = 71;
      goto LABEL_43;
    }
  }
  else
  {
    v11 = BCryptFinishHash(phHash, a3, a4, 0);
    if ( v11 < 0 )
    {
      v12 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 25) >= 4u )
      {
        v13 = 72;
        goto LABEL_43;
      }
    }
  }
LABEL_44:
  if ( phHash )
    BCryptDestroyHash(phHash);
  if ( v10 )
    Mem_Free(v10, 0i64, 0i64, (__int64)"ds\\dns\\server\\validator\\validator.c", 2128);
  return (unsigned int)v11;
}
