//----- (00000001400D75C0) ----------------------------------------------------
__int64 __fastcall Rpc_EnumZones2(
        int a1,
        const unsigned __int16 **a2,
        __int64 a3,
        __int64 a4,
        int a5,
        __int64 a6,
        _DWORD *a7,
        _QWORD *a8)
{
  __int64 v8; // rsi
  _DWORD *v10; // rbx
  unsigned int v11; // r14d
  int v12; // r12d
  const wchar_t *v13; // r9
  const char *v14; // rax
  const char *v15; // r8
  __int64 v16; // rdx
  _DWORD *v18; // rax
  __int64 *v19; // rdx
  __int64 *NextZoneMatchingFilter; // rax
  __int64 *v21; // rbp
  _DWORD *RpcZone; // rax

  LODWORD(v8) = 0;
  v10 = 0i64;
  v11 = 0x10000;
  v12 = 8;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    if ( a2 )
      v13 = *a2;
    else
      v13 = L".";
    v14 = "NULL";
    if ( a6 )
      v15 = *(const char **)(a6 + 24);
    else
      v15 = "NULL";
    if ( a6 )
    {
      v14 = *(const char **)(a6 + 16);
      v16 = *(unsigned int *)(a6 + 8);
    }
    else
    {
      v16 = 0i64;
    }
    WPP_SF_LLssS(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      v16,
      (__int64)v15,
      a1,
      v16,
      (__int64)v14,
      (__int64)v15,
      (__int64)v13);
  }
LABEL_14:
  if ( v12-- )
  {
    freeZoneList(v10);
    v18 = MIDL_user_allocate(8i64 * v11 + 24);
    v10 = v18;
    if ( !v18 )
      return 14i64;
    v18[2] = 0;
    v8 = 0i64;
    v19 = 0i64;
    *v18 = 1;
    while ( 1 )
    {
      NextZoneMatchingFilter = Zone_ListGetNextZoneMatchingFilterEx(a2, v19, a6);
      v21 = NextZoneMatchingFilter;
      if ( !NextZoneMatchingFilter )
        break;
      if ( (unsigned int)v8 >= v11 )
      {
        v11 *= 2;
        goto LABEL_14;
      }
      RpcZone = allocateRpcZone((__int64)NextZoneMatchingFilter);
      if ( !RpcZone )
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
        {
          WPP_SF_D(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x7Fu,
            (__int64)&WPP_5efa35e0870730ffd13051b9da022308_Traceguids,
            14);
        }
        v10[2] = v8;
        freeZoneList(v10);
        return 14i64;
      }
      *(_QWORD *)&v10[2 * v8 + 4] = RpcZone;
      v19 = v21;
      v8 = (unsigned int)(v8 + 1);
      ++v10[2];
    }
  }
  if ( v10 )
    v10[2] = v8;
  *a8 = v10;
  *a7 = 27;
  return 0i64;
}
