//----- (0000000140074EC8) ----------------------------------------------------
HKEY __fastcall Reg_OpenZones(LPCWSTR lpSubKey)
{
  HKEY v1; // rdi
  int v2; // esi
  __int64 v4; // rdx
  CDnsClientSubnetRecordsTrie *v5; // rcx
  int v6; // ebx
  const WCHAR *v7; // rdx
  __int64 v8; // rcx
  __int64 v9; // rcx
  const char *v10; // rax
  __int128 v12; // [rsp+50h] [rbp-18h] BYREF
  HKEY phkResult; // [rsp+70h] [rbp+8h] BYREF

  phkResult = 0i64;
  v1 = 0i64;
  v2 = 0;
  if ( lpSubKey )
  {
    v1 = Reg_OpenVirtualizationInstance(0i64, lpSubKey);
    if ( !v1 )
    {
      v5 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        WPP_SF_S(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0x12u,
          (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids,
          lpSubKey);
        v5 = WPP_GLOBAL_Control;
      }
      v6 = 110;
      goto LABEL_15;
    }
    v2 = 1;
  }
  v7 = L"SYSTEM\\CurrentControlSet\\Services\\DNS\\Zones";
  v8 = -2147483646i64;
  if ( g_ZonesRegistrySource == 1 )
    v7 = L"SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\DNS Server\\Zones";
  if ( lpSubKey )
  {
    v7 = L"Zones";
    v8 = (__int64)v1;
  }
  v6 = RegCreateKeyExW((HKEY)v8, v7, 0, (LPWSTR)L"DnsRegistryClass", 0, 0x2001Fu, 0i64, &phkResult, 0i64);
  if ( v6 )
  {
    v5 = WPP_GLOBAL_Control;
LABEL_15:
    if ( v5 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)v5 + 68) & 2) != 0
      && *((_BYTE *)v5 + 65) >= 4u )
    {
      v9 = *((_QWORD *)v5 + 7);
      v10 = "CurrentControlSet";
      if ( g_ZonesRegistrySource == 1 )
        v10 = "Software";
      WPP_SF_Ds(v9, 0x13u, (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids, v6, (__int64)v10);
    }
    v12 = DNS_EVENT_REGISTRY_OPEN_FAILED;
    Eventlog_LogEvent((__int64)&v12, v4, 0, 0i64, 0i64, v6, 0, 0i64);
  }
  if ( v2 )
    RegCloseKey(v1);
  return phkResult;
}
// 14007502C: variable 'v4' is possibly undefined
// 140187130: using guessed type __int128 DNS_EVENT_REGISTRY_OPEN_FAILED;
// 1401B9024: using guessed type int g_ZonesRegistrySource;
