//----- (000000014004B060) ----------------------------------------------------
__int64 __fastcall Ds_CreateDomainNcDn(const unsigned __int16 *a1, wchar_t **a2)
{
  wchar_t *v3; // rdi
  __int64 v4; // rax
  unsigned __int64 v6; // rcx
  unsigned int v7; // ebx
  int v8; // ebx

  v3 = 0i64;
  v4 = -1i64;
  do
    ++v4;
  while ( a1[v4] );
  v6 = 2i64 * (unsigned int)(v4 + 1);
  if ( v6 > 0xFFFFFFFF || (v7 = v6 + g_AppendZoneLength, (int)v6 + g_AppendZoneLength < (unsigned int)v6) )
  {
    v8 = -2147024362;
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      WPP_SF_S(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x225u,
        (__int64)&WPP_d0fa00cabf37307abd3d7f77fcc28067_Traceguids,
        a1);
    }
  }
  else
  {
    v3 = (wchar_t *)Mem_Alloc(v7, 9i64, "ds\\dns\\server\\server\\ds.c", 20318);
    if ( v3 )
    {
      v8 = StringCbPrintfW(v3, v7, L"DC=%s,%s", a1, g_pwszDnsContainerDN);
      if ( v8 >= 0 )
      {
        *a2 = v3;
        v3 = 0i64;
      }
      else if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
             && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400) != 0
             && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        WPP_SF_D(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0x227u,
          (__int64)&WPP_d0fa00cabf37307abd3d7f77fcc28067_Traceguids,
          v8);
      }
    }
    else
    {
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        WPP_SF_S(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0x226u,
          (__int64)&WPP_d0fa00cabf37307abd3d7f77fcc28067_Traceguids,
          a1);
      }
      v8 = 14;
    }
  }
  Mem_Free(v3, 0i64, 0i64, (__int64)"ds\\dns\\server\\server\\ds.c", 20354);
  return (unsigned int)v8;
}
// 1401EC320: using guessed type int g_AppendZoneLength;
