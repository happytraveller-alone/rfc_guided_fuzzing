//----- (000000014008C87C) ----------------------------------------------------
void __fastcall RR_ListResetNodeFlags(__int64 a1)
{
  int v2; // edi
  char *v3; // rax
  __int64 *v4; // r8
  unsigned int v5; // ecx
  unsigned __int64 v6; // rdx
  __int64 v7; // r9
  int v8; // edx
  int v9; // edx
  int v10; // edx
  char *v11; // rax
  unsigned int v12; // [rsp+40h] [rbp+8h] BYREF

  v2 = 0;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x80000) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 5u )
  {
    v3 = Dbg_NodeName(a1);
    WPP_SF_sqD(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x3Du,
      (__int64)&WPP_10d39582251c332017bd035d2c946054_Traceguids,
      v3);
  }
  v12 = -1;
  acquireRead(DbaseLock, 0xFFFFFFFF, &v12);
  v4 = *(__int64 **)(a1 + 64);
  v5 = *(_DWORD *)(a1 + 92) & 0xFFD9FFCF;
  while ( v4 )
  {
    if ( (*((_WORD *)v4 + 5) & 0x2080) == 0 )
    {
      v6 = *((unsigned __int16 *)v4 + 6);
      if ( (unsigned __int16)v6 <= 0x33u )
      {
        v7 = 0xDC80000000000i64;
        if ( _bittest64(&v7, v6) )
        {
          v5 |= 0x40000u;
          if ( (_WORD)v6 == 50 )
            v5 |= 0x200000u;
        }
      }
      v8 = (unsigned __int16)v6 - 2;
      if ( v8 )
      {
        v9 = v8 - 3;
        if ( v9 )
        {
          v10 = v9 - 1;
          if ( v10 )
          {
            if ( v10 == 33 )
              v5 |= 0x20000u;
          }
          else
          {
            v5 |= 0x10u;
          }
        }
        else
        {
          v5 |= 0x20u;
        }
      }
      else
      {
        v5 |= 0x10u;
        v2 = 1;
        if ( *(_QWORD *)(a1 + 56) && (v5 & 0x100) == 0 )
          *((_BYTE *)v4 + 8) = -126;
      }
    }
    v4 = (__int64 *)*v4;
  }
  *(_DWORD *)(a1 + 92) = v5;
  if ( (v5 & 0x100) == 0 )
  {
    if ( v2 )
    {
      if ( *(_BYTE *)(a1 + 96) == 0xF2 )
        *(_BYTE *)(a1 + 96) = 67;
    }
    else if ( *(_BYTE *)(a1 + 96) == 67 )
    {
      *(_BYTE *)(a1 + 96) = -14;
    }
  }
  if ( !*(_QWORD *)(a1 + 64) )
    *(_DWORD *)(a1 + 92) = v5 & 0xFDFFFFFF;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x80000) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 5u )
  {
    v11 = Dbg_NodeName(a1);
    WPP_SF_sqD(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x3Eu,
      (__int64)&WPP_10d39582251c332017bd035d2c946054_Traceguids,
      v11);
  }
  v12 = -1;
  releaseRead(DbaseLock, &v12, 1);
  insertNodeIntoTimeoutSystem(a1);
}
// 1401EC5E8: using guessed type __int64 DbaseLock;
