//----- (0000000140112638) ----------------------------------------------------
__int64 __fastcall Get_SnapShot_ScopeMap(__int64 a1, __int64 a2, int a3, unsigned int a4, _DWORD *a5, _QWORD *a6)
{
  _DWORD *v6; // r14
  unsigned int v7; // esi
  _QWORD *v8; // rdi
  char v9; // bl
  int v10; // ebp
  _QWORD *v13; // r15
  _QWORD *v14; // rax
  _QWORD *v15; // rbx
  _QWORD *v16; // rax
  __int64 v17; // rcx
  __int64 *v18; // rax
  __int64 i; // rax
  unsigned int v22; // [rsp+78h] [rbp+20h] BYREF

  v22 = a4;
  v6 = a5;
  v7 = 0;
  v8 = 0i64;
  v9 = 0;
  v10 = 0;
  if ( a5 )
    *a5 = 0;
  v13 = a6;
  *a6 = 0i64;
  if ( a3 && (v22 = -1, (unsigned int)acquireRead(a2, 0x2710u, &v22) == -1) )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x16u, (__int64)&WPP_5dd087cb468e333d3a5b59f2603de819_Traceguids);
    }
    v7 = 9607;
  }
  else
  {
    v14 = *(_QWORD **)(a1 + 8);
    LOBYTE(v22) = 1;
    v15 = (_QWORD *)*v14;
    if ( (_QWORD *)*v14 == v14 )
    {
LABEL_24:
      if ( v6 )
        *v6 = v10;
      *v13 = v8;
    }
    else
    {
      while ( 1 )
      {
        v16 = Mem_AllocZero(0x10ui64, 4i64, "ds\\dns\\server\\server\\zoneutil.cpp", 1273);
        if ( !v16 )
          break;
        v17 = v15[4];
        v16[1] = 0i64;
        *v16 = v17;
        if ( v8 )
          v16[1] = v8;
        ++v10;
        v8 = v16;
        if ( !*((_BYTE *)v15 + 41) )
        {
          v18 = (__int64 *)v15[2];
          if ( *((_BYTE *)v18 + 41) )
          {
            for ( i = v15[1]; !*(_BYTE *)(i + 41) && v15 == *(_QWORD **)(i + 16); i = *(_QWORD *)(i + 8) )
              v15 = (_QWORD *)i;
            v15 = (_QWORD *)i;
          }
          else
          {
            do
            {
              v15 = v18;
              v18 = (__int64 *)*v18;
            }
            while ( !*((_BYTE *)v18 + 41) );
          }
        }
        if ( v15 == *(_QWORD **)(a1 + 8) )
          goto LABEL_24;
      }
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
      {
        WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x17u, (__int64)&WPP_5dd087cb468e333d3a5b59f2603de819_Traceguids);
      }
      v7 = 14;
    }
    v9 = v22;
  }
  if ( a3 && v9 )
  {
    v22 = -1;
    releaseRead(a2, &v22, 1);
  }
  if ( v7 && v8 )
    Free_ScopeList(v8);
  return v7;
}
