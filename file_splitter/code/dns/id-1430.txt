//----- (00000001400B2DDC) ----------------------------------------------------
int __fastcall walkBinaryTree(
        unsigned int a1,
        const char *a2,
        int a3,
        _QWORD *a4,
        __int64 *a5,
        __int64 **a6,
        _QWORD *a7)
{
  size_t v8; // rbp
  __int64 *v11; // rax
  __int64 v12; // r9
  CDnsClientSubnetRecordsTrie *v13; // rcx
  const char *v14; // rax
  __int64 v15; // rdx
  __int64 v16; // rax
  const char *v17; // rax
  const char *v18; // r9
  unsigned __int16 v19; // dx
  int v20; // edi
  const char *v21; // rax

  v8 = a3;
  if ( a7 )
    *a7 = 0i64;
  v11 = *a6;
  v12 = **a6;
  *a5 = v12;
  if ( v12 )
  {
    v13 = WPP_GLOBAL_Control;
    do
    {
      if ( v13 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_BYTE *)v13 + 68) & 8) != 0
        && *((_BYTE *)v13 + 65) >= 5u )
      {
        v14 = (const char *)FormatLabelA(*(unsigned __int8 *)(v12 + 101), (const void *)(v12 + 102));
        WPP_SF_sq(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0x31u,
          (__int64)&WPP_800d841ceeab39a775299d72a602aebb_Traceguids,
          v14);
        v13 = WPP_GLOBAL_Control;
      }
      v15 = *a5;
      *a4 = *a5;
      if ( a1 < *(_DWORD *)(v15 + 72) )
      {
        v16 = v15 + 16;
LABEL_41:
        *a6 = (__int64 *)v16;
        goto LABEL_42;
      }
      if ( a1 > *(_DWORD *)(v15 + 72) )
      {
        *a6 = (__int64 *)(v15 + 24);
        if ( a7 )
        {
          if ( v13 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
            && (*((_BYTE *)v13 + 68) & 8) != 0
            && *((_BYTE *)v13 + 65) >= 5u )
          {
            if ( v15 )
            {
              v17 = (const char *)FormatLabelA(*(unsigned __int8 *)(v15 + 101), (const void *)(v15 + 102));
              v13 = WPP_GLOBAL_Control;
              v18 = v17;
            }
            else
            {
              v18 = 0i64;
            }
            v19 = 50;
            goto LABEL_20;
          }
          goto LABEL_21;
        }
        goto LABEL_42;
      }
      v11 = (__int64 *)*(unsigned __int8 *)(v15 + 101);
      v20 = v8 - (_DWORD)v11;
      if ( (v8 & 0x80000000) != 0i64 )
        goto LABEL_40;
      if ( v8 <= 4 || (unsigned __int8)v11 <= 4u )
      {
        if ( !v20 )
          return (int)v11;
      }
      else
      {
        LODWORD(v11) = strncmp(a2, (const char *)v11 + v15 + 103, v8);
        if ( (_DWORD)v11 )
        {
          v13 = WPP_GLOBAL_Control;
          goto LABEL_31;
        }
        if ( !v20 )
          return (int)v11;
        v13 = WPP_GLOBAL_Control;
      }
      LODWORD(v11) = v20;
LABEL_31:
      if ( (int)v11 < 0 )
      {
LABEL_40:
        v16 = *a5 + 16;
        goto LABEL_41;
      }
      *a6 = (__int64 *)(*a5 + 24);
      if ( a7 )
      {
        if ( v13 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_BYTE *)v13 + 68) & 8) != 0
          && *((_BYTE *)v13 + 65) >= 5u )
        {
          if ( *a5 )
          {
            v21 = (const char *)FormatLabelA(*(unsigned __int8 *)(*a5 + 101), (const void *)(*a5 + 102));
            v13 = WPP_GLOBAL_Control;
            v18 = v21;
          }
          else
          {
            v18 = 0i64;
          }
          v19 = 51;
LABEL_20:
          WPP_SF_sq(*((_QWORD *)v13 + 7), v19, (__int64)&WPP_800d841ceeab39a775299d72a602aebb_Traceguids, v18);
        }
LABEL_21:
        *a7 = *a5;
        v13 = WPP_GLOBAL_Control;
      }
LABEL_42:
      v11 = *a6;
      v12 = **a6;
      *a5 = v12;
    }
    while ( v12 );
  }
  return (int)v11;
}
