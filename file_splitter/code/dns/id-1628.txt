//----- (00000001400CE608) ----------------------------------------------------
__int64 __fastcall checkIfIpIsZoneNameServer(__int64 a1, struct in_addr *a2, __int64 a3, int a4)
{
  CDnsClientSubnetRecordsTrie *v6; // rbx
  const char *v7; // rax
  __int64 v8; // rcx
  const char *v9; // rax
  unsigned __int16 v10; // dx
  __int64 v12; // rcx
  const char *v13; // rax

  v6 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x40) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    v7 = DnsAddr_Ntoa(a2);
    WPP_SF_Ss(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x4Du,
      (__int64)&WPP_4e7c1fc42723374814672f05b7ca7028_Traceguids,
      *(const unsigned __int16 **)(a1 + 24),
      (__int64)v7);
    v6 = WPP_GLOBAL_Control;
  }
  v8 = *(_QWORD *)(a1 + 560);
  if ( v8 && (unsigned int)DnsAddrArray_ContainsAddr(v8, a2, 3) )
  {
    if ( v6 == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      || (*((_BYTE *)v6 + 68) & 0x40) == 0
      || *((_BYTE *)v6 + 65) < 4u )
    {
      return 1i64;
    }
    v9 = DnsAddr_Ntoa(a2);
    v10 = 78;
LABEL_11:
    WPP_SF_sS(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      v10,
      (__int64)&WPP_4e7c1fc42723374814672f05b7ca7028_Traceguids,
      v9,
      *(_QWORD *)(a1 + 24));
    return 1i64;
  }
  buildZoneNsList(a1, (__int64)a2, a3, a4);
  v12 = *(_QWORD *)(a1 + 560);
  if ( v12 && (unsigned int)DnsAddrArray_ContainsAddr(v12, a2, 3) )
  {
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      || (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x40) == 0
      || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
    {
      return 1i64;
    }
    v9 = DnsAddr_Ntoa(a2);
    v10 = 79;
    goto LABEL_11;
  }
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x40) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    v13 = DnsAddr_Ntoa(a2);
    WPP_SF_sS(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x50u,
      (__int64)&WPP_4e7c1fc42723374814672f05b7ca7028_Traceguids,
      v13,
      *(_QWORD *)(a1 + 24));
  }
  return 0i64;
}
// 1400CE6E2: variable 'a2' is possibly undefined
// 1400CE6E2: variable 'a3' is possibly undefined
// 1400CE6E2: variable 'a4' is possibly undefined
