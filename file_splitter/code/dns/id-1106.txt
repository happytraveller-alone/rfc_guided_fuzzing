//----- (000000014008FCF8) ----------------------------------------------------
_QWORD *__fastcall RR_FindCoveringDname(_QWORD **a1, unsigned int a2)
{
  _QWORD *i; // rbx
  __int64 NextRecord; // rax
  char *v7; // rax
  char *v8; // rax
  char Destination[512]; // [rsp+30h] [rbp-218h] BYREF

  if ( !a1 )
    return 0i64;
  for ( i = *a1; i; i = (_QWORD *)*i )
  {
    if ( i[8] )
    {
      NextRecord = RR_FindNextRecordEx((__int64)i, 0, 0x27u, 0i64, a2, 1);
      if ( NextRecord )
      {
        if ( *(char *)(NextRecord + 10) >= 0 )
        {
          if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x800) != 0 && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 5u )
          {
            v7 = Dbg_NodeName((__int64)a1);
            if ( !strncpy_s(Destination, 0x1FEui64, v7, 0xFFFFFFFFFFFFFFFFui64)
              && WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
              && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x800) != 0
              && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
            {
              v8 = Dbg_NodeName((__int64)i);
              WPP_SF_ss(
                *((_QWORD *)WPP_GLOBAL_Control + 7),
                0x7Du,
                (__int64)&WPP_10d39582251c332017bd035d2c946054_Traceguids,
                Destination,
                (__int64)v8);
            }
          }
          return i;
        }
      }
    }
  }
  return i;
}
