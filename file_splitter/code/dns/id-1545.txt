//----- (00000001400C2F1C) ----------------------------------------------------
__int64 __fastcall Zone_GetZoneInfoFromResourceRecords(__int64 a1)
{
  __int64 NextRecord; // rax
  CDnsClientSubnetRecordsTrie *v3; // rax

  if ( !*(_DWORD *)(a1 + 372) )
    return 0i64;
  Zone_LockForWriteEx(a1, 1, 0, (__int64)"ds\\dns\\server\\server\\zone.c", 17);
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x80000) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    WPP_SF_sd(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x3Fu,
      (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids,
      *(const char **)(a1 + 16));
  }
  NextRecord = RR_FindNextRecordEx(*(_QWORD *)(a1 + 40), 0, 6u, 0i64, 0, 0);
  if ( NextRecord )
    goto LABEL_20;
  v3 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    WPP_SF_s(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x40u,
      (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids,
      *(const char **)(a1 + 16));
    v3 = WPP_GLOBAL_Control;
  }
  if ( *(_DWORD *)(a1 + 372) != 1 )
    goto LABEL_15;
  if ( !(unsigned int)Zone_CreateDefaultSoa(a1, 0i64) )
  {
    NextRecord = RR_FindNextRecordEx(*(_QWORD *)(a1 + 40), 0, 6u, 0i64, 0, 0);
    if ( NextRecord )
    {
LABEL_20:
      updateZoneSoa((struct _zone_info *)a1, NextRecord);
      Wins_ResetZoneWinsLookup(a1);
      *(_DWORD *)(a1 + 396) = *(_DWORD *)(a1 + 396) & 0xFFFFF3FF | 0x800;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x80000) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        WPP_SF_s(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0x41u,
          (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids,
          *(const char **)(a1 + 16));
      }
      Zone_UnlockAfterWriteEx(a1, 1, (__int64)"ds\\dns\\server\\server\\zone.c", 100);
      return 0i64;
    }
  }
  v3 = WPP_GLOBAL_Control;
LABEL_15:
  if ( v3 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)v3 + 68) & 0x10) != 0
    && *((_BYTE *)v3 + 65) >= 4u )
  {
    WPP_SF_Ds(
      *((_QWORD *)v3 + 7),
      0x42u,
      (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids,
      9605,
      *(_QWORD *)(a1 + 16));
  }
  Zone_UnlockAfterWriteEx(a1, 1, (__int64)"ds\\dns\\server\\server\\zone.c", 110);
  return 9605i64;
}
