//----- (00000001400D8160) ----------------------------------------------------
__int64 __fastcall Rpc_DeleteZoneScope(
        __int64 a1,
        const unsigned __int16 **a2,
        __int64 a3,
        __int64 a4,
        int a5,
        unsigned __int16 *lpString1)
{
  CDnsClientSubnetRecordsTrie *v8; // rcx
  const unsigned __int16 *v9; // rbp
  const unsigned __int16 *v10; // r9
  unsigned int v11; // ebx
  unsigned int valid; // eax
  unsigned __int16 v13; // dx
  int v14; // r9d
  const unsigned __int16 **v15; // rax
  const unsigned __int16 *v16; // r9

  v8 = WPP_GLOBAL_Control;
  v9 = L".";
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    if ( a2 )
      v10 = *a2;
    else
      v10 = L".";
    WPP_SF_S(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x90u, (__int64)&WPP_5efa35e0870730ffd13051b9da022308_Traceguids, v10);
    v8 = WPP_GLOBAL_Control;
  }
  if ( !lpString1 || !a3 )
  {
    v11 = 87;
    if ( v8 == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
      return v11;
    if ( (*((_BYTE *)v8 + 68) & 4) == 0 || *((_BYTE *)v8 + 65) < 2u )
      goto LABEL_40;
    v13 = 145;
    v14 = 87;
    goto LABEL_38;
  }
  if ( a2 && *(_DWORD *)(a3 + 372) != 1 )
  {
    if ( v8 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)v8 + 68) & 4) != 0
      && *((_BYTE *)v8 + 65) >= 2u )
    {
      WPP_SF_(*((_QWORD *)v8 + 7), 0x92u, (__int64)&WPP_5efa35e0870730ffd13051b9da022308_Traceguids);
      v8 = WPP_GLOBAL_Control;
    }
    v11 = 9603;
    goto LABEL_40;
  }
  if ( v8 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)v8 + 68) & 4) != 0
    && *((_BYTE *)v8 + 65) >= 4u )
  {
    WPP_SF_S(*((_QWORD *)v8 + 7), 0x93u, (__int64)&WPP_5efa35e0870730ffd13051b9da022308_Traceguids, lpString1);
  }
  valid = IsValidScopeName(lpString1, a3, 0);
  v11 = valid;
  if ( !valid )
  {
    v11 = Scope_Delete(a3, lpString1, 0x10000000);
    if ( !v11 && (dword_1401B9104 & 1) != 0 )
    {
      v15 = *(const unsigned __int16 ***)(a3 + 200);
      if ( v15 )
        v9 = *v15;
      if ( *(_DWORD *)(a3 + 372) )
        v16 = *(const unsigned __int16 **)(a3 + 24);
      else
        v16 = L"..Cache";
      Template_zzz(Microsoft_Windows_DNSServerHandle, &DNS_EVENT_ZONESCOPE_DELETE, lpString1, v16, v9);
    }
    goto LABEL_39;
  }
  v8 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
    return v11;
  if ( (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0 && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
  {
    v13 = 148;
    v14 = valid;
LABEL_38:
    WPP_SF_D(*((_QWORD *)v8 + 7), v13, (__int64)&WPP_5efa35e0870730ffd13051b9da022308_Traceguids, v14);
LABEL_39:
    v8 = WPP_GLOBAL_Control;
  }
LABEL_40:
  if ( v8 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)v8 + 68) & 4) != 0
    && *((_BYTE *)v8 + 65) >= 4u )
  {
    WPP_SF_D(*((_QWORD *)v8 + 7), 0x95u, (__int64)&WPP_5efa35e0870730ffd13051b9da022308_Traceguids, v11);
  }
  return v11;
}
// 1401B9104: using guessed type int dword_1401B9104;
