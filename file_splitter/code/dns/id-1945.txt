//----- (00000001400EDB68) ----------------------------------------------------
unsigned __int8 *__fastcall BuildNsec3Name(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  unsigned __int8 *v7; // rax
  unsigned __int8 *v8; // rbx

  v7 = (unsigned __int8 *)Mem_Alloc(0x102u, 0i64, "ds\\dns\\server\\server\\olscore.cpp", 2598);
  v8 = v7;
  if ( !v7 )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x200000) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x55u, (__int64)&WPP_4a0a7bf065bf32df4bbeec8f9c7ea0c3_Traceguids);
    }
    return 0i64;
  }
  Name_NodeToCountName(v7, (__int64 *)a3, 1);
  if ( !(unsigned int)Validator_HashDbName(v8, a4, *(unsigned __int8 **)(a1 + 32), 0) )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x200000) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_ss(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x56u,
        (__int64)&WPP_4a0a7bf065bf32df4bbeec8f9c7ea0c3_Traceguids,
        (const char *)(a3 + 102),
        *(_QWORD *)(a1 + 16));
    }
    Mem_Free(v8, 0i64, 0i64, (__int64)"ds\\dns\\server\\server\\olscore.cpp", 2621);
    return 0i64;
  }
  return v8;
}
