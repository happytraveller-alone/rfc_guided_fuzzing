//----- (000000014005E2FC) ----------------------------------------------------
char *__fastcall Etw_LookupName(_WORD *a1)
{
  _QWORD *ThreadLocalStoragePointer; // rax
  __int64 v3; // rbp
  char *v4; // rsi
  char *v5; // rdi
  int v6; // r14d
  unsigned __int8 *v7; // r15
  const void **v8; // r12
  const char *v9; // rax

  ThreadLocalStoragePointer = NtCurrentTeb()->ThreadLocalStoragePointer;
  v3 = *ThreadLocalStoragePointer + 303i64;
  v4 = (char *)(*ThreadLocalStoragePointer + 48i64);
  v5 = v4;
  memset_0(v4, 0, 0xFFui64);
  if ( a1 )
  {
    v6 = 0;
    if ( *a1 )
    {
      v7 = (unsigned __int8 *)(a1 + 164);
      v8 = (const void **)(a1 + 4);
      do
      {
        v9 = (const char *)FormatLabelA(*v7, *v8);
        v5 = sprintfSafeA(v5, v3 - (_QWORD)v5, "%s.", v9);
        if ( !v5 )
          goto LABEL_9;
        ++v6;
        ++v8;
        ++v7;
      }
      while ( v6 < (unsigned __int16)*a1 );
    }
  }
  else
  {
    sprintfSafeA(v4, v3 - (_QWORD)v4, "NULL");
  }
  if ( !v5 )
LABEL_9:
    sprintfSafeA(v4, 0xFFui64, "[ERROR: invalid lookup name]");
  return v4;
}
