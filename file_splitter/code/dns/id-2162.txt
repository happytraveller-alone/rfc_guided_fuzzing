//----- (0000000140111DBC) ----------------------------------------------------
__int64 __fastcall Init_ScopeMap(_QWORD *a1, __int64 *a2, int a3)
{
  unsigned int v6; // esi
  _QWORD *v7; // rax
  _QWORD *v8; // rax
  bool v9; // zf
  _QWORD *v10; // rbx
  _QWORD *v11; // rax
  __int64 v12; // rcx
  _QWORD *v13; // rax
  __int64 v14; // rcx
  char pExceptionObject[40]; // [rsp+20h] [rbp-28h] BYREF

  *a1 = 0i64;
  *a2 = 0i64;
  v6 = 14;
  v7 = Lock_Create();
  *a2 = (__int64)v7;
  if ( !v7 )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0xEu, (__int64)&WPP_5dd087cb468e333d3a5b59f2603de819_Traceguids);
    }
    return v6;
  }
  v8 = operator new(0x20ui64, (const struct std::nothrow_t *)&std::nothrow);
  v9 = a3 == 0;
  v10 = v8;
  if ( v9 )
  {
    if ( v8 )
    {
      v8[2] = 0i64;
      *v8 = Is_Less_Than2;
      v11 = operator new(0x30ui64);
      if ( !v11 )
      {
        std::bad_alloc::bad_alloc((std::bad_alloc *)pExceptionObject, 0i64);
        CxxThrowException_0(pExceptionObject, (_ThrowInfo *)&TI2_AVbad_alloc_std__);
      }
      v10[1] = v11;
      v12 = 0i64;
      *v11 = v11;
      *(_QWORD *)(v10[1] + 8i64) = v10[1];
      *(_QWORD *)(v10[1] + 16i64) = v10[1];
      do
        *(_BYTE *)(v10[1] + v12++ + 40) = 1;
      while ( v12 < 2 );
      goto LABEL_18;
    }
  }
  else if ( v8 )
  {
    v8[2] = 0i64;
    *v8 = Is_Less_Than2;
    v13 = operator new(0x30ui64);
    if ( !v13 )
    {
      std::bad_alloc::bad_alloc((std::bad_alloc *)pExceptionObject, 0i64);
      CxxThrowException_0(pExceptionObject, (_ThrowInfo *)&TI2_AVbad_alloc_std__);
    }
    v10[1] = v13;
    v14 = 0i64;
    *v13 = v13;
    *(_QWORD *)(v10[1] + 8i64) = v10[1];
    *(_QWORD *)(v10[1] + 16i64) = v10[1];
    do
    {
      *(_BYTE *)(v14 + v10[1] + 40) = 1;
      ++v14;
    }
    while ( v14 < 2 );
    goto LABEL_18;
  }
  v10 = 0i64;
LABEL_18:
  *a1 = v10;
  if ( v10 )
  {
    return 0;
  }
  else
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0xFu, (__int64)&WPP_5dd087cb468e333d3a5b59f2603de819_Traceguids);
    }
    Lock_Destroy(*a2);
    *a2 = 0i64;
  }
  return v6;
}
