//----- (0000000140064204) ----------------------------------------------------
_BYTE *__fastcall Name_PlaceNodeNameInBuffer(_BYTE *a1, unsigned __int64 a2, __int64 *a3, __int64 *a4)
{
  _BYTE *v8; // rbx
  __int64 v10; // r14
  __int64 v11; // rdx
  __int64 v12; // r8
  _BYTE *v13; // rbx

  v8 = a1;
  if ( (unsigned int)Wire_TestForBytesRemaining((unsigned __int64)a1, a2, 1i64) )
  {
    while ( a3 != a4 )
    {
      v10 = *((unsigned __int8 *)a3 + 101);
      if ( !(unsigned int)Wire_TestForBytesRemaining((unsigned __int64)v8, a2, v10 + 1) )
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x800) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
        {
          WPP_SF_qdqqq(*((_QWORD *)WPP_GLOBAL_Control + 7), v11, v12, v8, v10, a2, a3, a4);
        }
        return 0i64;
      }
      if ( !(_DWORD)v10 )
      {
        if ( v8 != a1 )
          goto LABEL_22;
        *v8 = 46;
        goto LABEL_21;
      }
      memcpy_0(v8, (char *)a3 + 102, (unsigned int)v10);
      v13 = &v8[v10];
      *v13 = 46;
      v8 = v13 + 1;
      a3 = (__int64 *)*a3;
      if ( !a3 )
        goto LABEL_22;
    }
    if ( v8 > a1 )
    {
      --v8;
      goto LABEL_22;
    }
    *v8 = 64;
LABEL_21:
    ++v8;
LABEL_22:
    if ( !(unsigned int)Wire_TestForBytesRemaining((unsigned __int64)v8, a2, 1i64) )
      return 0i64;
    *v8 = 0;
    return v8;
  }
  else
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x800) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_qq(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x19u,
        (__int64)&WPP_7fc80419a8b133cb02be4345e744511d_Traceguids,
        v8,
        a2);
    }
    return 0i64;
  }
}
// 140064314: variable 'v11' is possibly undefined
// 140064314: variable 'v12' is possibly undefined
