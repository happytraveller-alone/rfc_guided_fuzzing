//----- (0000000140096CC0) ----------------------------------------------------
__int64 __fastcall Rpc_DeleteRecordSet(__int64 a1, const wchar_t **a2, __int64 a3, __int64 a4, int a5, __int16 *a6)
{
  unsigned int v6; // ebp
  __int64 result; // rax
  __int64 v9; // rbx
  unsigned __int16 v10; // si
  char *v11; // r13
  const wchar_t *v12; // r12
  const wchar_t *v13; // r11
  const char *v14; // r10
  const wchar_t *v15; // r8
  int v16; // r9d
  int v17; // ebp
  CDnsClientSubnetRecordsTrie *v18; // rcx
  const wchar_t *v19; // rax
  const wchar_t *v20; // r8
  const unsigned __int16 **v21; // rax
  const unsigned __int16 *v22; // rdx
  const unsigned __int16 *v23; // rcx
  UINT v24; // ecx
  char v25; // al
  _QWORD *v26; // rax
  int v27; // eax
  __int64 v28; // rdx
  const unsigned __int16 *v29; // rax
  const char *v30; // r9
  const wchar_t *v31; // r8
  __int64 v32; // rcx
  unsigned int v33; // [rsp+40h] [rbp-108h] BYREF
  _BYTE *v34; // [rsp+48h] [rbp-100h]
  char v35[64]; // [rsp+50h] [rbp-F8h] BYREF
  WCHAR Buffer[64]; // [rsp+90h] [rbp-B8h] BYREF

  v6 = 0;
  if ( !a6 )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_D(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x2Du,
        (__int64)&WPP_94ace1326352386894146b7c4d888c88_Traceguids,
        87);
    }
    return 87i64;
  }
  v9 = g_pCacheZone;
  v10 = *a6;
  v11 = (char *)*((_QWORD *)a6 + 1);
  if ( a3 )
    v9 = a3;
  v12 = L".";
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    if ( a2 )
      v13 = *a2;
    else
      v13 = L".";
    if ( *(_DWORD *)(v9 + 372) )
      v14 = *(const char **)(v9 + 16);
    else
      v14 = "..Cache";
    v15 = L"Default";
    if ( *(_QWORD *)(v9 + 192) )
      v15 = *(const wchar_t **)(v9 + 192);
    WPP_SF_DsSsS(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x2Eu,
      (__int64)v15,
      v10,
      (__int64)v11,
      (__int64)v15,
      (__int64)v14,
      (__int64)v13);
  }
  v34 = Lookup_ZoneNodeFromDotted((_QWORD *)v9, v11, 0, 16, (__int64 *)0xFFFFFFFFFFFFFFFFi64, &v33);
  if ( !v34 )
  {
    result = v33;
    if ( v33 == 9714 )
      return 0i64;
    return result;
  }
  if ( !v9 || (v16 = *(_DWORD *)(v9 + 372)) == 0 )
  {
    if ( !dword_1401B991C || v10 == 46 )
      v25 = 0;
    else
      v25 = 0x80;
    v26 = (_QWORD *)RR_UpdateDeleteType(v9, (__int64)v34, v10, v25);
    v27 = RR_ListFree(v26);
    v18 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      WPP_SF_Ds(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x31u,
        (__int64)&WPP_94ace1326352386894146b7c4d888c88_Traceguids,
        v27,
        (__int64)v11);
      v18 = WPP_GLOBAL_Control;
    }
    if ( (dword_1401B9104 & 0x20) == 0 )
      goto LABEL_77;
    if ( !v9 || (v29 = *(const unsigned __int16 **)(v9 + 192)) == 0i64 )
      v29 = L"Default";
    Template_qsz((__int64)v18, v28, v10, v11, v29);
    goto LABEL_76;
  }
  v17 = 2;
  if ( v16 != 1 )
  {
    v18 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      if ( a2 )
        v19 = *a2;
      else
        v19 = L".";
      WPP_SF_DsS(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x2Fu,
        (__int64)&WPP_94ace1326352386894146b7c4d888c88_Traceguids,
        v16,
        *(_QWORD *)(v9 + 16),
        (__int64)v19);
      v18 = WPP_GLOBAL_Control;
    }
    v6 = 9611;
    goto LABEL_77;
  }
  if ( (unsigned int)DnsOls_BlockRecordUpdate(v9, v10) )
  {
    v18 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      if ( a2 )
        v20 = *a2;
      else
        v20 = L".";
      WPP_SF_DsS(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x30u,
        (__int64)&WPP_94ace1326352386894146b7c4d888c88_Traceguids,
        v10,
        *(_QWORD *)(v9 + 16),
        (__int64)v20);
      v18 = WPP_GLOBAL_Control;
    }
    v6 = 9102;
    goto LABEL_77;
  }
  memset_0(v35, 0, sizeof(v35));
  Up_CreateAppendUpdate((__int64)v35, (__int64)v34, 0i64, v10, 0i64);
  if ( v9 == g_pTrustAnchorsZone )
    v17 = 67108866;
  v6 = Up_ExecuteUpdateEx((const char **)v9, (__int64)v35, v17, 0, (__int64)"ds\\dns\\server\\server\\rrrpc.c", 74);
  if ( !v6 )
  {
    if ( (Microsoft_Windows_DNSServerEnableBits & 0x20000000) != 0 )
    {
      v21 = *(const unsigned __int16 ***)(v9 + 200);
      if ( v21 )
        v22 = *v21;
      else
        v22 = L".";
      v23 = L"Default";
      if ( *(_QWORD *)(v9 + 192) )
        v23 = *(const unsigned __int16 **)(v9 + 192);
      Template_qszzz((__int64)v23, (__int64)v22, v10, v11, *(const unsigned __int16 **)(v9 + 24), v23, v22);
    }
    if ( v9 == g_pTrustAnchorsZone )
    {
      memset_0(Buffer, 0, sizeof(Buffer));
      if ( v10 == 48 )
      {
        v24 = 12042;
      }
      else
      {
        if ( v10 != 43 )
          goto LABEL_61;
        v24 = 12041;
      }
      Dns_GetResourceString(v24, Buffer, 64i64);
LABEL_61:
      if ( (dword_1401B9104 & 0x400) != 0 )
        Template_sz(Microsoft_Windows_DNSServerHandle, &DNS_EVENT_REMOVE_TRUST_POINT, v11, Buffer);
    }
  }
LABEL_76:
  v18 = WPP_GLOBAL_Control;
LABEL_77:
  if ( v18 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)v18 + 68) & 4) != 0
    && *((_BYTE *)v18 + 65) >= 4u )
  {
    if ( a2 )
      v12 = *a2;
    if ( *(_DWORD *)(v9 + 372) )
      v30 = *(const char **)(v9 + 16);
    else
      v30 = "..Cache";
    v31 = L"Default";
    v32 = *((_QWORD *)v18 + 7);
    if ( *(_QWORD *)(v9 + 192) )
      v31 = *(const wchar_t **)(v9 + 192);
    WPP_SF_DsSsS(v32, 0x32u, (__int64)v31, v6, (__int64)v11, (__int64)v31, (__int64)v30, (__int64)v12);
  }
  return v6;
}
// 1400970E5: variable 'v28' is possibly undefined
// 140188260: using guessed type wchar_t aDefault_1[8];
// 1401B8C48: using guessed type __int64 g_pTrustAnchorsZone;
// 1401B9100: using guessed type int Microsoft_Windows_DNSServerEnableBits;
// 1401B9104: using guessed type int dword_1401B9104;
// 1401B991C: using guessed type int dword_1401B991C;
// 1401EC628: using guessed type __int64 g_pCacheZone;
