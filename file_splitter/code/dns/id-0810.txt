//----- (00000001400703D8) ----------------------------------------------------
__int64 __fastcall Recurse_SendToForwarder(
        __int64 a1,
        __int64 a2,
        int a3,
        unsigned int a4,
        __int16 a5,
        __int16 a6,
        int a7,
        void **a8)
{
  int v8; // ebp
  unsigned int v9; // r14d
  unsigned int v11; // ebx
  void *v14; // r10
  __int64 v15; // r12
  const char *v16; // rax
  unsigned int v17; // ecx
  __int64 v18; // rax
  __int128 v19; // xmm1
  const char *v20; // rax
  const char *v21; // r9
  __int128 v23[4]; // [rsp+30h] [rbp-68h] BYREF

  v8 = a7;
  v9 = 0;
  v11 = a4;
  if ( a2 )
  {
    if ( (unsigned int)*(char *)(a1 + 1428) < *(_DWORD *)(a2 + 4) )
    {
      v14 = g_ServerAddrs;
      do
      {
        v15 = (__int64)*(char *)(a1 + 1428) << 6;
        if ( *(_WORD *)(v15 + a2 + 32) == 2 && (unsigned int)DnsAddrArray_GetFamilyCount((__int64)v14, 2)
          || *(_WORD *)(v15 + a2 + 32) == 23 && (unsigned int)DnsAddrArray_GetFamilyCount((__int64)v14, 23) )
        {
          break;
        }
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x4000) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 3u )
        {
          v16 = DnsAddr_Ntoa((struct in_addr *)(v15 + a2 + 32));
          WPP_SF_sDq(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x18u,
            (__int64)&WPP_045d5c95c5db3fcad9ea35acf5eb75d8_Traceguids,
            v16);
          v14 = g_ServerAddrs;
        }
        ++*(_BYTE *)(a1 + 1428);
      }
      while ( (unsigned int)*(char *)(a1 + 1428) < *(_DWORD *)(a2 + 4) );
      v8 = a7;
      v11 = a4;
    }
    v17 = *(char *)(a1 + 1428);
    if ( v17 < *(_DWORD *)(a2 + 4) )
    {
      v18 = (__int64)(char)v17 << 6;
      v23[0] = *(_OWORD *)(v18 + a2 + 32);
      v23[1] = *(_OWORD *)(v18 + a2 + 48);
      v23[2] = *(_OWORD *)(v18 + a2 + 64);
      v19 = *(_OWORD *)(v18 + a2 + 80);
      *(_BYTE *)(a1 + 1428) = v17 + 1;
      v23[3] = v19;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x4000) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        v20 = DnsAddr_Ntoa((struct in_addr *)v23);
        WPP_SF_qs(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0x1Bu,
          (__int64)&WPP_045d5c95c5db3fcad9ea35acf5eb75d8_Traceguids,
          a1,
          v20);
      }
      _InterlockedIncrement(&dword_1401C7E64);
      if ( v8 )
      {
        DF_UnlockRead(a8);
        v8 = 0;
      }
      sendRecursiveQuery(a1, (__int64)v23, v11, a5, a6);
      v9 = 1;
    }
    else
    {
      if ( v8 )
      {
        DF_UnlockRead(a8);
        v8 = 0;
      }
      if ( a3 )
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x4000) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
        {
          WPP_SF_q(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x19u,
            (__int64)&WPP_045d5c95c5db3fcad9ea35acf5eb75d8_Traceguids,
            a1);
        }
        *(_BYTE *)(a1 + 1422) = 1;
        recursionServerFailure(a1, 0i64);
        v9 = 1;
      }
      else
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x4000) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
        {
          WPP_SF_q(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x1Au,
            (__int64)&WPP_045d5c95c5db3fcad9ea35acf5eb75d8_Traceguids,
            a1);
        }
        *(_BYTE *)(a1 + 1428) = -1;
      }
    }
  }
  if ( v8 )
    DF_UnlockRead(a8);
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x4000) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    v21 = "FALSE";
    if ( v9 )
      v21 = "TRUE";
    WPP_SF_sq(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x1Cu,
      (__int64)&WPP_045d5c95c5db3fcad9ea35acf5eb75d8_Traceguids,
      v21);
  }
  return v9;
}
// 140070459: variable 'v14' is possibly undefined
// 1401C7E64: using guessed type int dword_1401C7E64;
