//----- (000000014011C728) ----------------------------------------------------
char *__fastcall File_PlaceStringInFileBuffer(
        char *a1,
        unsigned __int64 a2,
        int a3,
        unsigned __int8 *a4,
        unsigned int MaxCount)
{
  unsigned int v5; // esi
  char *v6; // rbx
  unsigned __int8 *v8; // r12
  int v10; // r13d
  __int16 v12; // ax
  __int16 v13; // bp
  unsigned __int16 v14; // r14
  __int64 v15; // rcx
  _BYTE *v16; // rax
  STRSAFE_LPSTR v17; // rax

  v5 = MaxCount;
  v6 = a1;
  v8 = a4;
  v10 = 0;
  if ( (unsigned __int64)&a1[4 * MaxCount + 1] >= a2 )
    return 0i64;
  if ( a3 )
  {
    if ( a3 == 1 )
    {
      *a1 = 34;
      v13 = 0x4000;
      v6 = a1 + 1;
    }
    else
    {
      if ( a3 == 3 && memchr(a4, 32, MaxCount) )
      {
        *v6 = 34;
        v10 = 1;
        ++v6;
      }
      v13 = 0;
    }
    v12 = 0x8000;
  }
  else
  {
    v12 = 0x2000;
    v13 = 4096;
  }
  v14 = v12 | v13;
  while ( v5 )
  {
    v15 = *v8;
    --v5;
    ++v8;
    if ( (v14 & DnsFileCharPropertyTable[v15]) != 0 )
    {
      if ( ((unsigned __int16)v13 & DnsFileCharPropertyTable[(unsigned int)v15]) != 0 )
      {
        v16 = v6 + 1;
        if ( (unsigned __int64)(v6 + 1) >= a2 )
          return 0i64;
        *v6 = 92;
        v6 += 2;
        *v16 = v15;
      }
      else
      {
        v17 = sprintfSafeA(v6, a2 - (_QWORD)v6, "\\%03o", (unsigned __int8)v15);
        if ( !v17 )
          break;
        v6 = v17;
      }
    }
    else
    {
      if ( (unsigned __int64)v6 >= a2 )
        return 0i64;
      *v6++ = v15;
    }
  }
  if ( a3 == 1 || v10 )
    *v6++ = 34;
  *v6 = 0;
  return v6;
}
// 140193F30: using guessed type _WORD DnsFileCharPropertyTable[256];
