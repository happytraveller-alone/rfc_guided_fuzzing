//----- (00000001400E06DC) ----------------------------------------------------
__int64 __fastcall TrustPoint::UpdateTrustAnchorZone(
        struct _DnsTreeNode *a1,
        struct _Dbase_Record *a2,
        struct _Dbase_Record *a3)
{
  __int64 result; // rax
  unsigned int v7; // ebx
  char v8[64]; // [rsp+30h] [rbp-58h] BYREF
  const char **v9; // [rsp+A8h] [rbp+20h] BYREF

  v9 = 0i64;
  result = Zone_FindOrCreateTrustAnchorsZone((__int64 *)&v9);
  if ( !(_DWORD)result )
  {
    memset_0(v8, 0, sizeof(v8));
    Dbase_LockEx((__int64)a1, 2, (__int64)"ds\\dns\\server\\server\\dnssec_rfc5011.cpp", 129);
    if ( !a3 || Up_CreateAppendUpdate((__int64)v8, (__int64)a1, 0i64, 0, (__int64)a3) )
    {
      if ( !a2 || Up_CreateAppendUpdate((__int64)v8, (__int64)a1, (__int64)a2, 0, 0i64) )
      {
        a2 = 0i64;
        a3 = 0i64;
        v7 = Up_ExecuteUpdateEx(
               v9,
               (__int64)v8,
               134225922,
               0,
               (__int64)"ds\\dns\\server\\server\\dnssec_rfc5011.cpp",
               190);
      }
      else
      {
        v7 = 14;
        a3 = 0i64;
      }
    }
    else
    {
      v7 = 14;
    }
    Dbase_UnlockEx((__int64)a1, 2, (__int64)"ds\\dns\\server\\server\\dnssec_rfc5011.cpp", 207);
    RR_Free((__int64)a3);
    RR_Free((__int64)a2);
    return v7;
  }
  return result;
}
