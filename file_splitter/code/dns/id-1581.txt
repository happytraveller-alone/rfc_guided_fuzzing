//----- (00000001400C83B4) ----------------------------------------------------
__int64 __fastcall Zone_PulseUnlockDuringWriteEx(__int64 a1, __int64 a2, __int64 a3)
{
  unsigned int v4; // edi
  char v5; // si
  DWORD v6; // eax
  CDnsClientSubnetRecordsTrie *v7; // rcx
  HANDLE Handles[3]; // [rsp+40h] [rbp-18h] BYREF

  v4 = 9607;
  if ( *(char *)(a1 + 428) >= 0 || *(_DWORD *)(a1 + 404) != GetCurrentThreadId() )
    goto LABEL_12;
  ResetEvent(*(HANDLE *)(a1 + 408));
  v5 = *(_BYTE *)(a1 + 428);
  if ( v5 < -1 )
  {
    do
      Zone_UnlockAfterWriteEx(a1, 1, (__int64)"ds\\dns\\server\\server\\ds.c", 248);
    while ( *(char *)(a1 + 428) < -1 );
  }
  Zone_UnlockAfterWriteEx(a1, 1, (__int64)"ds\\dns\\server\\server\\ds.c", 248);
  Handles[0] = *(HANDLE *)(a1 + 408);
  Handles[1] = hDnsShutdownEvent;
  v6 = WaitForMultipleObjects(2u, Handles, 0, 0x2710u);
  if ( g_fDnsServiceExit != 1 && (!v6 || v6 == 258) )
  {
    do
      v4 = Zone_LockForWriteEx(a1, 1, 0x4E20u, (__int64)"ds\\dns\\server\\server\\ds.c", 248);
    while ( !v4 && *(_BYTE *)(a1 + 428) != v5 );
    goto LABEL_12;
  }
  v7 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
    return v4;
  if ( (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0 && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    WPP_SF_q(*((_QWORD *)WPP_GLOBAL_Control + 7), 0xC4u, (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids, a1);
LABEL_12:
    v7 = WPP_GLOBAL_Control;
  }
  if ( v7 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)v7 + 68) & 0x10) != 0
    && *((_BYTE *)v7 + 65) >= 5u )
  {
    WPP_SF_Dqsd(*((_QWORD *)v7 + 7), a2, a3, v4);
  }
  return v4;
}
// 1400C84EA: variable 'a2' is possibly undefined
// 1400C84EA: variable 'a3' is possibly undefined
// 1401B9A40: using guessed type int g_fDnsServiceExit;
