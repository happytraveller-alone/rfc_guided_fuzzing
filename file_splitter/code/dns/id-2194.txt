//----- (00000001401158BC) ----------------------------------------------------
__int64 __fastcall CSecurityDescriptor::GetTokenSids(HANDLE TokenHandle, void **a2, void **a3)
{
  PSID *v3; // r14
  PSID *v4; // rsi
  void *v5; // rdi
  signed int LastError; // eax
  unsigned int v10; // ebx
  void *v11; // rax
  signed int v12; // eax
  void *v13; // rax
  signed int v14; // eax
  DWORD TokenInformationLength; // [rsp+68h] [rbp+38h] BYREF

  v3 = 0i64;
  v4 = 0i64;
  v5 = 0i64;
  if ( a2 )
    *a2 = 0i64;
  if ( a3 )
    *a3 = 0i64;
  if ( a2 )
  {
    GetTokenInformation(TokenHandle, TokenUser, 0i64, 0, &TokenInformationLength);
    LastError = GetLastError();
    if ( LastError != 122 )
      goto LABEL_7;
    v3 = (PSID *)Dns_MemNew<unsigned char>(TokenInformationLength);
    if ( !v3 )
      return (unsigned int)-2147024882;
    if ( !GetTokenInformation(TokenHandle, TokenUser, v3, TokenInformationLength, &TokenInformationLength) )
      goto LABEL_27;
    TokenInformationLength = GetLengthSid(*v3);
    v11 = Dns_MemNew<unsigned char>(TokenInformationLength);
    v5 = v11;
    if ( !v11 )
    {
      v10 = -2147024882;
LABEL_29:
      if ( v3 )
        operator delete(v3);
      goto LABEL_31;
    }
    if ( !CopySid(TokenInformationLength, v11, *v3) )
    {
LABEL_27:
      v14 = GetLastError();
      v10 = (unsigned __int16)v14 | 0x80070000;
      if ( v14 <= 0 )
        v10 = v14;
      goto LABEL_29;
    }
    *a2 = v5;
    v5 = 0i64;
    operator delete(v3);
    v3 = 0i64;
  }
  if ( a3 )
  {
    GetTokenInformation(TokenHandle, TokenPrimaryGroup, 0i64, 0, &TokenInformationLength);
    LastError = GetLastError();
    if ( LastError != 122 )
    {
LABEL_7:
      v10 = (unsigned __int16)LastError | 0x80070000;
      if ( LastError <= 0 )
        return (unsigned int)LastError;
      return v10;
    }
    v4 = (PSID *)Dns_MemNew<unsigned char>(TokenInformationLength);
    if ( !v4 )
      return (unsigned int)-2147024882;
    if ( !GetTokenInformation(TokenHandle, TokenPrimaryGroup, v4, TokenInformationLength, &TokenInformationLength) )
    {
      v12 = GetLastError();
      v10 = (unsigned __int16)v12 | 0x80070000;
      if ( v12 <= 0 )
        v10 = v12;
      goto LABEL_31;
    }
    TokenInformationLength = GetLengthSid(*v4);
    v13 = Dns_MemNew<unsigned char>(TokenInformationLength);
    v5 = v13;
    if ( !v13 )
    {
      v10 = -2147024882;
LABEL_31:
      if ( v4 )
        operator delete(v4);
      if ( v5 )
        operator delete(v5);
      return v10;
    }
    if ( !CopySid(TokenInformationLength, v13, *v4) )
      goto LABEL_27;
    *a3 = v5;
    operator delete(v4);
  }
  return 0i64;
}
// 140184CA8: using guessed type void __stdcall operator delete(void *);
