//----- (00000001400A775C) ----------------------------------------------------
__int64 __fastcall RpcUtil_ScreenIps(__int64 a1, char a2)
{
  unsigned int v2; // edi
  unsigned int v5; // ebp
  void *v6; // rbx
  _DWORD *v7; // rsi
  int v8; // eax
  int v9; // ebx
  u_long v10; // ecx
  int v11; // eax
  const char *v12; // rax
  __int64 v13; // rdx
  __int64 v14; // r8

  v2 = 0;
  if ( a1 )
  {
    v5 = 0;
    if ( *(_DWORD *)(a1 + 4) )
    {
      v6 = g_ServerAddrs;
      while ( 1 )
      {
        v7 = (_DWORD *)(((unsigned __int64)v5 << 6) + a1 + 32);
        LOBYTE(v8) = DnsAddr_IsClear(v7);
        if ( v8 )
          break;
        if ( *(_WORD *)v7 == 2 )
        {
          v9 = v7[1];
          if ( v9 == ntohl(0xFFFFFFFF) )
            break;
          v10 = *(_WORD *)v7 == 2 ? v7[1] : -1;
          if ( (htonl(v10) & 0xF0000000) == -536870912 )
            break;
          v6 = g_ServerAddrs;
        }
        LOBYTE(v11) = DnsAddr_IsLoopback(v7, 0);
        if ( v11 && (a2 & 1) == 0 || v6 && (a2 & 2) == 0 && (unsigned int)DnsAddrArray_ContainsAddr((__int64)v6, v7, 3) )
          break;
        if ( ++v5 >= *(_DWORD *)(a1 + 4) )
          return v2;
      }
      v2 = 9552;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        v12 = DnsAddr_Ntoa((struct in_addr *)(a1 + ((unsigned __int64)v5 << 6) + 32));
        WPP_SF_dsD(*((_QWORD *)WPP_GLOBAL_Control + 7), v13, v14, v5, (__int64)v12);
      }
    }
  }
  return v2;
}
// 1400A77AE: variable 'v8' is possibly undefined
// 1400A77F9: variable 'v11' is possibly undefined
// 1400A787C: variable 'v13' is possibly undefined
// 1400A787C: variable 'v14' is possibly undefined
