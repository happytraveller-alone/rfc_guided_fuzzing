//----- (00000001400BD294) ----------------------------------------------------
void __fastcall Wins_ProcessResponse(struct _DNS_MSGINFO *a1, __int64 a2)
{
  unsigned __int64 v3; // rbx
  _BYTE *v4; // r13
  unsigned __int16 v5; // ax
  CDnsClientSubnetRecordsTrie *v6; // rcx
  unsigned __int16 v7; // dx
  char *v8; // r13
  u_short v9; // ax
  _BYTE *v10; // rax
  __int64 v11; // rdx
  int v12; // r8d
  CDnsClientSubnetRecordsTrie *v13; // rcx
  const char *v14; // rbx
  char *v15; // rax
  __int16 v16; // bx
  _QWORD *v17; // r8
  int v18; // eax
  CDnsClientSubnetRecordsTrie *v19; // r10
  unsigned __int16 *v20; // r13
  int v21; // ecx
  _BYTE *ARecord; // rax
  __int16 v23; // cx
  char *v24; // rax
  int v25; // r13d
  char *v26; // rax
  unsigned __int16 v27; // r13
  __int16 v28; // ax
  CDnsClientSubnetRecordsTrie *v29; // rcx
  unsigned __int16 v30; // dx
  char *v31; // rax
  struct _DNS_MSGINFO *v32; // rcx
  __int64 v33; // [rsp+20h] [rbp-60h]
  int v34; // [rsp+60h] [rbp-20h]
  __int64 v35; // [rsp+68h] [rbp-18h]
  _QWORD *v36; // [rsp+70h] [rbp-10h] BYREF
  __int64 *v37; // [rsp+78h] [rbp-8h]
  int v38; // [rsp+C8h] [rbp+48h] BYREF
  __int64 v39; // [rsp+D0h] [rbp+50h]
  int v40; // [rsp+D8h] [rbp+58h]

  v34 = 0;
  _InterlockedAdd(&dword_1401C7C2C, 1u);
  _InterlockedAdd((volatile signed __int32 *)pcWinsResponseSent, 1u);
  if ( !*(_WORD *)(a2 + 6310) || (*(_BYTE *)(a2 + 6307) & 0xF) != 0 )
  {
    if ( (*(_BYTE *)(a2 + 6307) & 0xF) == 3 )
    {
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x1Cu, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids);
      }
      *((_BYTE *)a1 + 1337) = 1;
      v19 = WPP_GLOBAL_Control;
      goto LABEL_141;
    }
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x1Du, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids);
    }
    if ( (unsigned int)Wins_MakeWinsRequest((__int64)a1, 0i64, 0, 0i64) )
      return;
    goto LABEL_139;
  }
  v3 = *(unsigned __int16 *)(a2 + 6302) + a2 + 6304;
  v4 = (_BYTE *)(a2 + 6316);
  v5 = *(_WORD *)(a2 + 6308);
  if ( v5 )
  {
    v6 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
      goto LABEL_125;
    if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) == 0 || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
      goto LABEL_121;
    WPP_SF_Dq(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x1Eu, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids, v5);
    goto LABEL_120;
  }
  if ( a2 + 6350 > v3 )
  {
    v6 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
      goto LABEL_125;
    if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) == 0 || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
      goto LABEL_121;
    WPP_SF_qqq(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x1Fu,
      (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
      v3,
      a2 + 6316,
      a2 + 6350);
    goto LABEL_120;
  }
  v7 = 32;
  if ( *v4 != 32 )
  {
    v6 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
      goto LABEL_125;
    if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) == 0 || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
      goto LABEL_121;
LABEL_119:
    WPP_SF_(*((_QWORD *)v6 + 7), v7, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids);
    goto LABEL_120;
  }
  v8 = v4 + 33;
  do
  {
    if ( !*v8 )
    {
      if ( (unsigned __int64)(v8 + 17) > v3 )
      {
        v6 = WPP_GLOBAL_Control;
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
        {
          if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) != 0 && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
          {
            v7 = 35;
            goto LABEL_119;
          }
          goto LABEL_121;
        }
        goto LABEL_125;
      }
      if ( *(_WORD *)(v8 + 1) != 0x2000 || *(_WORD *)(v8 + 3) != 256 )
      {
        v6 = WPP_GLOBAL_Control;
        if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
          goto LABEL_125;
        if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) == 0 || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
          goto LABEL_121;
        v7 = 36;
        goto LABEL_119;
      }
      v9 = ntohs(*(_WORD *)(v8 + 9));
      LOWORD(v38) = v9;
      if ( v9 != 6 * (v9 / 6ui64) || (unsigned __int64)&v8[v9 + 11] > v3 )
      {
        v6 = WPP_GLOBAL_Control;
        if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
          goto LABEL_125;
        if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) == 0 || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
          goto LABEL_121;
        WPP_SF_D(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0x25u,
          (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
          v9);
LABEL_120:
        v6 = WPP_GLOBAL_Control;
        goto LABEL_121;
      }
      v10 = (_BYTE *)*((_QWORD *)a1 + 24);
      v35 = (__int64)v10;
      if ( !v10 )
      {
        v10 = Lookup_ZoneNode(*((_QWORD *)a1 + 26), 0i64, 0i64, *((unsigned __int16 **)a1 + 175), 16, 0i64, 0i64, 0i64);
        v35 = (__int64)v10;
        if ( !v10 )
          goto LABEL_120;
      }
      v11 = *((_QWORD *)a1 + 26);
      if ( !v11 || *(_DWORD *)(v11 + 372) != 1 || (v12 = 1, (*(_BYTE *)(v11 + 1040) & 4) == 0) )
        v12 = 0;
      v40 = v12;
      v13 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
      {
        if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) != 0 && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
        {
          if ( v11 )
            v39 = *(_QWORD *)(v11 + 16);
          else
            v39 = 0i64;
          v14 = "unsigned";
          if ( v12 )
            v14 = "signed";
          v15 = Dbg_NodeName((__int64)v10);
          WPP_SF_sss(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x26u,
            (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
            v15,
            (__int64)v14,
            v39);
          v13 = WPP_GLOBAL_Control;
        }
        if ( v13 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)v13 + 17) & 0x10000) != 0
          && *((_BYTE *)v13 + 65) >= 4u )
        {
          WPP_SF_Dd(
            *((_QWORD *)v13 + 7),
            0x27u,
            (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
            *(_DWORD *)(*((_QWORD *)a1 + 164) + 64i64));
        }
      }
      v16 = v38;
      v17 = 0i64;
      v18 = *((_DWORD *)a1 + 142) + *(_DWORD *)(*((_QWORD *)a1 + 164) + 64i64);
      v37 = (__int64 *)&v36;
      *((_BYTE *)a1 + 1337) = 1;
      v19 = WPP_GLOBAL_Control;
      LODWORD(v39) = v18;
      v36 = 0i64;
      if ( v16 )
      {
        v20 = (unsigned __int16 *)(v8 + 5);
        while ( 1 )
        {
          v20 += 3;
          v16 -= 6;
          v21 = *(_DWORD *)(v20 + 1);
          if ( *(char *)v20 < 0 || v21 == -1 )
          {
            if ( v19 == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
              || (*((_DWORD *)v19 + 17) & 0x10000) == 0
              || *((_BYTE *)v19 + 65) < 4u )
            {
              goto LABEL_69;
            }
            v24 = inet_ntoa((struct in_addr)v21);
            LODWORD(v33) = *v20;
            WPP_SF_qDs(
              *((_QWORD *)WPP_GLOBAL_Control + 7),
              0x28u,
              (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
              a1,
              v33,
              v24);
          }
          else
          {
            *((_BYTE *)a1 + 1337) = 0;
            ARecord = RR_CreateARecord(v21, v18, 0x24u);
            if ( !ARecord )
              goto LABEL_120;
            *((_DWORD *)ARecord + 7) &= ~4u;
            *((_DWORD *)ARecord + 7) |= 3u;
            ARecord[8] = -63;
            *v37 = (__int64)ARecord;
            v37 = (__int64 *)ARecord;
            if ( !v40 )
            {
              v23 = *((_WORD *)a1 + 240);
              if ( v23 == 1 || v23 == 255 || *((_BYTE *)a1 + 1415) == 3 )
              {
                if ( (unsigned int)Wire_AddResourceRecordToMessage(
                                     (__int64)a1,
                                     0i64,
                                     *((_WORD *)a1 + 221),
                                     (__int64)ARecord,
                                     0,
                                     0i64) )
                {
                  v34 = 1;
                  ++*((_WORD *)a1 + *((unsigned __int8 *)a1 + 1415) + 3154);
                }
              }
            }
          }
          v18 = v39;
          v19 = WPP_GLOBAL_Control;
LABEL_69:
          if ( !v16 )
          {
            v17 = v36;
            break;
          }
        }
      }
      if ( v40 )
      {
        *((_BYTE *)a1 + 1455) = 0;
        if ( v17 )
        {
          v25 = DnsOls_ProcessWinsResponse((__int64)a1, v35, &v36);
          if ( v25 )
          {
            if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
              && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) != 0
              && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
            {
              v31 = Dbg_NodeName(v35);
              WPP_SF_Ds(
                *((_QWORD *)WPP_GLOBAL_Control + 7),
                0x2Cu,
                (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
                v25,
                (__int64)v31);
            }
            goto LABEL_126;
          }
          v38 = 0;
          if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
            && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) != 0
            && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
          {
            v26 = Dbg_NodeName(v35);
            WPP_SF_sq(
              *((_QWORD *)WPP_GLOBAL_Control + 7),
              0x29u,
              (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
              v26);
          }
          if ( *((_WORD *)a1 + 3155) || *((_BYTE *)a1 + 1415) != 1 )
            v27 = *((_WORD *)a1 + 220);
          else
            v27 = *((_WORD *)a1 + 240);
          if ( !*((_QWORD *)a1 + 24) )
          {
            *((_QWORD *)a1 + 58) = v35;
            *((_QWORD *)a1 + 25) = v35;
            *((_QWORD *)a1 + 24) = v35;
            *((_QWORD *)a1 + 31) = 0i64;
          }
          v28 = Wire_WriteRecordsAtNodeToMessage(
                  (__int64)a1,
                  *((_QWORD *)a1 + 24),
                  v27,
                  0i64,
                  *((_WORD *)a1 + 221),
                  0,
                  &v38);
          if ( v38 )
          {
            v29 = WPP_GLOBAL_Control;
            if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
              || (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) == 0
              || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
            {
              goto LABEL_126;
            }
            v30 = 42;
            goto LABEL_89;
          }
          if ( !v28 && v27 == 1 )
          {
            v29 = WPP_GLOBAL_Control;
            if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
              || (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) == 0
              || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
            {
              goto LABEL_126;
            }
            v30 = 43;
LABEL_89:
            WPP_SF_q(*((_QWORD *)v29 + 7), v30, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids, a1);
            goto LABEL_126;
          }
        }
      }
      else if ( v17 )
      {
        if ( v19 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)v19 + 17) & 0x10000) != 0
          && *((_BYTE *)v19 + 65) >= 4u )
        {
          WPP_SF_Dd(
            *((_QWORD *)v19 + 7),
            0x2Eu,
            (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids,
            *(_DWORD *)(*((_QWORD *)a1 + 164) + 64i64));
          v17 = v36;
        }
        RR_CacheSetAtNode(
          0i64,
          v35,
          (__int64)v17,
          v37,
          *(_DWORD *)(*((_QWORD *)a1 + 164) + 64i64),
          *((_DWORD *)a1 + 142),
          0,
          0i64,
          0,
          0i64,
          0i64,
          0);
      }
      else
      {
        if ( v19 == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          || (*((_DWORD *)v19 + 17) & 0x10000) == 0
          || *((_BYTE *)v19 + 65) < 4u )
        {
LABEL_140:
          if ( v34 )
          {
LABEL_145:
            v32 = a1;
            goto LABEL_146;
          }
LABEL_141:
          if ( v19 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
            && (*((_DWORD *)v19 + 17) & 0x10000) != 0
            && *((_BYTE *)v19 + 65) >= 4u )
          {
            WPP_SF_q(*((_QWORD *)v19 + 7), 0x2Fu, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids, a1);
          }
          goto LABEL_145;
        }
        WPP_SF_(*((_QWORD *)v19 + 7), 0x2Du, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids);
      }
LABEL_139:
      v19 = WPP_GLOBAL_Control;
      goto LABEL_140;
    }
    v8 += *v8 + 1;
  }
  while ( (unsigned __int64)v8 < v3 );
  v6 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
  {
    if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x10000) != 0 && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      v7 = 34;
      goto LABEL_119;
    }
LABEL_121:
    if ( v6 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)v6 + 17) & 0x10000) != 0
      && *((_BYTE *)v6 + 65) >= 4u )
    {
      WPP_SF_q(*((_QWORD *)v6 + 7), 0x30u, (__int64)&WPP_ae7d10ab80043f064358eb7738862626_Traceguids, a1);
    }
  }
LABEL_125:
  if ( !(unsigned int)Wins_MakeWinsRequest((__int64)a1, 0i64, 0, 0i64) )
  {
LABEL_126:
    v32 = a1;
    if ( !*((_WORD *)a1 + 3155) )
    {
      Reject_Request((__int64)a1, 2u, 0);
      return;
    }
LABEL_146:
    Answer_ContinueNextLookupForQuery(v32);
  }
}
// 1400BD758: variable 'v33' is possibly undefined
// 1401C7C2C: using guessed type int dword_1401C7C2C;
// 1401C85E8: using guessed type __int64 pcWinsResponseSent;
