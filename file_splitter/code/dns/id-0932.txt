//----- (000000014007E94C) ----------------------------------------------------
__int64 __fastcall RpcUtil_ApiAccessCheck(int a1)
{
  PSECURITY_DESCRIPTOR SecurityDescriptor; // rdi
  unsigned int v2; // ebx
  NTSTATUS v3; // ebx
  CDnsClientSubnetRecordsTrie *v4; // rcx
  struct _UNICODE_STRING ObjectName; // [rsp+60h] [rbp-48h] BYREF
  struct _UNICODE_STRING ObjectTypeName; // [rsp+70h] [rbp-38h] BYREF
  struct _UNICODE_STRING DestinationString; // [rsp+80h] [rbp-28h] BYREF
  int OldValue; // [rsp+B0h] [rbp+8h] BYREF
  unsigned __int8 GenerateOnClose; // [rsp+B8h] [rbp+10h] BYREF
  int AccessStatus; // [rsp+C0h] [rbp+18h] BYREF
  DWORD GrantedAccess; // [rsp+C8h] [rbp+20h] BYREF

  OldValue = a1;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x27u, (__int64)&WPP_ba1772ab8ae33e60555253e1dffe9548_Traceguids);
  }
  SecurityDescriptor = g_GlobalSecurityDescriptor;
  RtlInitUnicodeString(&DestinationString, L"DNS");
  RtlInitUnicodeString(&ObjectTypeName, L"DnsServer");
  RtlInitUnicodeString(&ObjectName, L"-");
  RtlAdjustPrivilege(0x15u, 1u, 0, (PBOOLEAN)&OldValue);
  v2 = RpcImpersonateClient(0i64);
  if ( !v2 )
  {
    v3 = NtAccessCheckAndAuditAlarm(
           &DestinationString,
           0i64,
           &ObjectTypeName,
           &ObjectName,
           SecurityDescriptor,
           2u,
           &g_GlobalSecurityInfoMapping,
           0,
           &GrantedAccess,
           &AccessStatus,
           &GenerateOnClose);
    RpcRevertToSelf();
    if ( v3 < 0 || AccessStatus )
    {
      v2 = 5;
      goto LABEL_11;
    }
    v2 = 0;
  }
  if ( !v2 )
  {
    v4 = WPP_GLOBAL_Control;
    goto LABEL_17;
  }
LABEL_11:
  v4 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    WPP_SF_D(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x28u, (__int64)&WPP_ba1772ab8ae33e60555253e1dffe9548_Traceguids, v2);
    v4 = WPP_GLOBAL_Control;
  }
  v2 = 5;
LABEL_17:
  if ( v4 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)v4 + 68) & 4) != 0
    && *((_BYTE *)v4 + 65) >= 4u )
  {
    WPP_SF_D(*((_QWORD *)v4 + 7), 0x29u, (__int64)&WPP_ba1772ab8ae33e60555253e1dffe9548_Traceguids, v2);
  }
  return v2;
}
