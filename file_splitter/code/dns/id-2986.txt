//----- (0000000140157E88) ----------------------------------------------------
HLOCAL __fastcall Dns_CleanupSecurityPacketInfoEx(_QWORD *a1, int a2)
{
  __int64 v4; // rcx
  void *v5; // rcx
  void *v6; // rcx
  void *v7; // rcx
  void *v8; // rcx
  HLOCAL result; // rax

  if ( a1 )
  {
    v4 = a1[9];
    if ( v4 )
      DnsApiFree(v4);
    v5 = (void *)a1[7];
    if ( v5 )
      Dns_Free(v5);
    v6 = (void *)a1[8];
    if ( v6 )
      Dns_Free(v6);
    v7 = (void *)a1[16];
    if ( v7 )
      Dns_Free(v7);
    v8 = (void *)a1[4];
    if ( v8 )
      Dns_Free(v8);
    if ( a2 )
    {
      result = Dns_Free(a1);
      ++SecPackFree;
    }
    else
    {
      return memset_0(a1, 0, 0x90ui64);
    }
  }
  return result;
}
// 140183D60: using guessed type __int64 __fastcall DnsApiFree(_QWORD);
// 1401B9E1C: using guessed type int SecPackFree;
