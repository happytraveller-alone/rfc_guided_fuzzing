//----- (0000000140147CE0) ----------------------------------------------------
__int64 __fastcall CDnsPolicyContent::GetScope(CDnsPolicyContent *this, unsigned __int16 *const a2)
{
  unsigned int v2; // esi
  __int64 *v5; // rbx
  const unsigned __int16 *v6; // r9
  unsigned int v7; // edx
  const unsigned __int16 *v8; // r9
  const wchar_t *v9; // r8

  v2 = 0;
  v5 = (__int64 *)**((_QWORD **)this + 2);
  if ( *((_QWORD *)this + 3) == 1i64 )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      v6 = (const unsigned __int16 *)(v5 + 2);
      if ( (unsigned __int64)v5[5] >= 8 )
        v6 = *(const unsigned __int16 **)v6;
      WPP_SF_S(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x60u,
        (__int64)&WPP_42dbba61d26d3062f1ad4e084cdc81fe_Traceguids,
        v6);
    }
LABEL_25:
    v9 = (const wchar_t *)(v5 + 2);
    if ( (unsigned __int64)v5[5] >= 8 )
      v9 = *(const wchar_t **)v9;
    wcscpy_s(a2, 0xFFui64, v9);
  }
  else
  {
    if ( *(_DWORD *)this == *((_DWORD *)this + 1) )
    {
      EnterCriticalSection(&g_csPolicyContent);
      if ( *(_DWORD *)this == *((_DWORD *)this + 1) )
        *(_DWORD *)this = 0;
      LeaveCriticalSection(&g_csPolicyContent);
    }
    v7 = (unsigned int)_InterlockedIncrement((volatile signed __int32 *)this) % *((_DWORD *)this + 2);
    if ( !v7 )
      v7 = *((_DWORD *)this + 2);
    while ( v5 != *((__int64 **)this + 2) )
    {
      v2 += *((_DWORD *)v5 + 14);
      if ( v7 <= v2 )
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
        {
          v8 = (const unsigned __int16 *)(v5 + 2);
          if ( (unsigned __int64)v5[5] >= 8 )
            v8 = *(const unsigned __int16 **)v8;
          WPP_SF_SD(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x61u,
            (__int64)&WPP_42dbba61d26d3062f1ad4e084cdc81fe_Traceguids,
            v8);
        }
        goto LABEL_25;
      }
      v5 = (__int64 *)*v5;
    }
  }
  return 0i64;
}
