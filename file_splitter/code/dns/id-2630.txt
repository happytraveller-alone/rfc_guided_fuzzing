//----- (0000000140139754) ----------------------------------------------------
void __fastcall UpdatePolicyInMsg(struct _DNS_MSGINFO *a1, const void **a2)
{
  char v4; // bl
  char *v5; // r14
  __int64 v6; // rax
  bool v7; // r14
  __int64 v8; // rax
  __int64 v9; // rax
  bool v10; // r14
  __int64 v11; // rax
  void *v12[3]; // [rsp+30h] [rbp-30h] BYREF
  unsigned __int64 v13; // [rsp+48h] [rbp-18h]

  v4 = 0;
  v5 = (char *)a1 + 3712;
  if ( !*((_WORD *)a1 + 1856) )
  {
    v6 = CDnsPolicy::Name(a2, (__int64)v12);
    if ( *(_QWORD *)(v6 + 24) >= 8ui64 )
      v6 = *(_QWORD *)v6;
    v7 = (int)StringCchCopyW(v5, 512i64, (char *)v6) < 0;
    if ( v13 >= 8 )
      operator delete(v12[0]);
    if ( v7 )
    {
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        v8 = CDnsPolicy::Name(a2, (__int64)v12);
        v4 = 1;
        if ( *(_QWORD *)(v8 + 24) >= 8ui64 )
          v8 = *(_QWORD *)v8;
        WPP_SF_S(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0xB9u,
          (__int64)&WPP_bbbcc621566c3408fe84d6a85874d543_Traceguids,
          (const unsigned __int16 *)v8);
      }
      if ( (v4 & 1) != 0 )
      {
        v4 &= ~1u;
        if ( v13 >= 8 )
          operator delete(v12[0]);
      }
    }
  }
  if ( *((_DWORD *)a2 + 22) == 3 && !*((_WORD *)a1 + 2368) )
  {
    v9 = CDnsPolicy::Name(a2, (__int64)v12);
    if ( *(_QWORD *)(v9 + 24) >= 8ui64 )
      v9 = *(_QWORD *)v9;
    v10 = (int)StringCchCopyW((char *)a1 + 4736, 512i64, (char *)v9) < 0;
    if ( v13 >= 8 )
      operator delete(v12[0]);
    if ( v10 )
    {
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        v11 = CDnsPolicy::Name(a2, (__int64)v12);
        v4 |= 2u;
        if ( *(_QWORD *)(v11 + 24) >= 8ui64 )
          v11 = *(_QWORD *)v11;
        WPP_SF_S(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0xBAu,
          (__int64)&WPP_bbbcc621566c3408fe84d6a85874d543_Traceguids,
          (const unsigned __int16 *)v11);
      }
      if ( (v4 & 2) != 0 && v13 >= 8 )
        operator delete(v12[0]);
    }
  }
  if ( !*((_DWORD *)a2 + 23) )
    *((_DWORD *)a1 + 1572) |= 0x800u;
  if ( (*((_DWORD *)a2 + 23) & 0xFFFFFFFD) == 0 )
    *((_DWORD *)a1 + 1572) |= 0x40u;
}
// 140184CA8: using guessed type void __stdcall operator delete(void *);
