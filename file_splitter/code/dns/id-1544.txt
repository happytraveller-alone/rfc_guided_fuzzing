//----- (00000001400C2D58) ----------------------------------------------------
void __fastcall updateZoneSoa(struct _zone_info *a1, __int64 a2)
{
  unsigned int v4; // edi
  __int64 v5; // rcx
  int v6; // esi
  int v7; // esi
  int v8; // esi
  u_long v9; // ecx
  u_long v10; // eax
  int v11; // edx
  bool v12; // zf

  *((_QWORD *)a1 + 42) = a2;
  v4 = (((*(_DWORD *)(a2 + 56) << 16) | *(_DWORD *)(a2 + 56) & 0xFF00) << 8) | ((HIWORD(*(_DWORD *)(a2 + 56)) | *(_DWORD *)(a2 + 56) & 0xFF0000u) >> 8);
  if ( *((_DWORD *)a1 + 129) && (int)(*((_DWORD *)a1 + 128) - v4) > 0 )
  {
    v5 = *((_QWORD *)a1 + 5);
    v6 = 0;
    if ( v5 && *((_DWORD *)a1 + 93) == 1 && (*((_BYTE *)a1 + 1040) & 4) != 0 )
    {
      v6 = 1;
      Dbase_LockEx(v5, 2, (__int64)"ds\\dns\\server\\server\\zone.c", 65);
    }
    v4 = *((_DWORD *)a1 + 128);
    *(_DWORD *)(a2 + 56) = (((v4 << 16) | v4 & 0xFF00) << 8) | ((HIWORD(v4) | v4 & 0xFF0000) >> 8);
    if ( v6 )
    {
      v7 = DnsOls_SignZone(a1, *((_QWORD *)a1 + 5), 6i64, 0, 0i64);
      Dbase_UnlockEx(*((_QWORD *)a1 + 5), 2, (__int64)"ds\\dns\\server\\server\\zone.c", 93);
      if ( v7 )
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 0x10) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
        {
          WPP_SF_Ds(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x3Du,
            (__int64)&WPP_e9a0d5dea449334d7c383477da81f939_Traceguids,
            v7,
            *((_QWORD *)a1 + 2));
        }
      }
    }
  }
  v8 = 0;
  *((_DWORD *)a1 + 128) = v4;
  if ( !*((_DWORD *)a1 + 129) )
  {
    v8 = 1;
    *((_DWORD *)a1 + 129) = v4;
  }
  v9 = *(_DWORD *)(a2 + 72);
  *((_DWORD *)a1 + 132) = v9;
  v10 = ntohl(v9);
  v12 = (*((_BYTE *)a1 + 388) & 1) == 0;
  *((_DWORD *)a1 + 133) = v10;
  if ( !v12 )
    Zone_SetSoaPrimary((__int64)a1);
  if ( v8 )
  {
    if ( *((_DWORD *)a1 + 93) == 1 )
      Zone_CheckAndFixDefaultRecordsOnLoad((__int64)a1, v11);
  }
}
// 1400C2EF9: variable 'v11' is possibly undefined
