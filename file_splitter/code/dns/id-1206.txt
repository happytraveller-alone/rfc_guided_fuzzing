//----- (000000014009BD80) ----------------------------------------------------
__int64 __fastcall Reject_RequestIntact(__int64 a1, unsigned __int16 a2, char a3)
{
  __int64 v6; // rax
  __int64 result; // rax

  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x800) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
  {
    WPP_SF_q(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x2Du, (__int64)&WPP_398a615c07233f5235cf23860937c5e7_Traceguids, a1);
  }
  v6 = *(unsigned __int16 *)(a1 + 6302);
  *(_BYTE *)(a1 + 6306) |= 0x80u;
  *(_QWORD *)(a1 + 32) = v6 + a1 + 6304;
  if ( a2 > 0xFu )
  {
    *(_DWORD *)(a1 + 592) |= 2u;
    *(_WORD *)(a1 + 600) = dword_1401B98E8;
    *(_WORD *)(a1 + 596) = (unsigned __int8)(a2 >> 4);
  }
  *(_BYTE *)(a1 + 6307) &= 0xF0u;
  *(_BYTE *)(a1 + 6307) |= a2 & 0xF;
  if ( (a3 & 1) != 0 || (result = checkAndSuppressBadSender(a1), !(_DWORD)result) )
  {
    Stats_updateErrorStats(a2);
    return Send_Msg(a1, 0);
  }
  return result;
}
// 1401B98E8: using guessed type int dword_1401B98E8;
