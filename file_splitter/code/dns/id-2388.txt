//----- (0000000140123F50) ----------------------------------------------------
char *__fastcall NsecWriteCanonicalizedRdata(char *a1, unsigned __int64 a2, __int64 a3)
{
  __int64 v4; // rdx
  size_t v8; // r8
  __int64 v9; // rcx
  char *v10; // rbx
  char *v11; // rbp
  int v12; // [rsp+30h] [rbp-18h]

  v4 = *(unsigned __int16 *)(a3 + 14);
  if ( a2 < (unsigned __int64)&a1[v4 - 2] )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 28) & 0x20) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 25) >= 4u )
    {
      v12 = v4 - 2;
      WPP_SF_qqqd(*((_QWORD *)WPP_GLOBAL_Control + 2), 0x12u, a3, a3, a2, a1, v12);
    }
    return 0i64;
  }
  v8 = *(unsigned __int8 *)(a3 + 56);
  if ( a2 < (unsigned __int64)&a1[v8] )
    return 0i64;
  memcpy_0(a1, (const void *)(a3 + 58), v8);
  v9 = *(unsigned __int8 *)(a3 + 56);
  v10 = &a1[v9];
  v11 = &v10[*(unsigned __int16 *)(a3 + 14) - (unsigned int)v9 - 2];
  if ( a2 < (unsigned __int64)v11 )
    return 0i64;
  memcpy_0(v10, (const void *)(v9 + a3 + 58), *(unsigned __int16 *)(a3 + 14) - (unsigned int)v9 - 2);
  return v11;
}
