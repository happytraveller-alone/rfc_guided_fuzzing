//----- (0000000140120F90) ----------------------------------------------------
__int64 __fastcall DnskeyFileRead(__int64 a1, unsigned int a2, __int64 a3, __int64 a4)
{
  unsigned int v7; // ebx
  u_short v8; // r15
  char v9; // r13
  unsigned int v10; // edi
  char v11; // r12
  _BYTE *v12; // rax
  _BYTE *v13; // rdi
  u_short v14; // ax
  size_t v15; // r8
  void *v16; // rdx
  void *Src; // [rsp+30h] [rbp-10h] BYREF
  size_t Size; // [rsp+78h] [rbp+38h] BYREF

  Src = 0i64;
  if ( a2 < 4 )
  {
    v7 = -1072573181;
    goto LABEL_19;
  }
  if ( !(unsigned int)File_ParseDwordToken(&Size, a3, a4) )
    goto LABEL_18;
  v8 = Size;
  if ( (unsigned int)Size > 0xFFFF )
    goto LABEL_18;
  if ( !(unsigned int)File_ParseDwordToken(&Size, a3 + 16, a4) )
    goto LABEL_18;
  v9 = Size;
  if ( (unsigned int)Size > 0xFF )
    goto LABEL_18;
  v10 = a2 - 2;
  v11 = Dns_ValueForString((__int64)&DnssecAlgorithmTable, 1, *(_QWORD *)(a3 + 32), *(_DWORD *)(a3 + 40));
  if ( v11 != -1 )
    goto LABEL_11;
  if ( !(unsigned int)File_ParseDwordToken(&Size, a3 + 32, a4) || (unsigned int)Size > 0xFF )
  {
LABEL_18:
    v7 = -1072573183;
    goto LABEL_19;
  }
  v11 = Size;
LABEL_11:
  v7 = buildKeyOrSignatureFromTokens(&Src, &Size, v10 - 1, a3 + 48);
  if ( !v7 )
  {
    if ( (unsigned int)Size > 0xFFFF || (unsigned __int16)(Size + 4) < 4u )
    {
      v7 = 13;
    }
    else
    {
      v12 = RR_AllocateEx((unsigned __int16)Size + 4, 0, 0);
      v13 = v12;
      if ( v12 )
      {
        *(_QWORD *)(a4 + 800) = v12;
        v14 = htons(v8);
        v15 = (unsigned int)Size;
        v16 = Src;
        *((_WORD *)v13 + 28) = v14;
        v13[58] = v9;
        v13[59] = v11;
        memcpy_0(v13 + 60, v16, v15);
      }
      else
      {
        v7 = 14;
      }
    }
  }
LABEL_19:
  Mem_Free(Src, 0i64, 0i64, (__int64)"ds\\dns\\server\\dnscore\\rrfile.c", 2810);
  if ( v7 == -1072573183 )
    *(_DWORD *)(a4 + 1596) = -1072573180;
  return v7;
}
