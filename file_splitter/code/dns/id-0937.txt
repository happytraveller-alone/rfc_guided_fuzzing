//----- (000000014007F268) ----------------------------------------------------
__int64 __fastcall RpcUtil_SwitchSecurityContext(int a1)
{
  unsigned int v1; // ebx
  CDnsClientSubnetRecordsTrie *v2; // rax
  unsigned __int16 v3; // dx
  CDnsClientSubnetRecordsTrie *v4; // rax
  unsigned __int16 v5; // dx

  if ( a1 )
  {
    v1 = RpcImpersonateClient(0i64);
    if ( v1 )
    {
      v2 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
        && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
      {
        v3 = 59;
LABEL_16:
        WPP_SF_D(*((_QWORD *)v2 + 7), v3, (__int64)&WPP_ba1772ab8ae33e60555253e1dffe9548_Traceguids, v1);
        return v1;
      }
      return v1;
    }
    v4 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      || (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) == 0
      || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
    {
      return v1;
    }
    v5 = 60;
LABEL_21:
    WPP_SF_(*((_QWORD *)v4 + 7), v5, (__int64)&WPP_ba1772ab8ae33e60555253e1dffe9548_Traceguids);
    return v1;
  }
  v1 = RpcRevertToSelf();
  if ( !v1 )
  {
    v4 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      || (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) == 0
      || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
    {
      return v1;
    }
    v5 = 62;
    goto LABEL_21;
  }
  v2 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    v3 = 61;
    goto LABEL_16;
  }
  return v1;
}
