//----- (00000001400F8610) ----------------------------------------------------
__int64 __fastcall DnsOls_AddSkdToSkdList(_QWORD *a1, __int64 a2)
{
  unsigned int v2; // ebx
  _QWORD *v5; // r14
  _QWORD *v6; // rbp
  _QWORD *i; // r15
  int v8; // eax
  char *v9; // rax
  char *v10; // rax

  v2 = 0;
  v5 = 0i64;
  if ( a1 && a2 )
  {
    v6 = (_QWORD *)*a1;
    *(_QWORD *)a2 = 0i64;
    if ( v6 )
    {
      for ( i = v6; ; i = (_QWORD *)*i )
      {
        v8 = memcmp_0(i + 1, (const void *)(a2 + 8), 0x10ui64);
        if ( !v8 )
          break;
        if ( v8 > 0 || !*i )
        {
          if ( v5 )
          {
            *(_QWORD *)a2 = *v5;
            *v5 = a2;
          }
          else
          {
            *(_QWORD *)a2 = v6;
            *a1 = a2;
          }
          goto LABEL_18;
        }
        v5 = i;
      }
      v2 = 13;
      if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control )
        return v2;
      if ( (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x200000) != 0 && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
      {
        v9 = Dbg_GuidString((const IID *)(a2 + 8));
        WPP_SF_S(
          *((_QWORD *)WPP_GLOBAL_Control + 7),
          0xEu,
          (__int64)&WPP_bc8d8ed5e1cd3d5e5de49867d4cbf732_Traceguids,
          (const unsigned __int16 *)v9);
      }
    }
    else
    {
      *a1 = a2;
    }
  }
  else
  {
    v2 = 87;
  }
LABEL_18:
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x200000) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    v10 = Dbg_GuidString((const IID *)(a2 + 8));
    WPP_SF_DS(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0xFu,
      (__int64)&WPP_bc8d8ed5e1cd3d5e5de49867d4cbf732_Traceguids,
      v2,
      (__int64)v10);
  }
  return v2;
}
