//----- (0000000140080B20) ----------------------------------------------------
__int64 __fastcall Dnssrv_R_DnssrvComplexOperation3(
        void *a1,
        unsigned int a2,
        __int64 a3,
        __int64 a4,
        wchar_t *String1,
        char *Str2,
        char *String2,
        int a8,
        __int64 a9,
        _DWORD *a10,
        _QWORD *a11)
{
  unsigned int VirtualizationInstance; // ebx
  int v13; // eax
  __int64 v14; // rdi
  unsigned int Zone; // eax
  __int64 v16; // r9
  __int64 result; // rax
  int v18; // [rsp+40h] [rbp-30h]
  int v19; // [rsp+50h] [rbp-20h] BYREF
  __int64 v20; // [rsp+58h] [rbp-18h] BYREF
  __int64 v21; // [rsp+60h] [rbp-10h] BYREF
  const char *MatchingFunction; // [rsp+68h] [rbp-8h]

  v21 = 0i64;
  v20 = 0i64;
  v19 = 0;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 4) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    v18 = a8;
    WPP_SF_DDSssd(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      (__int64)&WPP_GLOBAL_Control,
      a3,
      (int)a1,
      a2,
      (__int64)String1,
      (__int64)Str2,
      (__int64)String2);
  }
  VirtualizationInstance = Rpc_InitialGate(a1);
  if ( VirtualizationInstance )
    return VirtualizationInstance;
  if ( a11 && a10 )
  {
    *a11 = 0i64;
    *a10 = 0;
    MatchingFunction = findMatchingFunction((const char **)&RpcComplexOperationTable, String2, a8, &v19);
    if ( MatchingFunction )
    {
      if ( String1 && *String1 && _wcsicmp(String1, L".") && !_stricmp(Str2, "..Cache") )
      {
        VirtualizationInstance = 9611;
      }
      else
      {
        VirtualizationInstance = RpcUtil_FindVirtualizationInstance(String1, &v21);
        if ( VirtualizationInstance )
          return VirtualizationInstance;
        v13 = _stricmp("EnumeratePolicy", String2);
        v14 = v21;
        if ( !v13 || !_stricmp("GetPolicy", String2) )
          Zone = RpcUtil_FindZoneEx(Str2, 1, &v20, 0, 0i64);
        else
          Zone = RpcUtil_FindZoneEx(Str2, 0, &v20, 0, v14);
        VirtualizationInstance = Zone;
        if ( Zone )
          return VirtualizationInstance;
        result = RpcUtil_SessionSecurityInit(0i64, v20, v19, v16, 0i64);
        if ( (_DWORD)result )
          return result;
        VirtualizationInstance = ((__int64 (__fastcall *)(_QWORD, __int64, __int64, char *, int, __int64, _DWORD *, _QWORD *, int))MatchingFunction)(
                                   a2,
                                   v14,
                                   v20,
                                   String2,
                                   a8,
                                   a9,
                                   a10,
                                   a11,
                                   v18);
      }
    }
    else
    {
      VirtualizationInstance = 87;
    }
    RpcUtil_SwitchSecurityContext(0);
  }
  else
  {
    return 87;
  }
  return VirtualizationInstance;
}
// 140080CBC: variable 'v16' is possibly undefined
// 140080CEE: variable 'v18' is possibly undefined
// 140185140: using guessed type __int64 (__fastcall *_guard_dispatch_icall_fptr)(_QWORD, _QWORD);
// 1401B2CA0: using guessed type char *RpcComplexOperationTable;
