//----- (00000001400778DC) ----------------------------------------------------
__int64 __fastcall Reg_EnumScopes(
        const WCHAR *a1,
        const WCHAR *a2,
        HKEY *a3,
        DWORD a4,
        HKEY *a5,
        LPWSTR lpName,
        int a7)
{
  CDnsClientSubnetRecordsTrie *v11; // rcx
  int v12; // r15d
  HKEY v13; // rax
  const wchar_t *v14; // rax
  HKEY v16; // rax
  const unsigned __int16 *v17; // rbp
  unsigned int v18; // ebx
  CDnsClientSubnetRecordsTrie *v19; // rcx
  HKEY *v20; // rbx
  HKEY v21; // rax
  int cchName[4]; // [rsp+40h] [rbp-28h] BYREF
  unsigned int v23; // [rsp+80h] [rbp+18h] BYREF

  v23 = 0;
  cchName[0] = 255;
  v11 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    WPP_SF_D(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x67u, (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids, a4);
  }
  v12 = a7;
  if ( !*a3 )
  {
    if ( a7 )
    {
      v16 = OpenServerScopes(1, (int *)&v23);
      *a3 = v16;
      if ( !v16 )
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
        {
          WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x69u, (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids);
        }
        return v23;
      }
    }
    else
    {
      v13 = OpenZoneScopes((__int64)v11, 1, a2, a1, (LSTATUS *)&v23);
      *a3 = v13;
      if ( !v13 )
      {
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
        {
          v14 = L".";
          if ( a1 )
            v14 = a1;
          WPP_SF_SS(
            *((_QWORD *)WPP_GLOBAL_Control + 7),
            0x68u,
            (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids,
            a2,
            (__int64)v14);
        }
        return v23;
      }
    }
  }
  v17 = lpName;
  v18 = RegEnumKeyExW(*a3, a4, lpName, (LPDWORD)cchName, 0i64, 0i64, 0i64, 0i64);
  v19 = WPP_GLOBAL_Control;
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
  {
    WPP_SF_Dd(*((_QWORD *)WPP_GLOBAL_Control + 7), 0x6Au, (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids, a4);
    v19 = WPP_GLOBAL_Control;
  }
  if ( v18 )
  {
    if ( (*((_BYTE *)v19 + 68) & 2) != 0
      && v18 != 259
      && v19 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && *((_BYTE *)v19 + 65) >= 2u )
    {
      WPP_SF_Dd(*((_QWORD *)v19 + 7), 0x6Bu, (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids, a4);
    }
    return v18;
  }
  else
  {
    if ( v19 != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)v19 + 68) & 2) != 0
      && *((_BYTE *)v19 + 65) >= 4u )
    {
      WPP_SF_S(*((_QWORD *)v19 + 7), 0x6Cu, (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids, v17);
    }
    v20 = a5;
    if ( !a5 )
      return 0i64;
    v21 = Reg_OpenScope(*a3, a1, 0i64, v17, v12);
    *v20 = v21;
    if ( v21 )
      return 0i64;
    else
      return 110i64;
  }
}
// 14007796D: variable 'v11' is possibly undefined
// 1400778DC: using guessed type DWORD cchName[4];
