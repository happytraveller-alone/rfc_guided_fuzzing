//----- (00000001400A96F0) ----------------------------------------------------
__int64 __fastcall Rpc_CreateClientSubnetRecord(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, wchar_t **a6)
{
  unsigned int v6; // edx
  unsigned int ClientSubnetRecord; // ebx

  if ( !(unsigned int)IsValidFileName(*a6) )
    return 9984i64;
  ClientSubnetRecord = Policy_AcquireWriteLock(&g_hServerLevelPolicyLock, v6);
  if ( ClientSubnetRecord )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
    {
      WPP_SF_D(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x3Fu,
        (__int64)&WPP_8dcaf0ee02573174dfb45ec0cfad4f2e_Traceguids,
        ClientSubnetRecord);
    }
  }
  else
  {
    if ( (unsigned int)Verify_SubnetName((char *)*a6) )
    {
      ClientSubnetRecord = Create_ClientSubnetRecord((char **)a6, 0);
      if ( !ClientSubnetRecord )
        LogClientSubnetRecordEvent(574, (struct _ClientSubnetRecord *)a6, 0i64);
    }
    else
    {
      ClientSubnetRecord = 9977;
    }
    Lock_ReleaseWrite(g_hServerLevelPolicyLock);
  }
  return ClientSubnetRecord;
}
// 1400A971C: variable 'v6' is possibly undefined
// 1401B9240: using guessed type __int64 g_hServerLevelPolicyLock;
