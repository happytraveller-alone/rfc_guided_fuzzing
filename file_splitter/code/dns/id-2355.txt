//----- (0000000140121D30) ----------------------------------------------------
__int64 __fastcall Nsec3ParamFileRead(__int64 a1, unsigned int a2, __int64 a3, __int64 a4)
{
  unsigned int v4; // ebx
  _QWORD *v5; // r14
  char v8; // r15
  char v9; // r12
  __int64 v10; // rsi
  unsigned int v11; // esi
  _BYTE *v12; // rax
  _BYTE *v13; // rax
  _BYTE *v14; // rdi
  u_short v15; // cx
  int v17[4]; // [rsp+30h] [rbp-38h] BYREF
  unsigned int v18; // [rsp+78h] [rbp+10h] BYREF

  v4 = 0;
  v5 = 0i64;
  if ( a2 < 4 )
  {
    v4 = -1072573181;
    goto LABEL_22;
  }
  if ( (unsigned int)File_ParseDwordToken(&v18, a3, a4)
    && (v8 = v18, v18 <= 0xFF)
    && (unsigned int)File_ParseDwordToken(&v18, a3 + 16, a4)
    && (v9 = v18, v18 <= 0xFF)
    && (unsigned int)File_ParseDwordToken(&v18, a3 + 32, a4)
    && v18 <= 0xFFFF
    && (v10 = *(unsigned int *)(a3 + 56), (unsigned int)v10 <= 0x1FE) )
  {
    v17[0] = *(_DWORD *)(a3 + 56);
    if ( (_DWORD)v10 == 1 && **(_BYTE **)(a3 + 48) == 45 )
    {
      v11 = 0;
    }
    else
    {
      v12 = Mem_Alloc(v10, 0i64, "ds\\dns\\server\\dnscore\\rrfile.c", 4055);
      v5 = v12;
      if ( !v12 )
        goto LABEL_14;
      v4 = buildByteBufferFromHexStringTokens(v12, v17, 1, a3 + 48, (unsigned __int64)&v12[v10]);
      if ( v4 )
        goto LABEL_22;
      v11 = v17[0];
    }
    if ( (unsigned __int16)v11 < 0xFFFBu )
    {
      v13 = RR_AllocateEx((unsigned __int16)v11 + 5, 0, 0);
      v14 = v13;
      if ( v13 )
      {
        v15 = v18;
        *(_QWORD *)(a4 + 800) = v13;
        v13[56] = v8;
        v13[57] = v9;
        *((_WORD *)v13 + 29) = htons(v15);
        v14[60] = v11;
        memcpy_0(v14 + 61, v5, v11);
        goto LABEL_22;
      }
LABEL_14:
      v4 = 14;
      goto LABEL_22;
    }
    v4 = 13;
  }
  else
  {
    v4 = -1072573183;
  }
LABEL_22:
  Mem_Free(v5, 0i64, 0i64, (__int64)"ds\\dns\\server\\dnscore\\rrfile.c", 4116);
  if ( v4 == -1072573183 )
    *(_DWORD *)(a4 + 1596) = -1072573180;
  return v4;
}
// 140121D30: using guessed type unsigned int var_38[4];
