//----- (0000000140051E84) ----------------------------------------------------
DWORD WriteMessageToFile(HANDLE hFile, DWORD dwMessageId, ...)
{
  DWORD result; // eax
  DWORD NumberOfBytesWritten; // [rsp+40h] [rbp-28h] BYREF
  LPCVOID lpBuffer; // [rsp+48h] [rbp-20h] BYREF
  va_list v6; // [rsp+50h] [rbp-18h] BYREF
  va_list va; // [rsp+80h] [rbp+18h] BYREF

  va_start(va, dwMessageId);
  va_copy(v6, va);
  result = FormatMessageW(0x900u, 0i64, dwMessageId, 0, (LPWSTR)&lpBuffer, 0, &v6);
  if ( result )
  {
    NumberOfBytesWritten = 2 * result;
    WriteFile(hFile, lpBuffer, 2 * result, &NumberOfBytesWritten, 0i64);
    LocalFree((HLOCAL)lpBuffer);
    return NumberOfBytesWritten;
  }
  return result;
}
