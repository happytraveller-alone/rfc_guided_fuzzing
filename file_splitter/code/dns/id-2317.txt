//----- (000000014011E4A0) ----------------------------------------------------
STRSAFE_LPSTR __fastcall DnskeyFileWrite(__int64 a1, char *a2, __int64 a3)
{
  int v4; // ebx
  int v5; // edi
  unsigned int v6; // r15d
  u_short v9; // ax
  char *v10; // rax
  int v11; // ebx
  char *v12; // r11
  unsigned __int16 v13; // dx
  int v15; // [rsp+20h] [rbp-38h]
  __int64 v16; // [rsp+20h] [rbp-38h]
  int v17; // [rsp+28h] [rbp-30h]

  v4 = *(unsigned __int8 *)(a1 + 59);
  v5 = *(unsigned __int8 *)(a1 + 58);
  v6 = *(unsigned __int16 *)(a1 + 14) - 4;
  v9 = ntohs(*(_WORD *)(a1 + 56));
  v17 = v4;
  v15 = v5;
  v10 = sprintfSafeA(a2, a3 - (_QWORD)a2, "%d %d %d (\r\n", v9, v15, v17);
  v11 = 0;
  v12 = v10;
  if ( v10 )
  {
    v12 = multilineBase64Encoding((unsigned __int8 *)(a1 + 60), v6, v10, a3);
    if ( v12 )
    {
      if ( *(_WORD *)(a1 + 12) == 48 )
      {
        v13 = *(_WORD *)(a1 + 14);
        if ( v13 > 4u )
          v11 = (unsigned __int16)RR_CalculateDnsKeyTagEx((unsigned __int8 *)(a1 + 56), v13);
      }
      LODWORD(v16) = v11;
      return sprintfSafeA(v12, a3 - (_QWORD)v12, "%s\t\t) ; key tag = %u\r\n", "                        ", v16);
    }
  }
  return v12;
}
// 14011E562: variable 'v12' is possibly undefined
// 14011E562: variable 'v16' is possibly undefined
