//----- (00000001401528B0) ----------------------------------------------------
__int64 __fastcall DnsVal_CheckSignatureOnRRset(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  _QWORD *v8; // rdi
  unsigned int v9; // esi
  int Algorithm; // ebx
  LPCWSTR *v11; // rcx
  LPCWSTR *v12; // r14
  _QWORD *v13; // rax
  LPCWSTR *v15; // [rsp+80h] [rbp+8h] BYREF

  v8 = 0i64;
  v9 = 0;
  Algorithm = DnsVal_GetAlgorithm(*(_BYTE *)(a1 + 59), 1, &v15);
  if ( Algorithm < 0 )
    return (unsigned int)Algorithm;
  v11 = v15;
  v12 = v15 + 3;
  if ( !v15[3] )
    goto LABEL_11;
  v9 = *((_DWORD *)v15 + 17);
  v13 = Mem_Alloc(v9, 0i64, "ds\\dns\\server\\validator\\validator.c", 1599);
  v8 = v13;
  if ( !v13 )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 28) & 1) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 25) >= 4u )
    {
      WPP_SF_(*((_QWORD *)WPP_GLOBAL_Control + 2), 0x3Au, (__int64)&WPP_c53e2308f6cf3329db3757b8a77c9921_Traceguids);
    }
    return (unsigned int)-1073741801;
  }
  Algorithm = ((__int64 (__fastcall *)(LPCWSTR, __int64, _QWORD *, _QWORD, _DWORD))v15[4])(
                v15[7],
                a3,
                v13,
                v9,
                *((_DWORD *)v15 + 16));
  if ( Algorithm >= 0 )
  {
    v11 = v15;
LABEL_11:
    Algorithm = ((__int64 (__fastcall *)(LPCWSTR, LPCWSTR, __int64, __int64, _QWORD *, unsigned int, __int64, __int64))v11[2])(
                  v11[6],
                  *v12,
                  a1,
                  a2,
                  v8,
                  v9,
                  a4,
                  a3);
  }
  if ( v8 )
    Mem_Free(v8, 0i64, 0i64, (__int64)"ds\\dns\\server\\validator\\validator.c", 1633);
  return (unsigned int)Algorithm;
}
// 140185140: using guessed type __int64 (__fastcall *_guard_dispatch_icall_fptr)(_QWORD, _QWORD);
