//----- (0000000140056318) ----------------------------------------------------
__int64 __fastcall acquireWrite(__int64 a1, unsigned int a2, unsigned int *a3)
{
  unsigned int v6; // edi
  int TlsCounter; // edi

  v6 = -1;
  if ( !a1 )
    return v6;
  TlsCounter = getTlsCounter(a1, 2, a3);
  if ( TlsCounter )
  {
LABEL_11:
    v6 = TlsCounter + 1;
    setTlsCounter(a1, 2, v6, a3, 1);
    return v6;
  }
  if ( (unsigned int)acquireUpdate(a1, a2, a3, 0) == -1 )
    return (unsigned int)-1;
  if ( (unsigned int)FastMutex_Acquire(*(_QWORD *)(a1 + 24), a2) )
  {
    ResetEvent(*(HANDLE *)(a1 + 40));
    while ( _InterlockedCompareExchange((volatile signed __int32 *)a1, 1, 1) != 1 )
    {
      if ( WaitForSingleObject(*(HANDLE *)(a1 + 40), a2) )
      {
        v6 = -1;
        FastMutex_Release(*(_QWORD *)(a1 + 24));
        goto LABEL_7;
      }
    }
    goto LABEL_11;
  }
  v6 = -1;
LABEL_7:
  releaseUpdate(a1, a3, 0);
  return v6;
}
