//----- (000000014015AD84) ----------------------------------------------------
__int64 Dns_RefreshSSpiCredentialsHandle()
{
  int v0; // eax
  int v1; // r9d
  int v2; // ebx
  __int64 v3; // r8
  int v4; // r9d

  if ( (byte_1401BA001 & 0x20) != 0 )
    WPP_SF_Dq(170i64, (unsigned __int16)&WPP_9b9f12dbc4273be48aea1d81c92c8dd1_Traceguids, 1i64, 0);
  EnterCriticalSection(&SecurityContextListCS);
  if ( g_hSspiCredentials != -1 || qword_1401BA078 != -1 )
  {
    v0 = (*(__int64 (__fastcall **)(__int64 *))(g_pSecurityFunctionTable + 32))(&g_hSspiCredentials);
    if ( v0 < 0 && (byte_1401BA003 & 0x10) != 0 )
      WPP_SF_D(171i64, (unsigned __int16)&WPP_9b9f12dbc4273be48aea1d81c92c8dd1_Traceguids, (unsigned int)v0, v1);
    qword_1401BA078 = -1i64;
    g_hSspiCredentials = -1i64;
  }
  v2 = Dns_AcquireCredHandle((__int64)&g_hSspiCredentials);
  if ( v2 < 0 )
  {
    if ( (byte_1401BA001 & 4) != 0 )
      WPP_SF_(172i64, (unsigned __int16)&WPP_9b9f12dbc4273be48aea1d81c92c8dd1_Traceguids, v3);
    qword_1401BA078 = -1i64;
    g_hSspiCredentials = -1i64;
  }
  LeaveCriticalSection(&SecurityContextListCS);
  if ( (byte_1401BA001 & 0x20) != 0 )
    WPP_SF_D(173i64, (unsigned __int16)&WPP_9b9f12dbc4273be48aea1d81c92c8dd1_Traceguids, (unsigned int)v2, v4);
  return (unsigned int)v2;
}
// 14015AE06: variable 'v1' is possibly undefined
// 14015AE40: variable 'v3' is possibly undefined
// 14015AE78: variable 'v4' is possibly undefined
// 140185140: using guessed type __int64 (__fastcall *_guard_dispatch_icall_fptr)(_QWORD, _QWORD);
// 1401BA001: using guessed type char byte_1401BA001;
// 1401BA003: using guessed type char byte_1401BA003;
// 1401BA070: using guessed type __int64 g_hSspiCredentials;
// 1401BA078: using guessed type __int64 qword_1401BA078;
// 1401BA088: using guessed type __int64 g_pSecurityFunctionTable;
