//----- (00000001400FB2D0) ----------------------------------------------------
_QWORD *__fastcall DnsOls_ReadRRListFromBuffer(_DWORD *a1, int a2, _DWORD *a3)
{
  int v3; // ebp
  unsigned __int16 *v4; // rdi
  _QWORD *v5; // rbx
  unsigned int v6; // esi
  _QWORD *v7; // r14
  unsigned __int16 *v9; // r12
  _BYTE *v10; // rax
  unsigned __int64 v11; // rcx
  size_t v12; // r8

  v3 = *a1;
  v4 = (unsigned __int16 *)(a1 + 1);
  v5 = 0i64;
  v6 = a2 - 4;
  v7 = 0i64;
  if ( *a1 )
  {
    while ( 1 )
    {
      v9 = v4;
      v10 = RR_AllocateEx(*v4, 0, 0);
      if ( !v10 )
        break;
      if ( v7 )
        *v7 = v10;
      else
        v5 = v10;
      v7 = v10;
      v11 = *v4 + 24i64;
      *a3 += *v4 + 24;
      if ( v6 < v11 )
        break;
      v12 = *((unsigned __int16 *)v10 + 7);
      *((_WORD *)v10 + 6) = v4[1];
      v10[8] = *((_BYTE *)v4 + 5);
      *((_DWORD *)v10 + 5) = *((_DWORD *)v4 + 3);
      *((_DWORD *)v10 + 6) = *((_DWORD *)v4 + 5);
      memcpy_0(v10 + 56, v4 + 12, v12);
      v4 = (unsigned __int16 *)((char *)v4 + *v4 + 24);
      v6 += -24 - *v9;
      if ( !--v3 )
        return v5;
    }
    RR_ListFree(v5);
    return 0i64;
  }
  return v5;
}
