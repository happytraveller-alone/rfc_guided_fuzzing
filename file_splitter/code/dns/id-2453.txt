//----- (0000000140129FE0) ----------------------------------------------------
__int64 __fastcall std::basic_stringbuf<unsigned short>::pbackfail(__int64 a1, unsigned __int16 a2)
{
  unsigned __int16 v2; // r8
  unsigned __int64 v3; // r9

  v2 = 0;
  v3 = **(_QWORD **)(a1 + 64);
  if ( !v3
    || v3 <= **(_QWORD **)(a1 + 32)
    || a2 != 0xFFFF && a2 != *(_WORD *)(v3 - 2) && (*(_BYTE *)(a1 + 120) & 2) != 0 )
  {
    return 0xFFFFi64;
  }
  ++**(_DWORD **)(a1 + 88);
  **(_QWORD **)(a1 + 64) -= 2i64;
  if ( a2 != 0xFFFF )
  {
    v2 = a2;
    ***(_WORD ***)(a1 + 64) = a2;
  }
  return v2;
}
