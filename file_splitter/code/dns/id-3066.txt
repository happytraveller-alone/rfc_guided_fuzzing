//----- (0000000140160968) ----------------------------------------------------
__int64 __fastcall Dns_AddIpToIpArray(_DWORD *a1, int a2)
{
  __int64 result; // rax
  _DWORD *i; // rdx

  result = 0i64;
  if ( a1 )
  {
    if ( *a1 )
    {
      for ( i = a1 + 1; *i; ++i )
      {
        if ( *i == a2 )
          return 1i64;
        result = (unsigned int)(result + 1);
        if ( (unsigned int)result >= *a1 )
          return 0i64;
      }
      a1[result + 1] = a2;
      return 1i64;
    }
    else
    {
      return 0i64;
    }
  }
  return result;
}
