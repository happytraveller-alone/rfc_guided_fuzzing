//----- (0000000140076CF0) ----------------------------------------------------
unsigned __int64 __fastcall Reg_AllocateExpandedString_W(LPCWSTR lpSrc)
{
  DWORD v3; // eax
  DWORD v4; // edi
  WCHAR *v5; // rax

  if ( !lpSrc )
    return 0i64;
  v3 = ExpandEnvironmentStringsW(lpSrc, 0i64, 0);
  v4 = v3;
  if ( !v3 )
  {
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      WPP_SF_S(
        *((_QWORD *)WPP_GLOBAL_Control + 7),
        0x39u,
        (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids,
        lpSrc);
    }
    return 0i64;
  }
  v5 = (WCHAR *)Mem_Alloc(2 * v3, 19i64, "ds\\dns\\server\\server\\registry.c", 2860);
  if ( !v5 )
    return 0i64;
  return (unsigned __int64)v5 & -(__int64)(ExpandEnvironmentStringsW(lpSrc, v5, v4) != 0);
}
