//----- (000000014005AA00) ----------------------------------------------------
wchar_t *__fastcall GetPolicyContentString(__int64 a1)
{
  _DWORD *v1; // rax
  unsigned __int64 v3; // rbp
  CDnsClientSubnetRecordsTrie *v4; // rcx
  unsigned __int16 v5; // dx
  wchar_t *v7; // rbx
  STRSAFE_LPWSTR *v8; // r9
  __int64 v9; // rdi
  wchar_t *v10; // rax
  STRSAFE_LPWSTR *v11; // r9
  STRSAFE_LPWSTR *v12; // r9
  STRSAFE_LPWSTR *v13; // r9
  size_t *v14; // [rsp+20h] [rbp-68h]
  size_t *v15; // [rsp+20h] [rbp-68h]
  size_t *v16; // [rsp+20h] [rbp-68h]
  DWORD v17; // [rsp+28h] [rbp-60h]
  DWORD v18; // [rsp+28h] [rbp-60h]
  DWORD v19; // [rsp+28h] [rbp-60h]
  wchar_t Buffer[28]; // [rsp+30h] [rbp-58h] BYREF

  v1 = *(_DWORD **)(a1 + 40);
  if ( !v1 || !*v1 )
    return 0i64;
  v3 = 520i64 * (unsigned int)*v1;
  if ( v3 > 0xFFFFFFFF )
  {
    v4 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      || (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) == 0
      || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
    {
      return 0i64;
    }
    v5 = 36;
LABEL_8:
    WPP_SF_(*((_QWORD *)v4 + 7), v5, (__int64)&WPP_7aabcfb4077e3de7a2cc491a12601782_Traceguids);
    return 0i64;
  }
  v7 = (wchar_t *)Mem_AllocZero((unsigned int)v3, 0i64, "ds\\dns\\server\\server\\log.c", 4043);
  if ( !v7 )
  {
    v4 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      || (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) == 0
      || *((_BYTE *)WPP_GLOBAL_Control + 65) < 4u )
    {
      return 0i64;
    }
    v5 = 37;
    goto LABEL_8;
  }
  memset_0(Buffer, 0, 0x32ui64);
  v9 = 0i64;
  if ( **(_DWORD **)(a1 + 40) )
  {
    while ( 1 )
    {
      if ( (_DWORD)v9 && StringCchCatExW(v7, (unsigned int)v3, L";", v8, v14, v17) < 0 )
      {
        v4 = WPP_GLOBAL_Control;
        if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
          && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) != 0
          && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
        {
          v5 = 38;
          goto LABEL_8;
        }
        return 0i64;
      }
      v10 = _itow(*(_DWORD *)(*(_QWORD *)(*(_QWORD *)(a1 + 40) + 8 * v9 + 8) + 8i64), Buffer, 10);
      if ( StringCchCatExW(v7, (unsigned int)v3, v10, v11, v14, v17) < 0
        || StringCchCatExW(v7, (unsigned int)v3, L",", v12, v15, v18) < 0
        || StringCchCatExW(
             v7,
             (unsigned int)v3,
             **(STRSAFE_LPCWSTR **)(*(_QWORD *)(a1 + 40) + 8 * v9 + 8),
             v13,
             v16,
             v19) < 0 )
      {
        break;
      }
      v9 = (unsigned int)(v9 + 1);
      if ( (unsigned int)v9 >= **(_DWORD **)(a1 + 40) )
        return v7;
    }
    v4 = WPP_GLOBAL_Control;
    if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
      && (*((_DWORD *)WPP_GLOBAL_Control + 17) & 0x400000) != 0
      && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 4u )
    {
      v5 = 39;
      goto LABEL_8;
    }
    return 0i64;
  }
  return v7;
}
// 14005AB1E: variable 'v8' is possibly undefined
// 14005AB1E: variable 'v14' is possibly undefined
// 14005AB1E: variable 'v17' is possibly undefined
// 14005AB4F: variable 'v11' is possibly undefined
// 14005AB65: variable 'v12' is possibly undefined
// 14005AB65: variable 'v15' is possibly undefined
// 14005AB65: variable 'v18' is possibly undefined
// 14005AB80: variable 'v13' is possibly undefined
// 14005AB80: variable 'v16' is possibly undefined
// 14005AB80: variable 'v19' is possibly undefined
