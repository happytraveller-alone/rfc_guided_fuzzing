//----- (0000000140077290) ----------------------------------------------------
HKEY __fastcall OpenZoneScopes(__int64 a1, int a2, const WCHAR *a3, const WCHAR *a4, LSTATUS *a5)
{
  HKEY v8; // rdi
  const wchar_t *v9; // rax
  LSTATUS v10; // ebx
  CDnsClientSubnetRecordsTrie *v11; // rcx
  unsigned __int16 v12; // dx
  HKEY phkResult; // [rsp+60h] [rbp+8h] BYREF

  phkResult = 0i64;
  v8 = OpenZoneKey(a4, a3);
  if ( v8 )
  {
    if ( a2 )
    {
      v10 = RegOpenKeyExW(v8, L"ZoneScopes", 0, 0x2001Fu, &phkResult);
      if ( !v10 )
        goto LABEL_21;
      v11 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        || (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) == 0
        || *((_BYTE *)WPP_GLOBAL_Control + 65) < 2u )
      {
        goto LABEL_21;
      }
      v12 = 91;
    }
    else
    {
      v10 = RegCreateKeyExW(v8, L"ZoneScopes", 0, (LPWSTR)L"DnsRegistryClass", 0, 0x2001Fu, 0i64, &phkResult, 0i64);
      if ( !v10 )
        goto LABEL_21;
      v11 = WPP_GLOBAL_Control;
      if ( WPP_GLOBAL_Control == (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
        || (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) == 0
        || *((_BYTE *)WPP_GLOBAL_Control + 65) < 2u )
      {
        goto LABEL_21;
      }
      v12 = 92;
    }
    WPP_SF_SD(*((_QWORD *)v11 + 7), v12, (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids, a3);
LABEL_21:
    RegCloseKey(v8);
    goto LABEL_22;
  }
  if ( WPP_GLOBAL_Control != (CDnsClientSubnetRecordsTrie *)&WPP_GLOBAL_Control
    && (*((_BYTE *)WPP_GLOBAL_Control + 68) & 2) != 0
    && *((_BYTE *)WPP_GLOBAL_Control + 65) >= 2u )
  {
    v9 = L".";
    if ( a4 )
      v9 = a4;
    WPP_SF_SS(
      *((_QWORD *)WPP_GLOBAL_Control + 7),
      0x5Au,
      (__int64)&WPP_6ba06e9d807b3b6640892c588bf1aced_Traceguids,
      a3,
      (__int64)v9);
  }
  v10 = 110;
LABEL_22:
  if ( a5 )
    *a5 = v10;
  return phkResult;
}
